(function(e){(e.NSSS=e.NSSS||{}).chromeGlobal=function(h,a){var b={},k=h.logger,e=a.helperUtils,p=a.uiHelper,m=a.nfmEvents,f=h.utils.isNil,g=h.utils.isntNil,v=a.constants,n=a.webProtection,q=h.localizer,c=h.extensionAdapter,r=a.NSSSHelper;b.THREE_IN_ONE_EXTENSION=!1;b.updatePopoverUI=function(t){c.getActiveTab(function(l){var d=c.getLastError();if(g(d))k.log("Tab is not available"),k.log(d);else{var b=c.getTabID(l),u=a.main.popoverWindowStrings();a.main.isMyWayHomePageUrl(l.url)?a.main.checkMywayIFrameAvailableInTab(b).then(function(a){a=
!0===a?{annoyanceThreats:0,computerThreats:0,identityThreats:0,rating:1,ratingText:"Safe",showSafeWebSearchbox:!1,sitename:"Norton Secure Search",totalThreats:0}:p.uiStatusForSessionID(e.getSessionIDForTabID(b),l.url).uiStatus;t({popoverStrings:u,uiStatus:a,showReportSite:!1,showFullReport:!1})}):(d=e.getSessionIDForTabID(b),d=p.uiStatusForSessionID(d,l.url),t({popoverStrings:u,uiStatus:d.uiStatus,showReportSite:d.showReportSite,showFullReport:d.showFullReport}))}})};b.downloadURLAnalyzedCallback=
function(a,b,d){b=d.getRating();g(b.redirectPage)&&(chrome.downloads.cancel(a),chrome.downloads.removeFile(a),chrome.downloads.erase({id:a}),a=q.getLocalizedString("Malicious Download Detected"),b=q.getLocalizedString("Download Cancelled"),chrome.notifications.create({type:"basic",iconUrl:c.getExtensionURL("content/images/icon-downloadblocked.svg"),title:a,message:b}))};b.initialize=function(){c.addTabRemovedEventListener(a.main.handleClose);c.addTabActivatedEventListener(a.main.handleActivate);c.addTabUpdatedEventListener(a.main.handleOnUpdated);
c.addMessageListener(a.main.handleMessage);n.registerEventCallback(m.PAGE_ANALYZED,a.main.pageAnalyzedCallback);n.registerEventCallback(m.SEARCH_URLS_ANALYZED,a.main.searchURLsAnalyzedCallback);g(chrome.downloads)&&(chrome.downloads.onCreated.addListener(a.main.analyzeDownloadPage),n.registerEventCallback(m.DOWNLOAD_URL_ANALYZED,b.downloadURLAnalyzedCallback));a.main.handleTelemetryOptOut();chrome.webNavigation.onTabReplaced.addListener(a.main.handleTabReplaced);!0===b.THREE_IN_ONE_EXTENSION&&(a.globalSettings.getValue(v.IS_HP_FIRST_LAUNCH),
chrome.webRequest.onBeforeRequest.addListener(a.main.handleOmniSearchEvent,{urls:[a.constants.SEARCH_URL+"?omnisearch=yes*"]},["blocking"]));if("Chrome"===h.globals.BROWSER||"Firefox"===h.globals.BROWSER)chrome.webNavigation.onCompleted.addListener(b._handleMyWayHPLoadEvent,{url:[{urlContains:a.constants.MYWAY_IFRAME_HP_URL},{urlEquals:a.constants.MYWAY_IFRAME_HP_URL_FF}]}),c.getActiveTab(function(a){f(a)||f(a.id)||e.updateActionButton(null,a.id,"")});a.isFreshInstall||c.getAllTabs(function(a){a.forEach(function(a){if(r.isLandingPageURL(a.url)){var b=
c.getTabID(a);c.updateTabUrl(b,a.url)}})})};b._handleMyWayHPLoadEvent=function(a){f(a)||f(a.tabId)||e.updateActionButton(null,a.tabId,"")};b.flavorizeExtension=function(){c.getAllTabs(function(a){a.forEach(function(a){if(!1!==r.isLandingPageURL(a.url)){var b=c.getTabID(a);g(b)&&chrome.tabs.executeScript(b,{file:"content/libs/uri.min.js"},function(a){var d=c.getLastError();f(a)||g(d)?k.error("Failed during execute script : uri.min.js"):chrome.tabs.executeScript(b,{file:"ContextInit.js"},function(a){d=
c.getLastError();f(a)||g(d)?k.error("Failed during execute script : ContextInit"):chrome.tabs.executeScript(b,{file:"content/scripts/SymBfwCS.js"},function(a){d=c.getLastError();f(a)||g(d)?k.error("Failed during execute script : SymBfwCS"):chrome.tabs.executeScript(b,{file:"content/scripts/flavorParser.js"},function(a){d=c.getLastError();(f(a)||g(d))&&k.error("Failed during execute script : flavorParser")})})})})}})})};b.load=function(){a.init.ready().then(b.initialize,function(a){k.error(a)})};return b}(e.SymBfw,
e.NSSS)})(executionContext);if(SymBfw.utils.isntNil(chrome.runtime.onInstalled))chrome.runtime.onInstalled.addListener(NSSS.main.handleInstall);else{var guid=NSSS.globalSettings.getValue(NSSS.constants.NSSS_INSTALLDATEKEY);SymBfw.utils.isNil(guid)&&setTimeout(function(){NSSS.main.handleInstall({reason:"install"})},5E3)}window.addEventListener("load",function(){NSSS.chromeGlobal.load()});
