var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(b){var a=0;return function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.makeIterator=function(b){var a="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];return a?a.call(b):$jscomp.arrayIterator(b)};$jscomp.arrayFromIterator=function(b){for(var a,c=[];!(a=b.next()).done;)c.push(a.value);return c};
$jscomp.arrayFromIterable=function(b){return b instanceof Array?b:$jscomp.arrayFromIterator($jscomp.makeIterator(b))};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};$jscomp.polyfill=function(b,a,c,f){if(a){c=$jscomp.global;b=b.split(".");for(f=0;f<b.length-1;f++){var e=b[f];e in c||(c[e]={});c=c[e]}b=b[b.length-1];f=c[b];a=a(f);a!=f&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(b){function a(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(c,d){c(a)})}if(b&&!$jscomp.FORCE_POLYFILL_PROMISE)return b;a.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var c=this;this.asyncExecuteFunction(function(){c.executeBatch_()})}this.batch_.push(a)};var f=$jscomp.global.setTimeout;a.prototype.asyncExecuteFunction=function(a){f(a,0)};a.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var c=0;c<a.length;++c){var d=a[c];a[c]=null;try{d()}catch(p){this.asyncThrow_(p)}}}this.batch_=null};a.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var c=this.createResolveAndReject_();try{a(c.resolve,c.reject)}catch(d){c.reject(d)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(h){d||(d=!0,a.call(c,h))}}var c=this,d=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var c=null!=a;break a;case "function":c=!0;break a;default:c=!1}c?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var c=void 0;try{c=a.then}catch(d){this.reject_(d);return}"function"==typeof c?
this.settleSameAsThenable_(c,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,c){if(0!=this.state_)throw Error("Cannot settle("+a+", "+c+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=c;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)k.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var k=new a;e.prototype.settleSameAsPromise_=function(a){var c=this.createResolveAndReject_();a.callWhenSettled_(c.resolve,c.reject)};e.prototype.settleSameAsThenable_=function(a,c){var d=this.createResolveAndReject_();try{a.call(c,d.resolve,d.reject)}catch(p){d.reject(p)}};e.prototype.then=function(a,c){function d(a,c){return"function"==typeof a?function(c){try{b(a(c))}catch(r){g(r)}}:c}var b,g,h=new e(function(a,c){b=a;g=c});this.callWhenSettled_(d(a,b),d(c,g));return h};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,c){function d(){switch(b.state_){case 1:a(b.result_);break;case 2:c(b.result_);break;default:throw Error("Unexpected state: "+b.state_);}}var b=this;null==this.onSettledCallbacks_?k.asyncExecute(d):this.onSettledCallbacks_.push(d)};e.resolve=c;e.reject=function(a){return new e(function(c,d){d(a)})};e.race=function(a){return new e(function(b,d){for(var h=$jscomp.makeIterator(a),g=h.next();!g.done;g=h.next())c(g.value).callWhenSettled_(b,
d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,g){function h(c){return function(d){e[c]=d;q--;0==q&&a(e)}}var e=[],q=0;do e.push(void 0),q++,c(d.value).callWhenSettled_(h(e.length-1),g),d=b.next();while(!d.done)})};return e},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(b,a){this.$jscomp$symbol$id_=b;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:a})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function b(c){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+a++,c)}var a=0;return b}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.asyncIterator;b||(b=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.underscoreProtoCanBeSet=function(){var b={a:!0},a={};try{return a.__proto__=b,a.a}catch(c){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(b,a){b.__proto__=a;if(b.__proto__!==a)throw new TypeError(b+" is not extensible");return b}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(b){if(!(b instanceof Object))throw new TypeError("Iterator result "+b+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(b){this.yieldResult=b};$jscomp.generator.Context.prototype.throw_=function(b){this.abruptCompletion_={exception:b,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(b){this.abruptCompletion_={return:b};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(b){this.abruptCompletion_={jumpTo:b};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(b,a){this.nextAddress=a;return{value:b}};$jscomp.generator.Context.prototype.yieldAll=function(b,a){b=$jscomp.makeIterator(b);var c=b.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=a;else return this.yieldAllIterator_=b,this.yield(c.value,a)};
$jscomp.generator.Context.prototype.jumpTo=function(b){this.nextAddress=b};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(b,a){this.catchAddress_=b;void 0!=a&&(this.finallyAddress_=a)};$jscomp.generator.Context.prototype.setFinallyBlock=function(b){this.catchAddress_=0;this.finallyAddress_=b||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(b,a){this.nextAddress=b;this.catchAddress_=a||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(b){this.catchAddress_=b||0;b=this.abruptCompletion_.exception;this.abruptCompletion_=null;return b};$jscomp.generator.Context.prototype.enterFinallyBlock=function(b,a,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=b||0;this.finallyAddress_=a||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(b,a){a=this.finallyContexts_.splice(a||0)[0];if(a=this.abruptCompletion_=this.abruptCompletion_||a){if(a.isException)return this.jumpToErrorHandler_();void 0!=a.jumpTo&&this.finallyAddress_<a.jumpTo?(this.nextAddress=a.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=b};$jscomp.generator.Context.prototype.forIn=function(b){return new $jscomp.generator.Context.PropertyIterator(b)};
$jscomp.generator.Context.PropertyIterator=function(b){this.object_=b;this.properties_=[];for(var a in b)this.properties_.push(a);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var b=this.properties_.pop();if(b in this.object_)return b}return null};$jscomp.generator.Engine_=function(b){this.context_=new $jscomp.generator.Context;this.program_=b};
$jscomp.generator.Engine_.prototype.next_=function(b){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,b,this.context_.next_);this.context_.next_(b);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(b){this.context_.start_();var a=this.context_.yieldAllIterator_;if(a)return this.yieldAllStep_("return"in a?a["return"]:function(a){return{value:a,done:!0}},b,this.context_.return);this.context_.return(b);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(b){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],b,this.context_.next_);this.context_.throw_(b);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(b,a,c){try{var f=b.call(this.context_.yieldAllIterator_,a);$jscomp.generator.ensureIteratorResultIsObject_(f);if(!f.done)return this.context_.stop_(),f;var e=f.value}catch(k){return this.context_.yieldAllIterator_=null,this.context_.throw_(k),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var b=this.program_(this.context_);if(b)return this.context_.stop_(),{value:b.value,done:!1}}catch(a){this.context_.yieldResult=void 0,this.context_.throw_(a)}this.context_.stop_();if(this.context_.abruptCompletion_){b=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(b.isException)throw b.exception;return{value:b.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(b){this.next=function(a){return b.next_(a)};this.throw=function(a){return b.throw_(a)};this.return=function(a){return b.return_(a)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(b,a){a=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(a,b.prototype);return a};
$jscomp.asyncExecutePromiseGenerator=function(b){function a(a){return b.next(a)}function c(a){return b.throw(a)}return new Promise(function(f,e){function k(b){b.done?f(b.value):Promise.resolve(b.value).then(a,c).then(k,e)}k(b.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(b){return $jscomp.asyncExecutePromiseGenerator(b())};$jscomp.asyncExecutePromiseGeneratorProgram=function(b){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b)))};
$jscomp.iteratorFromArray=function(b,a){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var c=0,f={next:function(){if(c<b.length){var e=c++;return{value:a(e,b[e]),done:!1}}f.next=function(){return{done:!0,value:void 0}};return f.next()}};f[Symbol.iterator]=function(){return f};return f};$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.polyfill("Object.is",function(b){return b?b:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(b){return b?b:function(a,c){var b=this;b instanceof String&&(b=String(b));var e=b.length;c=c||0;for(0>c&&(c=Math.max(c+e,0));c<e;c++){var k=b[c];if(k===a||Object.is(k,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(b,a,c){if(null==b)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return b+""};$jscomp.polyfill("String.prototype.includes",function(b){return b?b:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var b={},a=Object.create(new $jscomp.global.Proxy(b,{get:function(c,f,e){return c==b&&"q"==f&&e==a}}));return!0===a.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)};
$jscomp.polyfill("WeakMap",function(b){function a(){if(!b||!Object.seal)return!1;try{var a=Object.seal({}),c=Object.seal({}),g=new b([[a,2],[c,3]]);if(2!=g.get(a)||3!=g.get(c))return!1;g.delete(a);g.set(c,4);return!g.has(a)&&4==g.get(c)}catch(n){return!1}}function c(){}function f(a){if(!$jscomp.owns(a,k)){var d=new c;$jscomp.defineProperty(a,k,{value:d})}}function e(a){var d=Object[a];d&&(Object[a]=function(a){if(a instanceof c)return a;f(a);return d(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&
$jscomp.ES6_CONFORMANCE)return b}else if(a())return b;var k="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var l=0,h=function(a){this.id_=(l+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};h.prototype.set=function(a,c){f(a);if(!$jscomp.owns(a,k))throw Error("WeakMap key fail: "+a);a[k][this.id_]=c;return this};h.prototype.get=function(a){return $jscomp.owns(a,k)?a[k][this.id_]:void 0};h.prototype.has=
function(a){return $jscomp.owns(a,k)&&$jscomp.owns(a[k],this.id_)};h.prototype.delete=function(a){return $jscomp.owns(a,k)&&$jscomp.owns(a[k],this.id_)?delete a[k][this.id_]:!1};return h},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(b){function a(){if($jscomp.ASSUME_NO_NATIVE_MAP||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),c=new b($jscomp.makeIterator([[a,"s"]]));if("s"!=c.get(a)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var g=c.entries(),h=g.next();if(h.done||h.value[0]!=a||"s"!=h.value[1])return!1;h=g.next();return h.done||4!=h.value[0].x||"t"!=h.value[1]||!g.next().done?!1:!0}catch(m){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(a())return b;$jscomp.initSymbolIterator();var c=new WeakMap,f=function(a){this.data_={};this.head_=l();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};f.prototype.set=function(a,c){a=0===a?0:a;var d=e(this,a);d.list||(d.list=this.data_[d.id]=[]);d.entry?d.entry.value=c:(d.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:c},d.list.push(d.entry),this.head_.previous.next=d.entry,this.head_.previous=d.entry,this.size++);return this};f.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};f.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=l();this.size=0};f.prototype.has=function(a){return!!e(this,a).entry};
f.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};f.prototype.entries=function(){return k(this,function(a){return[a.key,a.value]})};f.prototype.keys=function(){return k(this,function(a){return a.key})};f.prototype.values=function(){return k(this,function(a){return a.value})};f.prototype.forEach=function(a,c){for(var d=this.entries(),b;!(b=d.next()).done;)b=b.value,a.call(c,b[1],b[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var e=function(a,b){var d=b&&typeof b;"object"==
d||"function"==d?c.has(b)?d=c.get(b):(d=""+ ++h,c.set(b,d)):d="p_"+b;var e=a.data_[d];if(e&&$jscomp.owns(a.data_,d))for(a=0;a<e.length;a++){var f=e[a];if(b!==b&&f.key!==f.key||b===f.key)return{id:d,list:e,index:a,entry:f}}return{id:d,list:e,index:-1,entry:void 0}},k=function(a,c){var d=a.head_;return $jscomp.iteratorPrototype(function(){if(d){for(;d.head!=a.head_;)d=d.previous;for(;d.next!=d.head;)return d=d.next,{done:!1,value:c(d)};d=null}return{done:!0,value:void 0}})},l=function(){var a={};return a.previous=
a.next=a.head=a},h=0;return f},"es6","es3");$jscomp.polyfill("Array.from",function(b){return b?b:function(a,c,b){c=null!=c?c:function(a){return a};var e=[],f="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if("function"==typeof f){a=f.call(a);for(var l=0;!(f=a.next()).done;)e.push(c.call(b,f.value,l++))}else for(f=a.length,l=0;l<f;l++)e.push(c.call(b,a[l],l));return e}},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},"es8","es3");$jscomp.polyfill("String.prototype.startsWith",function(b){return b?b:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=b.length,k=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var l=0;l<k&&c<e;)if(b[c++]!=a[l++])return!1;return l>=k}},"es6","es3");
$jscomp.polyfill("Object.values",function(b){return b?b:function(a){var c=[],b;for(b in a)$jscomp.owns(a,b)&&c.push(a[b]);return c}},"es8","es3");var executionContext=this;
(function(b){b=b.WCID=b.WCID||{};var a={WCID_URL:"https://pf-web.npp.brightmail.com",WCID_URL_PATH:"wcid/servlet/webcallerid.WCIDURL",REPORTCMD:"REPORT",CHECKCMD:"CHECK",LOOKUPURLCMD:"LOOKUPURL",CMD:"cmd",URL:"url",CLASSIFICATION:"classification",REASON:"er",VERSION:"ver",PRODUCT_NAME:"Norton-Extension",CONNECTIONTIMEOUT:8E3,PHISH_SITES_CACHE_LIMIT:1E3,WEB_EMAIL_CACHE_LIMIT:1E3,WCID_CLASSIFICATIONS:{CLASSIFICATIONID_TRUSTWORTHYSITE:1,CLASSIFICATIONID_WEBSPOOFINGSITE:2,CLASSIFICATIONID_NEUTRALSITE:3,
CLASSIFICATIONID_UNKNOWN:4,CLASSIFICATIONID_KNOWNSPOOFINGSITE:5,CLASSIFICATIONID_XSSATTACK:6},REASON_ID:{REASON_USERREPORTURLASGOOD:1,REASON_USERREPORTURLASBAD:2,REASON_CLIENTREPORTURLASBAD:3,REASON_REGISTRATION:4,REASON_WEBAUTHENTICATIONBAD:5,REASON_XSSATTACK:6,REASON_MALWAREDETECTEDBYCOL:7,REASON_UNKNOWN:8},MESSAGES:{CHECK_IN_SAFELIST:"EBCD1AE3-8A7E-4393-910E-5C690AF04B60",START_HEURISTICS:"903C3014-CCB8-4575-A286-A5C8731B5DC2",STOP_HEURISTICS:"5D90B74C-3B8D-4ACA-AF2D-A006F654E3A3",LOOKUP_URLS_FOR_DEF_DATA:"A04B31F7-9345-4F77-B4DB-33AA70C02100",
WCID_HEURISTICS_RESULT:"06349F85-3AF1-49E4-B481-51E44D5E459B",PAGE_IS_WEB_MAIL:"940FE533-A3D7-4F76-B226-073BCC255E26"},DEF_FILES:{SAFELIST:"SafeList",INDICATORS:"Indicators",POPULAR_SITES:"PopularSites",REDIRECTORS:"Redirectors",RESOURCES:"Resources",SEARCH_SERVICES:"SearchServices",TRUSTED_DOMAINS:"TrustedDomains",URL_ANALYSIS:"URLAnalysis",WEB_HOSTING_SITES:"WebHostingSites",PROXY_PATTERNS:"ProxyPatterns"},DEF_DATA_TYPES:{SAFELIST:0,INDICATORS:1,POPULAR_SITES:2,SEARCH_SERVICES:3,TRUSTED_DOMAINS:4,
URL_ANALYSIS:5,WEB_HOSTING_SITES:6,PROXY_PATTERNS:7,URL_LOOKUP_DATA:8}},c={PAGE_URL:0,FORM_ACTION_URL:1,URL_CLASSIFICATION:2,REFERRER_URL:3},f={EXCEPTION_DOMAIN:0,URL_CLASSIFICATION:1,SAFE_LIST:2,WEB_HOSTING_SITE:3,SEARCH_DOMAIN:4,POPULAR_DOMAIN:5,PAGE_IS_WEB_MAIL:6,REFERRER_URL:7},e={};e[c.PAGE_URL]=[f.EXCEPTION_DOMAIN,f.URL_CLASSIFICATION,f.SAFE_LIST,f.WEB_HOSTING_SITE,f.SEARCH_DOMAIN,f.POPULAR_DOMAIN,f.PAGE_IS_WEB_MAIL];e[c.FORM_ACTION_URL]=[f.EXCEPTION_DOMAIN];e[c.URL_CLASSIFICATION]=[f.URL_CLASSIFICATION];
e[c.REFERRER_URL]=[f.REFERRER_URL];a.URL_LOOKUP_CONFIG_MAP=e;a.URL_LOOKUP_ELEMENTS=f;a.URL_LOOKUP_DATA_TYPES=c;a.CDN_DEFS_ROOT_CA="##CDN_DEFS_ROOT_CA##";a.CDN_URL="##WCID_CDN_URL##";a.CDN_SAFE_LIST_PATH="nortonsafesearch/wcid/v1/SafeList.json";a.CDN_ENCRYPTION_METHOD="RS256";a.CDN_SUPPORTED_PROTOCOLS="https";a.CDN_SUPPORTED_FILEFORMAT=["json"];a.CDN_RESPONSE_STATUS={UNSUCCESSFUL_RESPONSE:"Unsuccessful response with status code",INVALID_URL:"Invalid Safe List url",FILE_TAMPERED:"Safe List file has been tampered",
PUBLIC_KEY_NOT_VERIFIED:"Public key verification has failed"};a.CDN_CERT_INFO={CERT_ISSUER_NAME:"DigiCert SHA2 Extended Validation Server CA",CERT_ISSUED:"static.nortoncdn.com"};a.DEF_DATA={UTF8:"utf-8",XML_FILE:".xml",JSON_FILE:".json",CATEGORY_TAG:"Category",NAME_TAG:"Name",INDICATOR_TAG:"Indicator",RULE_TAG:"Rule",EXPRESSION_TAG:"Expression",VALUE_TAG:"Value",JSON_VALUE_TAG:"value",DOMAIN_TAG:"Domain",DOMAIN_ATTRIBUTE:"D",HOSTNAME_TAG:"Hostname",RESOURCES_TAG:"Resources",SERVER_TAG:"Server",EXCEPTION_DOMAIN_TAG:"Exception.Domains",
TRUSTED_DOMAIN_TAG:"Trusted.Domain"};a.SEPARATOR_KEY={DOT:0,SPACE:1,ASTERISK:2,EMPTY_STRING:3,URL:4};a.WCID_LIBRARY="WCID";a.EMPTY_STRING="";a.domConstants={DOM_PARSER_LIMIT:{MAX_FORMS:50,MAX_FORM_ELEMENTS:1500,MAX_IMAGES:500,MAX_SCRIPTS:50,MAX_LINKS:500,MAX_ELEMENTS:5E3,MAX_TIME:5E3},STYLE_ATTRIBUTES:{HIDDEN:"hidden",NONE:"none",ZERO_OPACITY:"0"},DOM_ELEMENT:{INPUT:"INPUT",SELECT:"SELECT",TEXTAREA:"TEXTAREA",BODY:"BODY",OBJECT:"OBJECT",P:"P",BR:"BR",TR:"TR",TABLE:"TABLE",TD:"TD",FRAME:"FRAME",IFRAME:"IFRAME",
BUTTON:"BUTTON",IMG:"IMG",HR:"HR",UL:"UL",LI:"LI",CO:"CO",OL:"OL",DIV:"DIV",LINK:"LINK",ANCHOR:"A",AREA:"AREA",LABEL:"LABEL",SPAN:"SPAN",TH:"TH",B:"B",I:"I",U:"U",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",FONT:"FONT",STRONG:"STRONG",EM:"EM"},SIGNATURE_CODE:{TEXT:"T",IMAGE:"G",INPUT:"I",BUTTON:"B",CHECKBOX:"C",RADIO:"R",SELECT:"S",LINE:"L",FILE:"IB",NEWLINE:"n"},FORM_ACTION:"action",INPUT_TYPE:{TEXT:"TEXT",PASSWORD:"PASSWORD",SUBMIT:"SUBMIT",FILE:"FILE",HIDDEN:"HIDDEN",BUTTON:"BUTTON",CHECKBOX:"CHECKBOX",
IMAGE:"IMAGE",RADIO:"RADIO",RESET:"RESET",EMAIL:"EMAIL"},PARSER_TYPE:{PAGE_PARSER:0,FORMS_PARSER:1,SCRIPT_PARSER:2,LINK_PARSER:3,NODE_PARSER:4},OBJECT_TYPE:{PAGE_DATA:0,FORMS_DATA:1,SCRIPT_DATA:2,LINK_DATA:3,TEXT_DATA:4,IMAGE_DATA:5},SCRIPT_DATA:{LANGUAGE:"language",SOURCE:"src"},IMAGE_DATA:{WIDTH:"width",HEIGHT:"height",SOURCE:"src"},LINK_DATA:{SHORTCUT_ICON:"shortcut icon",URL:"url",RELATIVE:"relative",IP:"ip",IPV4:"ip4",HTTP:"http",HTTPS:"https",PHP:"php",FILE:"/",EMBEDDED:"mhtml",LINK_THRESHOLD:.2},
BODY_DATA:{BACKGROUND:"background"},PAGE_DATA:{COPYRIGHT_SYMBOLS:["\u00a9","&copy","(c)","\u00ae","copyright"]}};a.indicatorConstants={EXPRESSION_METHOD:{GREATER_THAN:0,TEST_BOOLEAN:1,COMPARE_STRINGS:2,HAS_TRUSTED_BRAND:3,STRING_ENDS_WITH:4,CONTAIN_MULTIPLE_SUBSTRINGS:5,CONTAIN_SUBSTRINGS:6,IN_DOMAIN_LIST:8,PAGE_IS_A_FORM:9,CONTAIN_WORDS:10,NONMISLEADING_COPYRIGHT:11,HIGH_WORDS_INPUT_RATIO:12,PAGE_HAS_PROMINENT_FORM:13,MANY_TD_IMAGES:14,PAGE_IS_WEB_MAIL:15,HAS_KNOWN_SIGNATURE:16,HTML_OBFUSCATED:17,
PAGE_IS_COPY:18,INDICATOR_OFF:19,STARTS_WITH:22,HAS_REDIRECT_FORM:24,LESS_THAN:25,INDICATOR_ON:26,PAGE_HAS_PROMINENT_IMAGES:27,LINKS_EXHIBIT_LEGITIMACY:28,IMAGE_BASED_OBFUSCATION:43,PAGE_HAS_BAD_HISTORY:45,URL_EXHIBITS_SPOOFICITY:46,URL_EXHIBITS_LEGITIMACY:47,HOSTNAME_IS_WEB_MAIL:51,ONLY_PERSONAL_FORM:52,FORM_ACTION_EXHIBITS_SPOOFICITY:54,PAGE_HAS_SECURE_FORM:58,PAGE_HAS_CREATE_POPUP_URL:59,IN_SITE_LIST:60,TITLE_MATCHES_BRAND:61,PAGE_HAS_SUSPICIOUS_FLASH_MOVIE:63,PAGE_HAS_SINGLE_ENTRY_FORM:64,PAGE_HAS_FORM_EMAILER:65,
PAGE_IS_FOREIGN_CREDIT_UNION:67},INPUT_TYPE:{NUMBER:0,STRING:1,OBJECT:2,BOOLEAN:3,ARRAY:4},RULE_OPERATOR:{AND:0,OR:1,NOT:2},COMPARISON_TYPE:{GREATER_THAN:"Greater Than",LESS_THAN:"Less Than",EQUAL_TO:"Equal To",CONTAIN_WORDS:"Contain Words",CONTAIN_SUBSTRINGS:"Contain SubStrings",CONTAIN_MULTIPLE_SUBSTRINGS:"Contain Multiple SubStrings"},FIELD_TYPE:{URL_SCHEME:0,URL_PASSWORD:1,URL_USERNAME:2,URL_HOSTNAME:3,URL:4,FORM_ACTION_HOSTNAME:5,PAGE_TITLE:6,BODY_INNER_TEXT:7,IMAGE_PATHS:8,NUM_TD_HOSTED_IMAGES:9,
LABEL_TEXT:10,NUM_PARAGRAPHS:11,NUM_FORMS:13,IS_URL_INTRANET:14,IS_URL_IP:15,LINKS:17,NUM_TD_LINKS:19,URL_PATH:20,ALL_FORM_ACTIONS:21,FORM_NUM_PASSWORD_INPUTS:22,BODY_BG_EXTENSION:25,URL_FILE_EXTENSION:27,LINK_INNER_TEXT:28,NUM_LINKS:29,SHORTCUT_ICON_HOSTNAME:30,NUM_ELEMENTS:31,IS_SYMANTEC_CLIENT:32,COPYRIGHT_STRINGS:33},SPOOFICITY_THRESHOLD:.89,SPOOFICITY_WEIGHT:{NOTUSED:2,WEBSPOOFINGSITE:1,XSSATTACK:1.2,TRUSTWORTHYSITE:0,UNCLASSIFIEDSITE:-1},INDICATORS:{URL_DOMAIN_EXHIBITS_LEGITIMACY:18,URL_FROM_HIGH_RISK_COUNTRY:57,
URL_HAS_EXTREME_INTERSTING_STRINGS:76},VALUE_TYPE:{ENUM:4},PARAMETER_ID:{TRUSTED_BRANDS:0,TRUSTED_DOMAINS:1,EXCEPTION_DOMAINS:2,FREE_WEB_HOST_SITES:3,PARTNER_DOMAINS:4,SEARCH_DOMAINS:5,POPULAR_DOMAINS:6,IDENTIFIERS:7,URL_TAGS:8,TEXT_TAGS:9,DOMAIN_TAGS:10,COPYRIGHT_TAGS:11}};a.redirectorConstants={DATA_TAG:{IS_SKIP_NUMERIC_OPTIONS:"o",IS_COMPLETE_SCHEME:"s",URL_IS_VALUE_OF_KEY:"u"}};a.webEmailHeaderConstants={ENGLISH_EMAILHEADER:{BCC:"bcc",CC:"cc",SUBJECT:"subject",TO:"to",FROM:"from",DATE:"date"},
GERMAN_EMAILHEADER:{BCC:"bcc",CC:"cc",DATE:"datum",TO:"an",FROM:"von",SUBJECT:"betrifft"},ITALIAN_EMAILHEADER:{BCC:"bcc",CC:"cc",DATE:"data",TO:"a",FROM:"da",SUBJECT:"oggetto"},FRENCH_EMAILHEADER:{CC:"cc",TO:"\u00e0",FROM:"de",BCC:"cci",SUBJECT:"objet",DATE:"date"},SPANISH_EMAILHEADER:{CC:"cc",DATE:"fecha",TO:"a",FROM:"de",BCC:"cco",SUBJECT:"asunto"}};a.webEmailLanguageConstants={ENGLISH:{INBOX:"inbox",READ:"read",ADDRESS:"address",ATTACH:"attach",COMPOSE:"compose",DELETE:"delete",DELETED:"deleted",
DRAFT:"draft",FOLDER:"folder",FORWARD:"forward",ITEMS:"items",JUNK:"junk",JUNK_ITEMS:"junkitems",MESSAGES:"message",SENT:"sent",TRASH:"trash",OUTBOX:"outbox",REPLY:"reply",SEND:"send",SPAM:"spam",SPELL:"spell",WRITE:"write",MOVE_TO:"move to",MAIL:"mail",SELECT_ALL:"select all"},englishEmailHeaderSize:Object.keys(a.webEmailHeaderConstants.ENGLISH_EMAILHEADER).length,GERMAN:{INBOX:"posteingang",SENT:"versendete",TRASH:"papierkorb",ATTACH:"anh\u00e4ngen",ADDRESS:"adressbuch",DELETE:"l\u00f6schen",DRAFT:"entwurf",
FOLDER:"ordner",FORWARD:"weiterleiten",REPLY:"antworten",SEND:"senden",WRITE:"verfassen",READ:"gelesen",MESSAGE:"nachrichten",SPELL:"rechtschreibpr\u00fcfung"},germanEmailHeadersSize:Object.keys(a.webEmailHeaderConstants.GERMAN_EMAILHEADER).length,ITALIAN:{INBOX:"in arrivo",SENT:"inviati",TRASH:"cestino",ATTACH:"allega",COMPOSE:"scrivi",ADDRESS:"rubrica",DELETE:"elimina",DRAFT:"bozza",FOLDER:"cartelle",FORWARD:"inoltra",REPLY:"rispondi",SEND:"invia",WRITE:"Scrivi",READ:"letto",MESSAGES:"messaggi",
SPELL:"ortografia"},italianEmailHeadersSize:Object.keys(a.webEmailHeaderConstants.ITALIAN_EMAILHEADER).length,FRENCH:{INBOX:"r\u00e9ception",SENT:"envoy\u00e9s",TRASH:"corbeille",ATTACH1:"jointes",ATTACH2:"ajouter",ADDRESS:"adress",DELETE:"supprimer",DRAFT:"brouillons",FOLDER:"dossier",FORWARD:"suivre",REPLY:"r\u00e9pondre",SEND:"envoyer",WRITE:"\u00e9crire",READ:"lu",SPELL:"orthographe"},frenchEmailHeadersSize:Object.keys(a.webEmailHeaderConstants.FRENCH_EMAILHEADER).length,SPANISH:{INBOX:"buz\u00f3n",
SENT:"enviados",TRASH:"papelera",ATTACH:"adjunt",COMPOSE:"redactar",ADDRESS:"contacto",DELETE:"eliminar",DRAFT:"borrador",FOLDER:"carpeta",FORWARD:"reenviar",REPLY:"responder",SEND:"enviar",WRITE:"escribir",READ:"le\u00eddo",MESSAGES:"mensaje",SPELL:"ortograf\u00eda",SPAM:"basura"},spanishEmailHeadersSize:Object.keys(a.webEmailHeaderConstants.SPANISH_EMAILHEADER).length};a.URL_ANALYSIS={SIZE_MOST_INTERESTING_PROBABILITY:25,CACHE_LIMIT:1E3,TOKENS:{URLTOKEN_FILEPATH:"AD",URLTOKEN_HOST:"AE",URLTOKEN_FILENAME:"AF",
URLTOKEN_CHARACTER:"AG",URLTOKEN_EXTENSION:"AH",URLTOKEN_QUERY:"AI",URLTOKEN_IPADDRESS:"AJ",URLTOKEN_TWENTY:"AK",URLTOKEN_NUMCHDIGIT:"AL",URLTOKEN_HOSTNAME:"AM",URLTOKEN_MORETHANTWOHUNDRED:"AN",URLTOKEN_MORETHANTHREE:"AO",URLTOKEN_FOURORFIVE:"AP",URLTOKEN_MORETHANFIVE:"AQ",URLTOKEN_MORETHANONE:"AR",URLTOKEN_10PLUS:"AS",URLTOKEN_MORETHANTWELVE:"AT",URLTOKEN_USERINFO:"BW",URLTOKEN_FOLDERSTARTSWITHPERIOD:"BX",URLTOKEN_LEGALHEXCHARACTERS:"CE",URLTOKEN_ILLEGALHEXCHARACTERS:"CF",URLTOKEN_INTERESTINGWORD:"BG",
URLTOKEN_ON:"1",URLTOKEN_PATH:"BK",URLTOKEN_PROTOCOLSTAR:"BD*",URLTOKEN_PORTSTAR:"BE*",URLTOKEN_INTERESTINGWORDSTAR:"BG*",URLTOKEN_EXTENSIONSTAR:"BH*",URLTOKEN_SERVICETYPESTAR:"BI*",URLTOKEN_NETWORKIDSTAR:"BJ*",URLTOKEN_PATHTOKENSCOUNTSTAR:"BKBL*",URLTOKEN_PATHLENGTHSTAR:"BKBM*",URLTOKEN_PATHTILDESCOUNTSTAR:"BKBN*",URLTOKEN_PATHDOTSCOUNTSTAR:"BKBO*",URLTOKEN_VERYLONGWORDSTAR:"BP*",URLTOKEN_SERVICEDASHCOUNTSTAR:"BQ*",URLTOKEN_DOMAINSTAR:"BS*",URLTOKEN_SERVICEDOTSCOUNTSTAR:"BT*",URLTOKEN_SYSTEMSTAR:"BU*",
URLTOKEN_USERINFOSTARON:"BW*1",URLTOKEN_FOLDERSTARTSWITHPERIODSTARON:"BX*1",URLTOKEN_QUERYKEYSTAR:"AIBY*",URLTOKEN_QUERYVALUESTAR:"AIBZ*",URLTOKEN_QUERYNUMKEYVALUEPAIRSSTAR:"AICD*",URLTOKEN_LASTPATHENDINGDIGITSSTAR:"CG*"},THRESHOLD:{SPOOFICITY:.85,LEGITIMACY:.15},CLASSIFICATION:{UNDETERMINED:1,SPOOFICITY:2,LEGITIMACY:3},PROBABILITY:{UNKNOWNWORD:.4,NEUTRAL:.5}};b.constants=a})(this);
(function(b){(b.WCID=b.WCID||{}).Trie=function(a){var c=function(a){this._root=a&&a._root?a._root:new m("ROOT");this._height=a&&a._height&&"number"===typeof a._height?a._height:0;this._separator=a&&"number"===typeof a._separator?a._separator:b.DEFAULT;a&&"undefined"!==typeof a._dict&&(this._dict=a._dict)},b={DEFAULT:1},e={0:".",1:" ",2:"*",3:"",4:/([^A-Za-z0-9]+)/},k=e[3],l=function(a,c,d){a.splice(d,0,new m(c));return a[d]},h=function(a,c,d,b,g,e){if(d<b){var q=d+Math.floor((b-d)/2);var f=void 0!==
c[q].k?c[q].k.localeCompare(g):a[c[q].v].localeCompare(g);return 0===f?c[q]:0<f?h(a,c,d,q-1,g,e):h(a,c,q+1,b,g,e)}f=void 0!==c[d].k?c[d].k.localeCompare(g):a[c[d].v].localeCompare(g);return 0===f?c[d]:0===e?0<f?l(c,g,d,e):l(c,g,d+1,e):null};c._isLeaf=function(a){return a.c&&0!==a.c.length||void 0!==a.m||void 0!==a.n?!1:!0};c._getChildren=function(a,c){if(Array.isArray(c.c)&&0<c.c.length)return c.c;var d=new m;if(void 0!==c.m)return d.k=a[c.m],[d];if(void 0!==c.n)return d.k=c.n,[d]};var d=function(a,
d,b,g,e,f,p){p=void 0===p?!1:p;if(0===b.length)return null;for(;g<b.length;g++){if(!d)return d;if(c._isLeaf(d))if(0===e)d.c=[],d.c.push(new m(b[g])),d=d.c[0];else return 2===e?!0===p&&g===b.length-1?h(a,[d],0,0,b[g],e):d:null;else{if(1===d.l&&2===e){if(!0===p){d=c._getChildren(a,d);d=h(a,d,0,d.length-1,b[g],e);continue}return d}d=c._getChildren(a,d);d=h(a,d,0,d.length-1,b[g],e)}}0===e&&(d.d=f,d.l=1);return d},p=function(a,c){if("undefined"===typeof c||null===c)c=e[b.DEFAULT];return a.split(c).filter(function(a){return""!==
a})};c.prototype.wildCardEndsWithSearch=function(a){for(var d=p(a,this.getSeparator()),b=d.length,h=d.length>this._height?d.length-this._height:0;h<b;h++)if(d=p(a,this.getSeparator()),d.splice(0,h),(d=g(this._dict,c._getChildren(this._dict,this._root),d))&&0<d.length)return d;return null};c.prototype.wildCardSearch=function(a){a=p(a,this.getSeparator());a=g(this._dict,c._getChildren(this._dict,this._root),a);return"undefined"===typeof a||null===a||0===a.length?null:a};var g=function(a,c,d){return 1===
d.length&&0<c.length?n(a,c,d[0],!0):0<d.length&&0<c.length?(c=n(a,c,d[0],!1),d.splice(0,1),g(a,c,d)):null},n=function(a,d,b,h){for(var g=[],e=0;e<d.length;e++){var f="^"+(void 0!==d[e].k?d[e].k:a[d[e].v]).split("*").join(".*")+"$";(new RegExp(f)).test(b)&&(f=c._getChildren(a,d[e]),!1===h&&f&&0<f.length?g=g.concat(f):!h||f&&0!==f.length||(g=g.concat(d[e])))}return g};c.prototype.addPhrase=function(a,c){a=p(a,this.getSeparator());this._height=a.length>this._height?a.length:this._height;return d(this._dict,
this._root,a,0,0,c)};c.prototype.findPhrase=function(a){a=p(a,this.getSeparator());return d(this._dict,this._root,a,0,1)};c.prototype.findSubPhrase=function(a){a=p(a,this.getSeparator());for(var b=0;b<a.length;b++){var h=d(this._dict,this._root,a,b,2);if(h&&(c._isLeaf(h)||1===h.l))return h}return null};c.prototype.findSubPhrases=function(a){var b=[];a=p(a,this.getSeparator());if(0===a.length)return[];var h=0,g=1;do{var e=a.slice(h,g);if(e=d(this._dict,this._root,e,0,2))if(c._isLeaf(e)||e.l&&1==e.l){if(!c._isLeaf(e)&&
void 0!==e.d){var f=g=e;for(e=h+e.d.length;g&&!c._isLeaf(g);)1===g.l&&(f=g),g=d(this._dict,c.copyNode(g),[a[e]],0,2),e++;e=g?g:f}b.push(e);++h;g=h+1}else g++;else++h,g=h+1}while(g<=a.length);return b};c.prototype.findEndsWithPhrase=function(a){a=p(a,this.getSeparator());for(var b=a.length>this._height?a.length-this._height:0;b<a.length;b++){var h=d(this._dict,this._root,a.slice(b,a.length),0,2,null,!0);if(h&&(c._isLeaf(h)||1===h.l))return h}return null};c.prototype.findStartsWithPhrase=function(a){a=
p(a,this.getSeparator());return(a=d(this._dict,this._root,a,0,2))&&(c._isLeaf(a)||1===a.l)?a:null};c._traverse=function(a,c){for(var d={};a&&0<a.length;)d.$jscomp$loop$prop$children$12=[],a.forEach(function(a){return function(d){c(d);Array.isArray(d.c)&&0<d.c.length&&a.$jscomp$loop$prop$children$12.push.apply(a.$jscomp$loop$prop$children$12,d.c)}}(d)),a=d.$jscomp$loop$prop$children$12,d={$jscomp$loop$prop$children$12:d.$jscomp$loop$prop$children$12}};c._indexRepeatedTokens=function(a){var d={};c._traverse(a._root.c,
function(a){2>a.k.length||(d[a.k]=d.hasOwnProperty(a.k)?d[a.k]+1:1)});var b=[],h;for(h in d)b.push({key:h,count:d[h],val:d[h]*h.length});b.sort(function(a,c){return c.val-a.val});d={};var g=0;Object.keys(b).forEach(function(a){1>b[a].count*(b[a].key.length-g.toString().length)-(b[a].key.length+1)||(d[b[a].key]=g,g++)});var e=[];c._traverse(a._root.c,function(a){d.hasOwnProperty(a.k)&&(e.includes(a.k)||(e[d[a.k]]=a.k),a.v=d[a.k],delete a.k)});0<e.length&&(a._dict=e)};c._trimLeafNodes=function(a){c._traverse(a._root.c,
function(a){var d=a.c;if(Array.isArray(d)&&1===d.length&&c._isLeaf(d[0])&&void 0===d[0].d){var b=d[0].k;b?a.n=b:(b=d[0].v,a.m=b);delete a.c}})};c.prototype.optimize=function(){this.getSeparator()!==k&&c._indexRepeatedTokens(this);c._trimLeafNodes(this)};c.prototype.getRoot=function(){return this._root};c.prototype.getHeight=function(){return this._height};c.prototype.setSeparator=function(a){this._separator=a};c.prototype.getSeparator=function(){return e[this._separator]};c.copyNode=function(a){var c=
{};a.k&&(c.k=a.k);a.d&&(c.d=a.d);a.c&&(c.c=a.c);a.v&&(c.v=a.v);return c};var m=function(a,c,d){this.k=a;this.d=c;this.c=d};return c}(b.SymBfw)})(this);
(function(b){b.WCID.DefObject=function(a,c){var b=a.utils.isInteger,e=a.utils.isNil,k=a.utils.isntNil,l=a.utils.isString,h=a.utils.isEmptyObject,d=a.logger,p=c.constants.DEF_DATA_TYPES,g=function(){this._urlLookupData={};this._trustedDomains="##TRUSTED_DOMAINS_JSON_DATA##";this._indicators="##INDICATORS_JSON_DATA##";this._proxyPatterns="##REDIRECTORS_JSON_DATA##";this._popularSites="##POPULAR_SITES_JSON_DATA##";this._searchServices="##SEARCH_SERVICES_JSON_DATA##";this._webHostingSites="##WEB_HOSTING_SITES_JSON_DATA##";
this._urlAnalysis="##URL_ANALYSIS_JSON_DATA##";this._safeList="##SAFE_LISTS_JSON_DATA##"},n=/[!,.\n]/g;g.prototype.updateSafeList=function(a){this._safeList=a};g.prototype.getData=function(a){if(!b(a))throw Error("Invalid data type");switch(a){case p.URL_LOOKUP_DATA:return this._urlLookupData;case p.TRUSTED_DOMAINS:return this._trustedDomains;case p.POPULAR_SITES:return this._popularSites;case p.SEARCH_SERVICES:return this._searchServices;case p.WEB_HOSTING_SITES:return this._webHostingSites;case p.PROXY_PATTERNS:return this._proxyPatterns;
case p.URL_ANALYSIS:return this._urlAnalysis;case p.INDICATORS:return this._indicators.items;case p.SAFELIST:return this._safeList}return null};g.prototype.populateData=function(a,c){if(!b(a))throw Error("Invalid data type");if(e(c))throw Error("Null data not accepted");switch(a){case p.URL_LOOKUP_DATA:this._urlLookupData=c}};g.prototype.findInTrustedCopyrights=function(a){if(!1===l(a))throw Error("findInTrustedCopyrights : Input passed is not a string");if(h(this._trustedDomains))throw Error("findInTrustedCopyrights : Trusted Domains not loaded");
var d=new c.Trie(this._trustedDomains.copyrightsPatternsTrie);return e(d.findSubPhrase(a.replace(n," ")))?!1:!0};g.prototype.findInTrustedHostnames=function(a){if(!1===l(a))throw Error("findInTrustedHostnames : Input passed is not a string");if(h(this._trustedDomains))throw Error("findInTrustedHostnames : Trusted Domains not loaded");var d=new c.Trie(this._trustedDomains.urlPatternsTrie);return k(d.findSubPhrase(a))?!0:!1};g.prototype.findInTrustedTexts=function(a){if(!1===l(a))throw Error("findInTrustedTexts : Input passed is not a string");
if(h(this._trustedDomains))throw Error("findInTrustedTexts : Trusted Domains not loaded");var d=new c.Trie(this._trustedDomains.textPatternsTrie);return e(d.findSubPhrase(a.replace(n," ")))?!1:!0};g.prototype.findInTrustedDomains=function(a){if(!1===l(a))throw Error("findInTrustedDomains : Input passed is not a string");if(h(this._trustedDomains))throw Error("findInTrustedDomains : Trusted Domains not loaded");return g._simpleFind(a,this._trustedDomains.domainPatternsTrie)};g.prototype.findInSafeLists=
function(c){if(!1===l(c))throw Error("findInSafeLists : Input passed is not a string");if(h(this._safeList))throw Error("findInSafeLists : Safe List not loaded");var d=new URI(c),b=d.domain(),e=null;a.utils.isUrlAnIp(c)?b=d.hostname():e=d.hostname();return""===b?!1:g._simpleFind(b,this._safeList.simpleTrustedDomainsTrie)||(k(e)?g._simpleFind(e,this._safeList.simpleTrustedDomainsTrie):!1)||g._wildCardFind(b,this._safeList.wildcardTrustedDomainsTrie)};g.prototype.findInExceptionDomains=function(a){if(!1===
l(a))throw Error("findInExceptionDomains : Input passed is not a string");if(h(this._safeList))throw Error("findInExceptionDomains : Safe List not loaded");a=(new URI(a)).hostname();return""===a?!1:g._simpleFind(a,this._safeList.simpleExceptionDomainsTrie)||g._wildCardFind(a,this._safeList.wildcardExceptionDomainsTrie)};g.prototype.findInWebHostSites=function(a){return g._findDomainOrHostnameInDef(a,this._webHostingSites)};g.prototype.findInSearchDomains=function(a){return g._findDomainOrHostnameInDef(a,
this._searchServices)};g.prototype.findInPopularDomains=function(a){return g._findDomainOrHostnameInDef(a,this._popularSites)};g._findDomainOrHostnameInDef=function(a,c){if(!1===l(a))throw Error("Input URL is not a string");if(h(c))throw Error("Def Trie Data Invalid or Not Loaded");var d=new URI(a);a=d.domain();d=d.hostname();var b=!1,e=!1;if(""!==a){var f=d;do{if(!f.includes("."))break;b=g._simpleFind(f,c.simpleDomainsTrie);if(!0===b||f===a)break;f=/\.(.+)/.exec(f);f=k(f)&&1<f.length?f[1]:""}while(!1===
b);!1===b&&(b=g._wildCardFind(a,c.wildDomainsTrie))}!1===b&&""!==d&&(e=g._simpleFind(d,c.simpleHostnamesTrie)||g._wildCardFind(d,c.wildHostnamesTrie));return b||e};g._simpleFind=function(a,d){if(e(a)||e(d))throw Error("Invalid Inputs");d=new c.Trie(d);return k(d.findEndsWithPhrase(a))?!0:!1};g._wildCardFind=function(d,b){if(e(d)||e(b))throw Error("Invalid Inputs");if(0>=b._height)return!1;d=(new c.Trie(b)).wildCardEndsWithSearch(d);return a.utils.isArray(d)&&0<d.length?!0:!1};g.prototype.getProbablityForUrlPattern=
function(a){if(!1===l(a))throw Error("getProbablityForUrlPattern : Input passed is not a string");if(h(this._urlAnalysis))throw Error("getProbablityForUrlPattern : URL Analysis not loaded");a=(new c.Trie(this._urlAnalysis.keywordsTrie)).findPhrase(a);if(e(a)||e(a.d))return null;a=Number(a.d);return isNaN(a)?(d.error("Probability of matched node is not a number"),null):a};g.prototype.getMatchedInterestingWords=function(a){if(!1===l(a))throw Error("getMatchedInterestingWords : Input passed is not a string");
if(h(this._urlAnalysis))throw Error("getMatchedInterestingWords : URL Analysis not loaded");a=(new c.Trie(this._urlAnalysis.interestingWordsTrie)).findSubPhrases(a);var d=[];if(e(a))return d;for(var b=0;b<a.length;b++)d.push(a[b].d);return d};g.prototype.getActualUrlIfProxy=function(a){if(!1===l(a))throw Error("getActualUrlIfProxy : Proxy URL passed is invalid");if(h(this._proxyPatterns))throw Error("getActualUrlIfProxy : Proxy Patterns not loaded");var d=new c.Trie(this._proxyPatterns.startsWithTrie),
b=new c.Trie(this._proxyPatterns.containsStringTrie);d=d.findStartsWithPhrase(a)||b.findSubPhrase(a);if(e(d))return a;b=new URI(a);return k(d.urlIsValueOfKey)&&b.hasQuery(d.urlIsValueOfKey)?b.query(!0)[d.urlIsValueOfKey]:a};return g}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.defManager=function(a,c){var b=a.utils,e=b.isNil,k=b.isArray,l=b.isInteger,h=a.logger,d=a.extensionAdapter,p=c.constants,g=p.DEF_DATA_TYPES,n=p.MESSAGES,m={};m._defObject=new c.DefObject;m.getDefObject=function(){return m._defObject};m._isValidSafeListUrl=function(a){if(e(a))return!1;var c=b.urlProtocol(a);a=b.getFileNameExtension(a);return p.CDN_SUPPORTED_PROTOCOLS===c&&p.CDN_SUPPORTED_FILEFORMAT.includes(a)};m._downloadAndValidateCdnFile=function(d,h,g){return this._isValidSafeListUrl(d)?
b.safeFetch(d).then(function(a){if(b.isSuccessCodeLocalFile(a.status))return a.json();throw p.CDN_RESPONSE_STATUS.UNSUCCESSFUL_RESPONSE+" "+a.status;}).then(function(d){var f=void 0===d.payload?{}:d.payload,k=void 0===d.JWT?"":d.JWT;d=a.certHandler.validateCertAndGetPublicKey(void 0===d.CERT?"":d.CERT,h,g);if(e(d))throw p.CDN_RESPONSE_STATUS.PUBLIC_KEY_NOT_VERIFIED;if(!b.verifyJson(f,k,d,[c.constants.CDN_ENCRYPTION_METHOD]))throw p.CDN_RESPONSE_STATUS.FILE_TAMPERED;return f}).catch(function(a){throw a;
}):Promise.reject(p.CDN_RESPONSE_STATUS.INVALID_URL)};m.loadServerSafeList=function(){var a=""+p.CDN_URL+p.CDN_SAFE_LIST_PATH;return this._fetchServerSafeList(a).then(function(a){m._defObject.updateSafeList(a)}).catch(function(c){h.log(c+"-"+a);m._sendErrorTelemetry(c,a)})};m._fetchServerSafeList=function(a){return this._downloadAndValidateCdnFile(a,p.CDN_DEFS_ROOT_CA,p.CDN_CERT_INFO).then(function(a){return a}).catch(function(a){throw a;})};m._sendErrorTelemetry=function(a,d){c.telemetryWrapper.sendErrors(a+
" "+(void 0===d?"":d))};m.loadURLLookupData=function(a){if(!1===k(a)||1>a.length)throw Error("Invalid request for URL Lookup Data");var c={id:n.LOOKUP_URLS_FOR_DEF_DATA,payload:{requests:a}};return new Promise(function(a,b){d.sendMessage(c,function(c){e(c)?b("Null Response received"):(m._defObject.populateData(g.URL_LOOKUP_DATA,c),a("URL Lookup Def Data loaded"))})})};m.getUrlLookupData=function(a){var d={};if(!1===k(a)||1>a.length)return d;for(var b=0;b<a.length;b++){var e=a[b],g=c.constants.URL_LOOKUP_CONFIG_MAP[e.requestType];
switch(e.requestType){case c.constants.URL_LOOKUP_DATA_TYPES.PAGE_URL:d.pageUrlLookupData=m._getLookupData(e.urls[0],g);break;case c.constants.URL_LOOKUP_DATA_TYPES.FORM_ACTION_URL:d.formActionUrlLookupData={};for(var f=0;f<e.urls.length;f++)if(!0===m._getLookupData(e.urls[f],g).isExceptionDomain){d.formActionUrlLookupData.hasAtleastOneExceptionDomain=!0;break}break;case c.constants.URL_LOOKUP_DATA_TYPES.URL_CLASSIFICATION:d.urlClassificationLookupData=m._getLookupData(e.urls[0],g);break;case c.constants.URL_LOOKUP_DATA_TYPES.REFERRER_URL:d.referrerUrlLookupData=
m._getLookupData(e.urls[0],g);break;default:h.log("Nothing to handle here, return empty object")}}return d};m._getLookupData=function(a,d){for(var b={},h=m.getDefObject(),e=h.getActualUrlIfProxy(a),g=0;g<d.length;g++)switch(d[g]){case c.constants.URL_LOOKUP_ELEMENTS.EXCEPTION_DOMAIN:b.isExceptionDomain=h.findInExceptionDomains(e);break;case c.constants.URL_LOOKUP_ELEMENTS.URL_CLASSIFICATION:b.urlClassification=c.urlAnalysisCache.classificationForURL(e);break;case c.constants.URL_LOOKUP_ELEMENTS.SAFE_LIST:b.isInSafeList=
h.findInSafeLists(e);break;case c.constants.URL_LOOKUP_ELEMENTS.WEB_HOSTING_SITE:b.isWebHostingSite=h.findInWebHostSites(e);break;case c.constants.URL_LOOKUP_ELEMENTS.SEARCH_DOMAIN:b.isSearchDomain=h.findInSearchDomains(e);break;case c.constants.URL_LOOKUP_ELEMENTS.POPULAR_DOMAIN:b.isPopularDomain=h.findInPopularDomains(e);break;case c.constants.URL_LOOKUP_ELEMENTS.PAGE_IS_WEB_MAIL:var f=new URI(a);f=f.hostname().replace("www.","");b.isInWebMailCache=c.webEmailCache.isWebMailURLInCache(f);break;case c.constants.URL_LOOKUP_ELEMENTS.REFERRER_URL:b.isInWebMailCache=
c.webEmailCache.isWebMailURLInCache(a)}return b};m.loadDefObject=function(){var a,c,b,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return a=m.getDefObject(),c=d.getExtensionURL("content/defObject.json"),e(c)?g.return(!1):g.yield(fetch(c),2);if(3!=g.nextAddress)return b=g.yieldResult,e(b)?g.return(!1):g.yield(b.json(),3);h=g.yieldResult;if(e(h))return g.return(!1);a._trustedDomains=h._trustedDomains;a._indicators=h._indicators;a._proxyPatterns=h._proxyPatterns;
return g.return(!0)})};m.unLoadDefObject=function(){var a=m.getDefObject();e(a)||(a._trustedDomains={},a._indicators={},a._proxyPatterns={})};m.getIndicatorsCount=function(){var a=m._defObject.getData(g.INDICATORS);if(!k(a))throw Error("Indicators not loaded");return a.length};m.getIndicator=function(a){var d=m._defObject.getData(g.INDICATORS);if(!k(d))throw Error("Indicators not loaded");if(!l(a))throw Error("Invalid indicator index");if(0>a)throw Error("Negative indicator index");if(a>=d.length)throw Error("Indicator index out of bounds");
return new c.Indicator(d[a])};return m}(b.SymBfw,WCID)})(executionContext);
(function(b){b.WCID.FormData=function(a,c){var b=a.utils.isntNil,e=a.utils.isNil,k=a.utils.isString,l=c.constants.domConstants;a=function(){this._submitValue=this._formActionUri=null;this._numOfSubmitInputs=this._numOfPasswordInputs=this._numOfTextInputs=this._numOfTextAreas=this._numOfSelects=0;this._hiddenInputsData=new Map;this._formActionAttribute=this._hiddenInputEmailValue=null};a.prototype.hasAtleastTwoTextInputs=function(){return 1<this._numOfPasswordInputs+this._numOfTextInputs?!0:!1};a.prototype.isFormVisible=
function(){return 0<this._numOfSelects||0<this._numOfTextAreas||0<this._numOfPasswordInputs||0<this._numOfTextInputs?!0:!1};a.prototype.setSubmitValue=function(a){k(a)&&(this._submitValue=a)};a.prototype.getSubmitValue=function(){return this._submitValue};a.prototype.setFormAction=function(a){k(a)&&""!==a&&(a=new URI(a),a.is(l.LINK_DATA.URL)&&(this._formActionUri=a))};a.prototype.setFormActionAttribute=function(a){k(a)&&""!==a&&(this._formActionAttribute=a)};a.prototype.getFormAction=function(){return e(this._formActionUri)?
null:this._formActionUri.toString()};a.prototype.getFormActionAttribute=function(){return e(this._formActionAttribute)?null:this._formActionAttribute};a.prototype.getFormActionExtension=function(){return e(this._formActionUri)?null:this._formActionUri.suffix()};a.prototype.getFormActionScheme=function(){return e(this._formActionUri)?null:this._formActionUri.protocol()};a.prototype.getFormActionHostname=function(){return e(this._formActionUri)?null:this._formActionUri.hostname()};a.prototype.incrementNumOfSelects=
function(){this._numOfSelects++};a.prototype.getNumOfSelects=function(){return this._numOfSelects};a.prototype.incrementNumOfTextAreas=function(){this._numOfTextAreas++};a.prototype.getNumOfTextAreas=function(){return this._numOfTextAreas};a.prototype.getNumOfInputs=function(){return this._numOfSelects+this._numOfTextAreas+this._numOfTextInputs+this._numOfPasswordInputs+this._numOfSubmitInputs+this._hiddenInputsData.size};a.prototype.incrementNumOfTextInputs=function(){this._numOfTextInputs++};a.prototype.getNumOfTextInputs=
function(){return this._numOfTextInputs};a.prototype.incrementNumOfPasswordInputs=function(){this._numOfPasswordInputs++};a.prototype.getNumOfPasswordInputs=function(){return this._numOfPasswordInputs};a.prototype.incrementNumOfSubmitInputs=function(){this._numOfSubmitInputs++};a.prototype.getNumOfSubmitInputs=function(){return this._numOfSubmitInputs};a.prototype.addHiddenInputData=function(a,c){k(a)&&!e(c)&&(this._hiddenInputsData.set(a,c),!b(this._hiddenInputEmailValue)&&"string"==typeof c.valueOf()&&
320>=c.length&&/\S+?@\S+?\.\S+?/.test(c)&&(this._hiddenInputEmailValue=c))};a.prototype.getNumOfHiddenInputs=function(){return this._hiddenInputsData.size};a.prototype.hasHiddenInputEmailValue=function(){return e(this._hiddenInputEmailValue)?!1:!0};a.prototype.getHiddenInputEmailValue=function(){return this._hiddenInputEmailValue};a.prototype.getHiddenInputValue=function(a){return k(a)?this._hiddenInputsData.get(a):null};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.ImageData=function(a,c){var b=a.utils.isString,e=a.utils.isInteger,k=a.utils.isNil;a=function(){this._widths=[];this._heights=[];this._totalImageArea=0;this._sourceUrls=[];this._validUrls=[];this._uniqueUrlsMap=new Map;this._uniqueHostnamesMap=new Map;this._numOfTdHostedImages=0;this._tdImagesCalculated=this._isTdImagesCalculated=!1};a.prototype.addValidUrl=function(a){b(a)&&""!==a&&this._validUrls.push(a)};a.prototype.getValidUrls=function(){return this._validUrls};a.prototype.getUniqueUrlPaths=
function(){var a=[];this._uniqueUrlsMap.forEach(function(c,d,b){c=(new URI(d)).path();a.includes(c)||a.push(c)});return a};a.prototype.addToUniqueUrlsMap=function(a){if(b(a)&&""!==a){var c=this._uniqueUrlsMap.get(a);k(c)?c=1:c++;this._uniqueUrlsMap.set(a,c)}};a.prototype.getUniqueUrlsMap=function(){return this._uniqueUrlsMap};a.prototype.getUniqueUrls=function(){var a=[];this._uniqueUrlsMap.forEach(function(c,d,b){a.push(d)});return a};a.prototype.getUniqueUrlCount=function(a){if(!b(a))throw Error("Invalid url");
return this._uniqueUrlsMap.has(a)?this._uniqueUrlsMap.get(a):0};a.prototype.addToUniqueHostnamesMap=function(a){if(b(a)&&""!==a){var c=this._uniqueHostnamesMap.get(a);k(c)?c=1:c++;this._uniqueHostnamesMap.set(a,c)}};a.prototype.getUniqueHostnamesMap=function(){return this._uniqueHostnamesMap};a.prototype.getHostnameCount=function(a){if(!b(a)||""===a)throw Error("Invalid input url");return this._uniqueHostnamesMap.has(a)?this._uniqueHostnamesMap.get(a):0};a.prototype.addSourceUrl=function(a){b(a)&&
""!==a&&this._sourceUrls.push(a)};a.prototype.getSourceUrls=function(){return this._sourceUrls};a.prototype.getNumOfImages=function(){return this._sourceUrls.length};a.prototype.incrementNumOfTdHostedImages=function(){this._numOfTdHostedImages++};a.prototype.getNumOfTdHostedImages=function(){var a=c.defManager;if(!this._tdImagesCalculated){for(var b=Array.from(this.getUniqueHostnamesMap().keys()),d=0;d<b.length;d++)a.getDefObject().findInExceptionDomains(b[d])||a.getDefObject().findInTrustedDomains(b[d])&&
this.incrementNumOfTdHostedImages();this._tdImagesCalculated=!0}return this._numOfTdHostedImages};a.prototype.addDimension=function(a,c){!e(a)||0>a||!e(c)||0>c||(this._widths.push(a),this._heights.push(c),this._totalImageArea+=a*c)};a.prototype.getWidth=function(a){if(!e(a)||0>a||a>this._widths.length-1)throw Error("Invalid index");return this._widths[a]};a.prototype.getHeight=function(a){if(!e(a)||0>a||a>this._heights.length-1)throw Error("Invalid index");return this._heights[a]};a.prototype.getWidths=
function(){return this._widths};a.prototype.getHeights=function(){return this._heights};a.prototype.getTotalImageArea=function(){return this._totalImageArea};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.LinkData=function(a,c){var b=a.utils.isString,e=a.utils.isNil;a=function(){this._validUrls=[];this._uniqueUrlsMap=new Map;this._uniqueHostnamesMap=new Map;this._hrefs=[];this._linkInnerTexts=[];this._anchorTexts=[];this._numOfTdLinks=0;this._isTdLinksCalculated=!1};a.prototype.addValidUrl=function(a){b(a)&&""!==a&&this._validUrls.push(a)};a.prototype.getValidUrls=function(){return this._validUrls};a.prototype.addToUniqueUrlsMap=function(a){if(b(a)&&""!==a){var c=this._uniqueUrlsMap.get(a);
e(c)?c=1:c++;this._uniqueUrlsMap.set(a,c)}};a.prototype.getUniqueUrlsMap=function(){return this._uniqueUrlsMap};a.prototype.getUniqueUrlCount=function(a){if(!b(a))throw Error("Invalid url");return this._uniqueUrlsMap.has(a)?this._uniqueUrlsMap.get(a):0};a.prototype.addToUniqueHostnamesMap=function(a){if(b(a)&&""!==a){var c=this._uniqueHostnamesMap.get(a);e(c)?c=1:c++;this._uniqueHostnamesMap.set(a,c)}};a.prototype.getUniqueHostnamesMap=function(){return this._uniqueHostnamesMap};a.prototype.getHostnameCount=
function(a){if(!b(a)||""===a)throw Error("Invalid input url");return this._uniqueHostnamesMap.has(a)?this._uniqueHostnamesMap.get(a):0};a.prototype.addHref=function(a){b(a)&&""!==a&&this._hrefs.push(a)};a.prototype.getHrefs=function(){return this._hrefs};a.prototype.getNumOfLinks=function(){return this._hrefs.length};a.prototype.addLinkInnerText=function(a){b(a)&&this._linkInnerTexts.push(a)};a.prototype.getLinkInnerTexts=function(){return this._linkInnerTexts};a.prototype.addAnchorText=function(a){b(a)&&
this._anchorTexts.push(a)};a.prototype.getAnchorTexts=function(){return this._anchorTexts};a.prototype.incrementNumOfTdLinks=function(){this._numOfTdLinks++};a.prototype.getNumOfTdLinks=function(){var a=c.defManager;if(!this._isTdLinksCalculated){for(var b=Array.from(this.getUniqueHostnamesMap().keys()),e=0;e<b.length;e++)a.getDefObject().findInExceptionDomains(b[e])||a.getDefObject().findInTrustedDomains(b[e])&&this.incrementNumOfTdLinks();this._isTdLinksCalculated=!0}return this._numOfTdLinks};
return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageData=function(a,c){var b=a.utils.isString,e=a.utils.isBoolean,k=a.utils.isInteger,l=a.utils.isNil,h=a.utils.getCompanyDomain,d=a.utils.isUrlAnIp,p=c.constants.domConstants;a=function(){this._shortcutIconUri=this._uri=this._referrerUrl=this._bodyBackgroundImageExtension=null;this._comments=[];this._hasFlash=!1;this._numOfVisiblePTags=this._numOfPTags=0;this._signature="";this._numOfTextAreaTags=this._numOfSelectTags=this._numOfTrTags=this._numOfBrTags=0;this._buttonTexts=[];
this._numOfElements=this._numOfPasswordInputs=this._numOfTextInputs=0};a.prototype.setBodyBackgroundImageExtension=function(a){this._bodyBackgroundImageExtension=a};a.prototype.getBodyBackgroundImageExtension=function(){return this._bodyBackgroundImageExtension};a.prototype.setReferrerUrl=function(a){b(a)&&(this._referrerUrl=a)};a.prototype.getReferrerUrl=function(){return this._referrerUrl};a.prototype.setUrl=function(a){b(a)&&(a=new URI(a),a.is(p.LINK_DATA.URL)&&(this._uri=a))};a.prototype.getUrl=
function(){return l(this._uri)?null:this._uri.toString()};a.prototype.getUrlHostname=function(){return l(this._uri)?null:this._uri.hostname()};a.prototype._getHostNameWithoutSubDomain=function(a){return l(a)?null:a.hostname().replace("www.","")};a.prototype.getUrlHostnameExcludingSubDomain=function(){return l(this._uri)?null:this._getHostNameWithoutSubDomain(this._uri)};a.prototype.getReferrerUrlHostnameExcludingSubDomain=function(){var a=new URI(this.getReferrerUrl());return this._getHostNameWithoutSubDomain(a)};
a.prototype.getUrlScheme=function(){return l(this._uri)?null:this._uri.scheme()};a.prototype.getUrlTld=function(){return l(this._uri)?null:this._uri.tld()};a.prototype.getUrlUserName=function(){return l(this._uri)?null:this._uri.username()};a.prototype.getUrlPassword=function(){return l(this._uri)?null:this._uri.password()};a.prototype.setShortcutIconUrl=function(a){b(a)&&(a=new URI(a),a.is(p.LINK_DATA.URL)&&(this._shortcutIconUri=a))};a.prototype.getShortcutIconHostName=function(){return l(this._shortcutIconUri)?
null:this._shortcutIconUri.hostname()};a.prototype.addComment=function(a){b(a)&&this._comments.push(a)};a.prototype.getComments=function(){return this._comments};a.prototype.setFlashExists=function(a){e(a)&&(this._hasFlash=a)};a.prototype.hasFlash=function(){return this._hasFlash};a.prototype.incrementNumOfPTags=function(){this._numOfPTags++};a.prototype.getNumOfPTags=function(){return this._numOfPTags};a.prototype.incrementNumOfVisiblePTags=function(){this._numOfVisiblePTags++};a.prototype.getNumOfVisiblePTags=
function(){return this._numOfVisiblePTags};a.prototype.incrementNumOfBrTags=function(){this._numOfBrTags++};a.prototype.getNumOfBrTags=function(){return this._numOfBrTags};a.prototype.incrementNumOfTrTags=function(){this._numOfTrTags++};a.prototype.getNumOfTrTags=function(){return this._numOfTrTags};a.prototype.appendSignature=function(a){b(a)&&(this._signature+=a)};a.prototype.getSignature=function(){return this._signature};a.prototype.incrementNumOfSelectTags=function(){this._numOfSelectTags++};
a.prototype.getNumOfSelectTags=function(){return this._numOfSelectTags};a.prototype.incrementNumOfTextAreaTags=function(){this._numOfTextAreaTags++};a.prototype.getNumOfTextAreaTags=function(){return this._numOfTextAreaTags};a.prototype.addButtonText=function(a){b(a)&&this._buttonTexts.push(a)};a.prototype.getButtonTexts=function(){return this._buttonTexts};a.prototype.incrementNumOfTextInputs=function(){this._numOfTextInputs++};a.prototype.getNumOfTextInputs=function(){return this._numOfTextInputs};
a.prototype.incrementNumOfPasswordInputs=function(){this._numOfPasswordInputs++};a.prototype.getNumOfPasswordInputs=function(){return this._numOfPasswordInputs};a.prototype.setNumOfElements=function(a){k(a)&&(this._numOfElements=a)};a.prototype.getNumOfElements=function(){return this._numOfElements};a.prototype.isUrlAnIp=function(){return l(this._uri)?null:d(this._uri.toString())};a.prototype.isUrlAnIntranet=function(){if(l(this._uri))return null;var a=this._uri.hostname();return 0<a.length&&-1===
a.indexOf(".")?!0:!1};a.prototype.getBrandNameFromUrl=function(){return l(this._uri)?null:h(this._uri.toString())};a.prototype.getUrlPath=function(){return l(this._uri)?null:this._uri.path()};a.prototype.getUrlFileExtension=function(){return l(this._uri)?null:this._uri.suffix().toLowerCase()};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.ScriptData=function(a,c){var b=a.utils.isString,e=a.utils.isNil;a=function(){this._scriptSources=[];this._scriptTexts=[];this._scriptLanguages=[];this._uniqueHostnamesMap=new Map;this._numOfTdLinksInScripts=0;this._isTdLinksInScriptsCalculated=!1};a.prototype.addScriptSource=function(a){b(a)&&""!==a&&this._scriptSources.push(a)};a.prototype.getScriptSources=function(){return this._scriptSources};a.prototype.addScriptText=function(a){!b(a)|""===a||this._scriptTexts.push(a)};a.prototype.getScriptTexts=
function(){return this._scriptTexts};a.prototype.addScriptLanguage=function(a){b(a)&&""!==a&&this._scriptLanguages.push(a)};a.prototype.getScriptLanguages=function(){return this._scriptLanguages};a.prototype.addToUniqueHostnamesMap=function(a){if(b(a)&&""!==a){var c=this._uniqueHostnamesMap.get(a);e(c)?c=1:c++;this._uniqueHostnamesMap.set(a,c)}};a.prototype.getUniqueHostnamesMap=function(){return this._uniqueHostnamesMap};a.prototype.incrementNumOfTdLinksInScripts=function(){this._numOfTdLinksInScripts++};
a.prototype.getNumOfTdScripts=function(){var a=c.defManager;if(!this._isTdLinksInScriptsCalculated){for(var b=Array.from(this.getUniqueHostnamesMap().keys()),e=0;e<b.length;e++)a.getDefObject().findInExceptionDomains(b[e])||a.getDefObject().findInTrustedDomains(b[e])&&this.incrementNumOfTdLinksInScripts();this._isTdLinksInScriptsCalculated=!0}return this._numOfTdLinksInScripts};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.TextData=function(a,c){var b=a.utils.isString,e=a.utils.isInteger,k=a.utils.isNil,l=/[^\u0000-\u00ff]/;a=function(){this._pageTitle=null;this._copyrightStrings=[];this._bodytextContent=this._bodyInnerText=null;this._linesCount=this._wordsCount=0;this._labelTextsMap=new Map;this._hasDbcsLabel=!1};a.prototype.setBodyTextContent=function(a){b(a)&&(this._bodytextContent=a)};a.prototype.getBodyTextContent=function(){return this._bodytextContent};a.prototype.setBodyInnerText=function(a){b(a)&&
(this._bodyInnerText=a)};a.prototype.getBodyInnerText=function(){return this._bodyInnerText};a.prototype.setPageTitle=function(a){this._pageTitle=a};a.prototype.getPageTitle=function(){return this._pageTitle};a.prototype.addCopyrightString=function(a){b(a)&&""!==a&&this._copyrightStrings.push(a)};a.prototype.getCopyrightStrings=function(){return this._copyrightStrings};a.prototype.setLinesCount=function(a){e(a)&&(this._linesCount=a)};a.prototype.getLinesCount=function(){return this._linesCount};a.prototype.setWordsCount=
function(a){e(a)&&(this._wordsCount=a)};a.prototype.getWordsCount=function(){return this._wordsCount};a.prototype.getBodyInnerTextLength=function(){return k(this._bodyInnerText)?0:this._bodyInnerText.length};a.prototype.addLabelText=function(a,c){b(a)&&""!==a&&b(c)&&""!==c&&(this._labelTextsMap.set(a,c),!this._hasDbcsLabel&&l.test(c)&&(this._hasDbcsLabel=!0))};a.prototype.isLabeledElementExists=function(a){if(!b(a)||""===a)throw Error("Invalid inputId");return this._labelTextsMap.has(a)};a.prototype.getLabelTexts=
function(){return this._labelTextsMap};a.prototype.hasDbcsLabel=function(){return this._hasDbcsLabel};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.domParserFactory=function(a,c){var b=c.constants.domConstants,e=a.utils.isInteger;return{getParser:function(a){if(!e(a))throw Error("Invalid parser type");switch(a){case b.PARSER_TYPE.FORMS_PARSER:return new c.FormsParser;case b.PARSER_TYPE.PAGE_PARSER:return new c.PageParser;case b.PARSER_TYPE.LINK_PARSER:return new c.LinkParser;case b.PARSER_TYPE.NODE_PARSER:return new c.NodeParser;case b.PARSER_TYPE.SCRIPT_PARSER:return new c.ScriptParser;default:return null}}}}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.DomParser=function(a,c){var b=a.utils.isNil,e=a.utils.isInteger,k=a.utils.isString,l=a.utils.isFunction,h=c.constants.domConstants;a=function(a){if(!k(a))throw Error("Invalid DOM parser name");if(b(URI))throw Error("URI library is missing");this._name=a;this._domObject=this._endTime=null};a.prototype.initialize=function(a,c){if(b(a)||!l(a.getData))throw Error("Invalid domObject instance");if(!e(c))throw Error("Invalid start time");this._domObject=a;this._endTime=c+h.DOM_PARSER_LIMIT.MAX_TIME};
a.prototype.parse=function(){throw Error("Super class should not be called directly for this method");};a.prototype.isInitialized=function(){return b(this._domObject)?!1:!0};a.prototype.getName=function(){return this._name};a._getPageDom=function(){return document};a.prototype._isTimedOut=function(){return(new Date).getTime()>this._endTime};a._getMaxLength=function(a,c){if(!e(a)||!e(c))throw Error("Invalid inputs");return a>c?c:a};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.FormsParser=function(a,c){var b=c.DomParser,e=c.FormData,k=a.utils.isNil,l=a.utils.isntNil,h=a.utils.isString,d=c.constants.domConstants;a=function(){b.call(this,"Forms Parser")};a.prototype=Object.create(b.prototype);a.prototype._processInputElement=function(a,c){if(!k(a)&&!k(c))switch(a.type.toUpperCase()){case d.INPUT_TYPE.TEXT:c.incrementNumOfTextInputs();break;case d.INPUT_TYPE.SUBMIT:h(a.value)&&c.setSubmitValue(a.value.toLowerCase());c.incrementNumOfSubmitInputs();break;
case d.INPUT_TYPE.PASSWORD:c.incrementNumOfPasswordInputs();break;case d.INPUT_TYPE.FILE:c.incrementNumOfTextInputs();break;case d.INPUT_TYPE.HIDDEN:var b=null;h(a.name)&&""!==a.name?b=a.name.toLowerCase():h(a.id)&&""!==a.id&&(b=a.id.toLowerCase());l(b)&&h(a.value)&&c.addHiddenInputData(b,a.value.toLowerCase());break;case d.INPUT_TYPE.BUTTON:case d.INPUT_TYPE.CHECKBOX:case d.INPUT_TYPE.IMAGE:case d.INPUT_TYPE.RADIO:case d.INPUT_TYPE.RESET:break;default:c.incrementNumOfTextInputs()}};a.prototype.parse=
function(){if(!this.isInitialized())throw Error("Parser not initialized");for(var a=b._getPageDom(),g=b._getMaxLength(a.forms.length,d.DOM_PARSER_LIMIT.MAX_FORMS),f=0;f<g;f++){if(this._isTimedOut())throw c.telemetryWrapper.sendErrors("Timeout while parsing formsData"),Error("Timeout occurred while parsing");var k=a.forms[f],l=new e,u=k[d.FORM_ACTION];h(u)&&(l.setFormAction(u.toLowerCase()),l.setFormActionAttribute(k.getAttribute(d.FORM_ACTION)));u=b._getMaxLength(k.elements.length,d.DOM_PARSER_LIMIT.MAX_FORM_ELEMENTS);
for(var r=0;r<u;r++){var t=k.elements[r];switch(t.tagName.toUpperCase()){case d.DOM_ELEMENT.INPUT:this._processInputElement(t,l);break;case d.DOM_ELEMENT.SELECT:l.incrementNumOfSelects();break;case d.DOM_ELEMENT.TEXTAREA:l.incrementNumOfTextAreas()}}this._domObject.addFormData(l)}};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.LinkParser=function(a,c){var b=c.DomParser,e=c.constants.domConstants,k=a.utils.isNil,l=a.utils.isString;a=function(){b.call(this,"Link Parser")};a.prototype=Object.create(b.prototype);var h=function(a,b){var d=new URI(a);!d.is(e.LINK_DATA.URL)||d.protocol()!==e.LINK_DATA.HTTP&&d.protocol()!==e.LINK_DATA.HTTPS||(b.addValidUrl(a),b.addToUniqueUrlsMap(a),a=c.defManager.getDefObject().getActualUrlIfProxy(a),l(a)&&(a=new URI(a.toLowerCase()),a.is(e.LINK_DATA.URL)&&b.addToUniqueHostnamesMap(a.hostname())))};
a.prototype.parse=function(){if(!this.isInitialized())throw Error("Parser not initialized");if(this._isTimedOut())throw c.telemetryWrapper.sendErrors("Timeout while parsing linkData"),Error("Timeout occurred while parsing");var a=this._domObject.getData(e.OBJECT_TYPE.LINK_DATA);if(k(a))throw Error("Link data not set in domObject");var f=this._domObject.getData(e.OBJECT_TYPE.PAGE_DATA);if(k(f))throw Error("Page data not set in domObject");for(var g=b._getPageDom(),n=g.getElementsByTagName(e.DOM_ELEMENT.LINK),
m=b._getMaxLength(n.length,e.DOM_PARSER_LIMIT.MAX_LINKS),q=0;q<m;q++)if(n[q].rel===e.LINK_DATA.SHORTCUT_ICON){f.setShortcutIconUrl(n[q].href.toLowerCase());break}f=g.getElementsByTagName(e.DOM_ELEMENT.ANCHOR);n=b._getMaxLength(f.length,e.DOM_PARSER_LIMIT.MAX_LINKS);for(m=0;m<n;m++)l(f[m].href)&&(q=f[m].href.toLowerCase(),a.addHref(q),h(q,a),l(f[m].text)&&a.addLinkInnerText(f[m].text.toLowerCase().trim())),l(f[m].text)&&a.addAnchorText(f[m].text.toLowerCase().trim());g=g.getElementsByTagName(e.DOM_ELEMENT.AREA);
f=b._getMaxLength(g.length,e.DOM_PARSER_LIMIT.MAX_LINKS);for(n=0;n<f;n++)l(g[n].href)&&(m=g[n].href.toLowerCase(),a.addHref(m),h(m,a))};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.NodeParser=function(a,c){var b=c.DomParser,e=c.constants.domConstants,k=a.utils.isNil,l=a.utils.isntNil,h=a.utils.isInteger,d=a.utils.isString;a=function(){b.call(this,"Node Parser")};a.prototype=Object.create(b.prototype);var p=function(a,b){var g=a[e.IMAGE_DATA.SOURCE];if(d(g)&&""!==g){var f=a[e.IMAGE_DATA.WIDTH],p=a[e.IMAGE_DATA.HEIGHT];a=a.getBoundingClientRect();if(!h(f)||0>=f)f=Math.floor(a.width);if(!h(p)||0>=p)p=Math.floor(a.height);if(h(f)&&0<f&&h(p)&&0<p){b.addDimension(f,
p);f=new URI(g.toLowerCase());b.addSourceUrl(f.toString());if(f.protocol()===e.LINK_DATA.EMBEDDED)return b.addValidUrl(f.toString()),b.addToUniqueUrlsMap(f.toString()),!0;if(!f.is(e.LINK_DATA.URL))return!1;if(f.protocol()===e.LINK_DATA.HTTP||f.protocol()===e.LINK_DATA.HTTPS){b.addValidUrl(f.toString());b.addToUniqueUrlsMap(f.toString());g=c.defManager.getDefObject().getActualUrlIfProxy(g);if(!d(g))return!1;g=new URI(g.toLowerCase());if(!g.is(e.LINK_DATA.URL))return!1;b.addToUniqueHostnamesMap(g.hostname());
return!0}}}return!1},g=function(a){if(!a)return c.constants.EMPTY_STRING;if(!a.children||0===a.children.length){var b;if(b=a.nodeName===e.DOM_ELEMENT.INPUT||a.nodeName===e.DOM_ELEMENT.BUTTON)a&&a.nodeType===Node.ELEMENT_NODE?(b=window.getComputedStyle(a),b=!b||b.display===e.STYLE_ATTRIBUTES.NONE||b.visibility===e.STYLE_ATTRIBUTES.HIDDEN||b.opacity&&a.type!==e.INPUT_TYPE.RADIO&&b.opacity===e.STYLE_ATTRIBUTES.ZERO_OPACITY||0===a.offsetWidth||0===a.offsetHeight?!1:!0):b=!1;if(b)return null;a:{switch(a.nodeName){case e.DOM_ELEMENT.LABEL:case e.DOM_ELEMENT.DIV:case e.DOM_ELEMENT.SPAN:case e.DOM_ELEMENT.TD:case e.DOM_ELEMENT.ANCHOR:case e.DOM_ELEMENT.TH:case e.DOM_ELEMENT.LI:case e.DOM_ELEMENT.P:case e.DOM_ELEMENT.B:case e.DOM_ELEMENT.I:case e.DOM_ELEMENT.U:case e.DOM_ELEMENT.H1:case e.DOM_ELEMENT.H2:case e.DOM_ELEMENT.H3:case e.DOM_ELEMENT.H4:case e.DOM_ELEMENT.H5:case e.DOM_ELEMENT.H6:case e.DOM_ELEMENT.FONT:case e.DOM_ELEMENT.STRONG:case e.DOM_ELEMENT.EM:b=
!0;break a}b=!1}return b&&a.innerText&&a.innerText.trim()!=c.constants.EMPTY_STRING?a.innerText.trim():c.constants.EMPTY_STRING}for(b=a.children.length-1;0<=b;b--){var d=g(a.children[b]);if(null===d)return null;if(d!==c.constants.EMPTY_STRING)return d}return c.constants.EMPTY_STRING},n=function(a){if(!a||a.nodeName===e.DOM_ELEMENT.BODY||!a.parentElement)return null;for(var b=Array.from(a.parentElement.children).indexOf(a)-1;0<=b;b--){var d=g(a.parentElement.children[b]);if(null===d||d!=c.constants.EMPTY_STRING)return d}return n(a.parentElement)},
m=function(a,b){if(!a.id||!b.isLabeledElementExists(a.id)){var g=null;a.previousElementSibling&&a.previousElementSibling.tagName===e.DOM_ELEMENT.DIV&&1===a.previousElementSibling.childNodes.length&&(g=a.previousElementSibling.innerText);k(g)&&(g=n(a));d(a.placeholder)&&""!==a.placeholder&&(k(g)&&(g=c.constants.EMPTY_STRING),g+=" "+a.placeholder,g=g.trim());a=a.form&&a.form.id&&a.id?a.form.id+"."+a.id:Date.now().toString();l(g)&&b.addLabelText(a,g.toLowerCase())}};a.prototype._parseElement=function(a,
g,h,f,n){if(0===g%10&&this._isTimedOut())throw c.telemetryWrapper.sendErrors("Timeout while parsing textData"),Error("Timeout occurred while parsing");if(g>=e.DOM_PARSER_LIMIT.MAX_ELEMENTS)return g;switch(a.nodeType){case Node.COMMENT_NODE:d(a.nodeValue)&&h.addComment(a.nodeValue.trim().toLowerCase());g++;break;case Node.ELEMENT_NODE:if(d(a.tagName))switch(a.tagName.toUpperCase()){case e.DOM_ELEMENT.BODY:var q=a[e.BODY_DATA.BACKGROUND];d(q)&&(q=new URI(q.toLowerCase()),q.is(e.LINK_DATA.URL)?h.setBodyBackgroundImageExtension(q.suffix()):
h.setBodyBackgroundImageExtension(""));break;case e.DOM_ELEMENT.OBJECT:if(h.hasFlash())break;-1!==a.innerHTML.search(/.swf/i)&&h.setFlashExists(!0);break;case e.DOM_ELEMENT.P:h.incrementNumOfPTags();0<a.innerHTML.length&&h.incrementNumOfVisiblePTags();h.appendSignature(e.SIGNATURE_CODE.NEWLINE);break;case e.DOM_ELEMENT.BR:h.incrementNumOfBrTags();h.appendSignature(e.SIGNATURE_CODE.NEWLINE);break;case e.DOM_ELEMENT.TR:h.incrementNumOfTrTags();h.appendSignature(e.SIGNATURE_CODE.NEWLINE);break;case e.DOM_ELEMENT.TD:h.appendSignature(e.SIGNATURE_CODE.NEWLINE);
break;case e.DOM_ELEMENT.HR:h.appendSignature(e.SIGNATURE_CODE.LINE);break;case e.DOM_ELEMENT.UL:case e.DOM_ELEMENT.LI:case e.DOM_ELEMENT.CO:case e.DOM_ELEMENT.OL:case e.DOM_ELEMENT.DIV:h.appendSignature(e.SIGNATURE_CODE.NEWLINE);break;case e.DOM_ELEMENT.SELECT:h.appendSignature(e.SIGNATURE_CODE.SELECT);h.incrementNumOfSelectTags();break;case e.DOM_ELEMENT.TEXTAREA:h.appendSignature(e.SIGNATURE_CODE.TEXTAREA);h.incrementNumOfTextAreaTags();break;case e.DOM_ELEMENT.BUTTON:q=a.innerText;d(q)&&h.addButtonText(q.toLowerCase());
break;case e.DOM_ELEMENT.INPUT:switch(a.type.toUpperCase()){case e.INPUT_TYPE.TEXT:case e.INPUT_TYPE.EMAIL:h.incrementNumOfTextInputs();h.appendSignature(e.SIGNATURE_CODE.INPUT);m(a,n);break;case e.INPUT_TYPE.PASSWORD:h.appendSignature(e.SIGNATURE_CODE.INPUT);h.incrementNumOfPasswordInputs();m(a,n);break;case e.INPUT_TYPE.FILE:h.incrementNumOfTextInputs();h.appendSignature(e.SIGNATURE_CODE.FILE);m(a,n);break;case e.INPUT_TYPE.HIDDEN:h.appendSignature(e.SIGNATURE_CODE.INPUT);break;case e.INPUT_TYPE.BUTTON:h.appendSignature(e.SIGNATURE_CODE.BUTTON);
h.addButtonText(a.value.toLowerCase());break;case e.INPUT_TYPE.SUBMIT:case e.INPUT_TYPE.RESET:h.appendSignature(e.SIGNATURE_CODE.BUTTON);break;case e.INPUT_TYPE.CHECKBOX:h.appendSignature(e.SIGNATURE_CODE.CHECKBOX);break;case e.INPUT_TYPE.RADIO:h.appendSignature(e.SIGNATURE_CODE.RADIO);break;case e.INPUT_TYPE.IMAGE:h.appendSignature(e.SIGNATURE_CODE.IMAGE);break;default:h.incrementNumOfTextInputs(),h.appendSignature(e.SIGNATURE_CODE.INPUT)}break;case e.DOM_ELEMENT.IMG:p(a,f)&&h.appendSignature(e.SIGNATURE_CODE.IMAGE);
break;case e.DOM_ELEMENT.LABEL:if(d(a.htmlFor)&&""!==a.htmlFor&&!n.isLabeledElementExists(a.htmlFor)&&(q=b._getPageDom().getElementById(a.htmlFor),!k(q)&&q.tagName.toUpperCase()===e.DOM_ELEMENT.INPUT))switch(q.type.toUpperCase()){case e.INPUT_TYPE.TEXT:case e.INPUT_TYPE.PASSWORD:case e.INPUT_TYPE.FILE:case e.INPUT_TYPE.EMAIL:q=l(a.form)&&""!==a.form.id?a.form.id+".":"",n.addLabelText(q+a.htmlFor,a.innerText.trim().toLowerCase())}}g++}if(a.hasChildNodes())for(q=0;q<a.childNodes.length;q++)g=this._parseElement(a.childNodes[q],
g,h,f,n);return g};a.prototype.parse=function(){if(!this.isInitialized())throw Error("Parser not initialized");if(this._isTimedOut())throw c.telemetryWrapper.sendErrors("Timeout while parsing textData"),Error("Timeout occurred while parsing");var a=b._getPageDom(),d=this._domObject.getData(e.OBJECT_TYPE.PAGE_DATA);if(k(d))throw Error("Page data not set in domObject");var g=this._domObject.getData(e.OBJECT_TYPE.IMAGE_DATA);if(k(g))throw Error("Image data not set in domObject");var h=this._domObject.getData(e.OBJECT_TYPE.TEXT_DATA);
if(k(h))throw Error("Text data not set in domObject");for(var f=0,p=0;p<a.childNodes.length&&!(f=this._parseElement(a.childNodes[p],f,d,g,h),f>=e.DOM_PARSER_LIMIT.MAX_ELEMENTS);p++);d.setNumOfElements(f)};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageParser=function(a,c){var b=c.DomParser,e=c.constants.domConstants,k=a.utils.isNil,l=a.utils.isString;a=function(){b.call(this,"Page Parser")};a.prototype=Object.create(b.prototype);a.prototype.parse=function(){if(!this.isInitialized())throw Error("Parser not initialized");if(this._isTimedOut())throw c.telemetryWrapper.sendErrors("Timeout while parsing pageData"),Error("Timeout occurred while parsing");var a=b._getPageDom(),d=this._domObject.getData(e.OBJECT_TYPE.PAGE_DATA);
if(k(d))throw Error("Page data not set in domObject");var f=this._domObject.getData(e.OBJECT_TYPE.TEXT_DATA);if(k(f))throw Error("Text data not set in domObject");l(a.referrer)&&d.setReferrerUrl(a.referrer.toLowerCase());l(a.title)&&f.setPageTitle(a.title.toLowerCase());var g=c.defManager.getDefObject().getActualUrlIfProxy(a.URL);d.setUrl(g.toLowerCase());if(!k(a.body)&&!k(a.body.innerText)&&(d=a.body.innerText.trim().toLowerCase(),""!==d&&(a=a.body.textContent.trim().toLowerCase(),""!==a))){f.setBodyTextContent(a);
a=d.split("\n");f.setBodyInnerText(a.join(" "));f.setLinesCount(a.length);a=d.match(/[^\s]+/g);f.setWordsCount(a.length);d=e.PAGE_DATA.COPYRIGHT_SYMBOLS;for(var n in a){g=a[n];for(var m in d)if(-1!==g.indexOf(d[m])){g="";var q=Number(n)+8;n-=3;for(0>n&&(n=0);n<=q&&n<a.length;n++)g+=a[n]+" ";--n;f.addCopyrightString(g.trim());break}}}};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.ScriptParser=function(a,c){var b=c.DomParser,e=c.constants.domConstants,k=a.utils.isString,l=a.utils.isNil;a=function(){b.call(this,"Script Parser")};a.prototype=Object.create(b.prototype);a.prototype.parse=function(){if(!this.isInitialized())throw Error("Parser not initialized");if(this._isTimedOut())throw c.telemetryWrapper.sendErrors("Timeout while parsing scriptData"),Error("Timeout occurred while parsing");var a=this._domObject.getData(e.OBJECT_TYPE.SCRIPT_DATA);if(l(a))throw Error("Script data not set in domObject");
for(var d=b._getPageDom(),f=b._getMaxLength(d.scripts.length,e.DOM_PARSER_LIMIT.MAX_SCRIPTS),g=0;g<f;g++){k(d.scripts[g].text)&&a.addScriptText(d.scripts[g].text.toLowerCase());var n=d.scripts[g].getAttribute(e.SCRIPT_DATA.LANGUAGE);k(n)&&""!==n&&a.addScriptLanguage(n.toLowerCase());n=d.scripts[g][e.SCRIPT_DATA.SOURCE];k(n)&&""!==n&&a.addScriptSource(n.toLowerCase())}};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.DomObject=function(a,c){var b=a.utils.isInteger,e=a.utils.isNil,k=c.constants.domConstants;a=function(){this._formsData=[];this._imageData=new c.ImageData;this._linkData=new c.LinkData;this._pageData=new c.PageData;this._scriptData=new c.ScriptData;this._textData=new c.TextData};a.prototype.getData=function(a){if(!b(a))throw Error("Invalid data type");switch(a){case k.OBJECT_TYPE.FORMS_DATA:return this._formsData;case k.OBJECT_TYPE.IMAGE_DATA:return this._imageData;case k.OBJECT_TYPE.LINK_DATA:return this._linkData;
case k.OBJECT_TYPE.PAGE_DATA:return this._pageData;case k.OBJECT_TYPE.SCRIPT_DATA:return this._scriptData;case k.OBJECT_TYPE.TEXT_DATA:return this._textData}return null};a.prototype.addFormData=function(a){if(e(a))throw Error("Invalid form data");this._formsData.push(a)};a.prototype.getNumOfForms=function(){return this._formsData.length};a.prototype.getNumOfVisibleForms=function(){for(var a=0,c=0;c<this._formsData.length;c++)this._formsData[c].isFormVisible()&&a++;return a};a.prototype.getNumOfPasswordInputsInForms=
function(){for(var a=0,c=0;c<this._formsData.length;c++)a+=this._formsData[c].getNumOfPasswordInputs();return a};a.prototype.getNumOfTextInputsInForms=function(){for(var a=0,c=0;c<this._formsData.length;c++)a+=this._formsData[c].getNumOfTextInputs();return a};a.prototype.getNumOfTextAreasInForms=function(){for(var a=0,c=0;c<this._formsData.length;c++)a+=this._formsData[c].getNumOfTextAreas();return a};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.domManager=function(a,c){var b=c.domParserFactory,e=c.constants.domConstants,k=a.utils.isntNil,l=c.constants,h=a.performanceReporterFactoryProxy,d={};d._domObject=new c.DomObject;d.getDomObject=function(){return d._domObject};d.parseDom=function(a){var c=(new Date).getTime();h.reportStart(l.WCID_LIBRARY,"Parse DOM");try{Object.keys(e.PARSER_TYPE).forEach(function(a,g){a=b.getParser(e.PARSER_TYPE[a]);a.initialize(d.getDomObject(),c);a.parse()}),h.reportEnd(l.WCID_LIBRARY,"Parse DOM"),
d._loadURLLookupData(a)}catch(n){h.reportEnd(l.WCID_LIBRARY,"Parse DOM"),a(!1,n)}};d._loadURLLookupData=function(a){h.reportStart(l.WCID_LIBRARY,"Load Lookupdata");var b=[];b.push({urls:[document.location.href],requestType:c.constants.URL_LOOKUP_DATA_TYPES.PAGE_URL});for(var f=d.getDomObject().getData(e.OBJECT_TYPE.FORMS_DATA),p=[],q=0;q<f.length;q++)k(f[q].getFormAction())&&p.push(f[q].getFormAction());0<p.length&&b.push({urls:p,requestType:c.constants.URL_LOOKUP_DATA_TYPES.FORM_ACTION_URL});f=d.getDomObject().getData(e.OBJECT_TYPE.PAGE_DATA).getReferrerUrlHostnameExcludingSubDomain();
k(f)&&""!==f.trim()&&b.push({urls:[f],requestType:c.constants.URL_LOOKUP_DATA_TYPES.REFERRER_URL});c.defManager.loadURLLookupData(b).then(function(c){h.reportEnd(l.WCID_LIBRARY,"Load Lookupdata");a(!0,null)}).catch(function(c){h.reportEnd(l.WCID_LIBRARY,"Load Lookupdata");a(!1,c)})};return d}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.ExpressionInput=function(a,c){var b=c.constants.indicatorConstants,e=a.utils.isNil,k=a.utils.isString,l=a.utils.isInteger,h=a.utils.isBoolean,d=a.utils.isArray;a=function(a){if(e(a))throw Error("Invalid input for ExpressionInput");this._value=a;k(a)?this._type=b.INPUT_TYPE.STRING:l(a)?this._type=b.INPUT_TYPE.NUMBER:h(a)?this._type=b.INPUT_TYPE.BOOLEAN:d(a)?this._type=b.INPUT_TYPE.ARRAY:this._type=b.INPUT_TYPE.OBJECT};a.prototype.getValue=function(){return this._value};a.prototype.getType=
function(){return this._type};return a}(b.SymBfw,b.WCID)})(executionContext);(function(b){b.WCID.ExpressionResult=function(a,c){var b=a.utils.isBoolean;a=function(a,c){if(!b(a))throw Error("Invalid input for ExpressionResult");this._result=a;this._detail=c};a.prototype.getResult=function(){return this._result};a.prototype.getDetail=function(){return this._detail};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.Indicator=function(a,c){var b=c.constants.indicatorConstants,e=a.utils.isNil,k=a.utils.isArray,l=a.utils.isInteger;a=function(a){if(e(a)||e(a.rule)||!k(a.rule.expressions))throw Error("Invalid indicator");this._indicator=a};a.prototype.getId=function(){return this._indicator.id};a.prototype.getOnWeight=function(){return this._indicator.onWeight};a.prototype.getOffWeight=function(){return this._indicator.offWeight};a.prototype.getTdPriority=function(){return this._indicator.tdPriority};
a.prototype.getCategory=function(){return this._indicator.category};a.prototype.getRuleOperatorId=function(){return e(this._indicator.rule.operatorId)?b.RULE_OPERATOR.AND:this._indicator.rule.operatorId};a.prototype.getExpressionsCount=function(){return this._indicator.rule.expressions.length};a.prototype.getFieldId=function(a){return l(a)&&0<=a&&a<this._indicator.rule.expressions.length?this._indicator.rule.expressions[a].fieldId:null};a.prototype.getMethodId=function(a){return l(a)&&0<=a&&a<this._indicator.rule.expressions.length?
this._indicator.rule.expressions[a].methodId:null};a.prototype.getValueType=function(a){return l(a)&&0<=a&&a<this._indicator.rule.expressions.length?this._indicator.rule.expressions[a].valueType:null};a.prototype.getValue=function(a){return l(a)&&0<=a&&a<this._indicator.rule.expressions.length?this._indicator.rule.expressions[a].value:null};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.IndicatorResult=function(a,c){var b=a.utils.isNil,e=a.utils.isBoolean;a=function(a,c,h,d){if(!e(c)||b(h)||"number"!==typeof h)throw Error("Invalid result/weight passed");this._indicatorIndex=a;this._result=c;this._weight=h;this._detail=d};a.prototype.getResult=function(){return this._result};a.prototype.getWeight=function(){return this._weight};a.prototype.getDetail=function(){return this._detail};a.prototype.getIndicatorIndex=function(){return this._indicatorIndex};return a}(b.SymBfw,
b.WCID)})(executionContext);(function(b){b.WCID.ExpressionMethod=function(a,c){var b=a.utils.isNil;a=function(a){if(b(a))throw Error("Invalid method name");this._name=a};a.prototype.getName=function(){return this._name};a.getActualIndicatorIndex=function(a,c){for(var b=0;b<a.length;b++)if(c===a[b].getIndicatorIndex())return b;return-1};a.prototype.evaluate=function(a){throw Error("Super class should not be called directly for this method");};return a}(b.SymBfw)})(executionContext);
(function(b){b.WCID.CompareStrings=function(a,c){var b=c.constants.indicatorConstants,e=c.ExpressionMethod,k=a.utils.isNil,l=a.utils.isArray,h=a.utils.isntNil;a=function(){e.call(this,"Compare Strings")};a.prototype=Object.create(e.prototype);a.prototype.evaluate=function(a){if(k(a)||!l(a)||2>a.length)throw Error(this._name+" method passed with invalid arguments");var d=a[0],e=a[1];a=!1;if(d.getType()===b.INPUT_TYPE.NUMBER||d.getType()===b.INPUT_TYPE.STRING)switch(e.getType()){case b.INPUT_TYPE.NUMBER:case b.INPUT_TYPE.STRING:a=
d.getValue()==e.getValue();break;case b.INPUT_TYPE.OBJECT:a=(new c.Trie(e.getValue())).findPhrase(d.getValue()),a=h(a)}else if(d.getType()===b.INPUT_TYPE.ARRAY)switch(d=d.getValue(),e.getType()){case b.INPUT_TYPE.OBJECT:e=new c.Trie(e.getValue());for(var f=0;f<d.length;f++){var m=e.findPhrase(d[f]);if(h(m)){a=!0;break}}break;case b.INPUT_TYPE.STRING:for(f=0;f<d.length;f++)if(d[f]===e.getValue()){a=!0;break}}else throw Error(this._name+" method passed with invalid inputs");return!0===a?new c.ExpressionResult(!0,
"Match found"):new c.ExpressionResult(!1,"No Match found")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.NumberComparer=function(a,c){var b=c.constants.indicatorConstants,e=c.ExpressionMethod,k=a.utils.isNil,l=a.utils.isArray,h=a.utils.isInteger;a=function(a,c){e.call(this,a);this._comparisionType=c};a.prototype=Object.create(e.prototype);a.prototype.getComparisonType=function(){return this._comparisionType};a.prototype.compareNumbers=function(a,c,e){if(!h(a)||!h(c))throw Error(this._name+" method passed with invalid input type");switch(e){case b.COMPARISON_TYPE.GREATER_THAN:a=a>
c;break;case b.COMPARISON_TYPE.LESS_THAN:a=a<c;break;case b.COMPARISON_TYPE.EQUAL_TO:a=a===c;break;default:throw Error(this._name+" invalid comparatorType");}return a};a.prototype.evaluate=function(a){var d=!1;if(k(a)||!l(a)||2>a.length)throw Error(this._name+" method passed with invalid arguments");var e=a[0],h=a[1];a=this.getComparisonType();var f=e.getValue();h=h.getValue();if(e.getType()===b.INPUT_TYPE.ARRAY)for(e=0;e<f.length&&!(d=this.compareNumbers(f[e],h,a));e++);else d=this.compareNumbers(f,
h,a);return d?new c.ExpressionResult(!0,a+" check passed"):new c.ExpressionResult(!1,a+" check failed")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.TitleMatchesBrand=function(a,c){var b=c.ExpressionMethod,e=a.utils.isNil,k=c.constants.domConstants,l=a.utils.isString;a=function(){b.call(this,"Title Matches Brand")};a.prototype=Object.create(b.prototype);a.prototype.evaluate=function(a){a=c.domManager.getDomObject();var b=a.getData(k.OBJECT_TYPE.TEXT_DATA);if(e(b))throw Error("text data is null in method "+this._name);a=a.getData(k.OBJECT_TYPE.PAGE_DATA);if(e(a))throw Error("page data is null in method "+this._name);a=a.getBrandNameFromUrl();
if(!l(a))throw Error("brand name is not a string");b=b.getPageTitle();if(!l(b))throw Error("title of the page is not a string");if(1>a.length||1>b.length)b=!1;else{b=b.replace(/[^0-9a-z]/g,"");var h=a.replace(/[^0-9a-z]/g,"");b=-1!==b.indexOf(h)?!0:!1}return b?new c.ExpressionResult(!0,"Title for "+a+" matches"):new c.ExpressionResult(!1,"Title for "+a+" does not match")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.HasKnownSignature=function(a,c){var b=c.constants.domConstants,e=c.ExpressionMethod,k=a.utils.isNil,l=a.utils.isArray,h=a.utils.isInteger,d=window.Levenshtein;a=function(){e.call(this,"Has Known Signature")};a.prototype=Object.create(e.prototype);a.prototype.evaluate=function(a){var e=c.domManager.getDomObject();if(k(a)||!l(a)||1>a.length)throw Error(this._name+" method passed with invalid arguments");var f=e.getData(b.OBJECT_TYPE.PAGE_DATA);if(k(f))throw Error("page data was found to be null");
if(k(d))throw Error("Levenshtein library was not found in "+this._name);a=a[0].getValue();if(k(a))throw Error("Value obtained for signature check is null");if(k(a.allowedPercentage)||0>a.allowedPercentage)throw Error("Allowed percentage difference for the signature of the page is invalid");var p=e=!1,q=a.allowedPercentage;f=f.getSignature();var u=-1,r=0,t=a.signatures;do{var v=t[r].signature;f===v?(e=!0,u=r):r++}while(!e&&r<t.length);if(!e)for(r=0;r<t.length;r++){v=t[r].signature;var w=f;var x=q;
var y=Math.abs(w.length-v.length);y=1>v.length?1:y/v.length;y>x?w=!1:(v=d.get(w,v),!h(v)||0>v?w=!1:(y=1>w.length?v:v/w.length,w=y<x?!0:!1));if(w){u=r;p=!0;break}}return e?new c.ExpressionResult(!0,"Page has exact signature match with "+a.signatures[u].domain):p?new c.ExpressionResult(!0,"Page has close signature match with "+a.signatures[u].domain):new c.ExpressionResult(!1,"Page doesn't have a match with available signatures")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.NonMisleadingCopyright=function(a,c){var b=c.constants.domConstants,e=c.ExpressionMethod,k=a.utils.isNil,l=a.utils.isArray,h=a.utils.isString;a=function(){e.call(this,"Non Misleading Copyright")};a.prototype=Object.create(e.prototype);a.prototype.evaluate=function(a){var d=c.domManager.getDomObject();a=d.getData(b.OBJECT_TYPE.PAGE_DATA);d=d.getData(b.OBJECT_TYPE.TEXT_DATA);if(k(a)||k(d))throw Error("page data or text data is null in "+this._name);a=a.getBrandNameFromUrl();if(!h(a)||
""===a)return new c.ExpressionResult(!1,"brandName is invalid");d=d.getCopyrightStrings();if(!l(d)||0===d.length)return new c.ExpressionResult(!1,"copyright strings is/are invalid");for(var e="",f=a.length,m=0;m<f;m++)e+=a[m]+".?.?";for(a=0;a<d.length;a++)if((new RegExp(e)).test(d[a]))return new c.ExpressionResult(!0,"The page has a non misleading copyright");return new c.ExpressionResult(!1,"The page has a misleading copyright")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageIsAForm=function(a,c){var b=c.ExpressionMethod,e=a.utils.isNil,k=c.constants.domConstants;a=function(){b.call(this,"Page Is a Form")};a.prototype=Object.create(b.prototype);a.prototype.evaluate=function(a){var b=c.domManager.getDomObject();a=b.getData(k.OBJECT_TYPE.FORMS_DATA);if(e(a))throw Error("forms data was found to be null");b=b.getData(k.OBJECT_TYPE.PAGE_DATA);if(e(b))throw Error("page data was found to be null");var d=!1,f=0,g;for(g in a){var n=a[g];f+=n.getNumOfTextInputs()+
n.getNumOfPasswordInputs();if(1<=n.getNumOfTextInputs()+n.getNumOfPasswordInputs()){d=!0;break}}d||b.getNumOfPasswordInputs()+b.getNumOfTextInputs()>f&&(d=!0);return d?new c.ExpressionResult(!0,"Page has a form"):new c.ExpressionResult(!1,"Page does not have form")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageHasFormEmailer=function(a,c){var b=c.ExpressionMethod,e=a.utils.isNil;a=function(){b.call(this,"PageHasFormEmailer")};a.prototype=Object.create(b.prototype);a.prototype.evaluate=function(){var a=c.domManager.getDomObject().getData(c.constants.domConstants.OBJECT_TYPE.FORMS_DATA);if(e(a))throw Error("formsData object is nil");var b=!1,f;for(f in a){var d=a[f];if(d.hasHiddenInputEmailValue()&&d.isFormVisible()){b=!0;break}}return b?new c.ExpressionResult(!0,"Page has form emailer"):
new c.ExpressionResult(!1,"Page does not have form emailer")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.ContainStrings=function(a,c){var b=c.constants.indicatorConstants,e=c.ExpressionMethod,k=a.utils.isArray,l=a.utils.isntNil,h=a.utils.isInteger;a=function(a,c){e.call(this,a);this.comparisonType=c};a.prototype=Object.create(e.prototype);a.prototype.getComparisonType=function(){return this.comparisonType};a.prototype._findMatch=function(a,e){switch(this.getComparisonType()){case b.COMPARISON_TYPE.CONTAIN_WORDS:case b.COMPARISON_TYPE.CONTAIN_SUBSTRINGS:if(e.getType()===b.INPUT_TYPE.STRING)for(var d=
0;d<a.length;d++){if(-1!==a[d].indexOf(e.getValue()))return!0}else if(e.getType()===b.INPUT_TYPE.OBJECT)for(d=new c.Trie(e.getValue()),e=0;e<a.length;e++){var f=d.findSubPhrase(a[e]);if(l(f))return!0}else throw Error(this._name+" method passed with invalid inputs");break;case b.COMPARISON_TYPE.CONTAIN_MULTIPLE_SUBSTRINGS:d=0;if(e.getType()===b.INPUT_TYPE.OBJECT){f=e.getValue().ceilingNum;if(!1===h(f))throw Error(this._name+" method passed with invalid ceilingNumber");for(var k=new c.Trie(e.getValue().valuesTrie),
p=0;p<a.length;p++)if(e=k.findSubPhrases(a[p]),d+=e.length,d>=f)return!0}else throw Error(this._name+" method passed with invalid inputs");break;default:throw Error(this._name+" invalid comparatorType");}return!1};a.prototype.evaluate=function(a){if(!k(a)||2>a.length)throw Error(this._name+" method passed with invalid arguments");var d=a[0];a=a[1];if(d.getType()===b.INPUT_TYPE.STRING)d=[d.getValue()];else if(d.getType()===b.INPUT_TYPE.ARRAY)d=d.getValue();else throw Error(this._name+" method passed with invalid inputs");
return!0===this._findMatch(d,a)?new c.ExpressionResult(!0,this.getComparisonType()+" match found"):new c.ExpressionResult(!1,this.getComparisonType()+" match not found")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.OnlyPersonalForm=function(a,c){var b=c.ExpressionMethod,e=a.utils.isNil,k=a.utils.isntNil,l=c.constants.domConstants;a=function(){b.call(this,"Only Personal Form")};a.prototype=Object.create(b.prototype);a.prototype.evaluate=function(a){var b=c.domManager.getDomObject(),f=!1,g=b.getData(l.OBJECT_TYPE.PAGE_DATA);if(e(g))throw Error("page data is null");var h=b.getData(l.OBJECT_TYPE.TEXT_DATA);if(e(h))throw Error("text data is null");b=a[0].getValue();if(0<g.getNumOfPasswordInputs())return new c.ExpressionResult(!1,
"Page is asking for login information");h=h.getLabelTexts();if(1>h.size)return new c.ExpressionResult(!1,"Page doesn't have labels");g=new c.Trie(b[0]);a=new c.Trie(b[1]);b=new c.Trie(b[2]);h=$jscomp.makeIterator(h.values());for(var m=h.next();!m.done;m=h.next()){m=m.value;m=m.replace(/[^0-9a-z]/gi,"");if(k(g.findSubPhrase(m)))return new c.ExpressionResult(!1,"Page is asking for financial information");if(k(a.findSubPhrase(m)))return new c.ExpressionResult(!1,"Page is asking for login information");
k(b.findSubPhrase(m))&&(f=!0)}return f?new c.ExpressionResult(!0,"Page is asking for personal information"):new c.ExpressionResult(!1,"Page is not asking for personal information")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageHasHighWordsInputsRatio=function(a,c){var b=c.ExpressionMethod,e=a.utils.isNil,k=a.utils.isArray,l=c.constants.domConstants,h=c.domManager.getDomObject();a=function(){b.call(this,"PageHasHighWordsInputsRatio")};a.prototype=Object.create(b.prototype);a.prototype.evaluate=function(a){if(!k(a)||1>a.length)throw Error(this._name+" method passed with invalid arguments");a=a[0].getValue();var b=h.getData(c.constants.domConstants.OBJECT_TYPE.FORMS_DATA);if(e(b))throw Error("formsData object is nil");
var d=h.getData(l.OBJECT_TYPE.TEXT_DATA);if(e(d))throw Error("textData object is nil");d=d.getWordsCount();var f=0,m=0,q=0,u=0;for(t in b){var r=b[t];f+=r.getNumOfSelects();m+=r.getNumOfTextInputs();q+=r.getNumOfTextAreas();u+=r.getNumOfPasswordInputs()}var t=f+m+q+u;0===t&&(t=1);return d/t>a?new c.ExpressionResult(!0,"Page has high words to input ratio"):new c.ExpressionResult(!1,"Page does not have high words to input ratio")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageHasManyTDImages=function(a,c){var b=c.ExpressionMethod,e=a.utils.isNil,k=a.utils.isArray,l=c.constants.domConstants;a=function(){b.call(this,"PageHasManyTDImages")};a.prototype=Object.create(b.prototype);a.prototype.evaluate=function(a){var b=c.domManager.getDomObject();if(!k(a)||1>a.length)throw Error(this._name+" method passed with invalid arguments");a=a[0].getValue();var f=b.getData(l.OBJECT_TYPE.IMAGE_DATA);if(e(f))throw Error("imageData object is nil");b=f.getNumOfImages();
f=f.getNumOfTdHostedImages();0===b&&(b=1);return f/b>a?new c.ExpressionResult(!0,"Page has high percentage of TD hosted image"):new c.ExpressionResult(!1,"Page does not have high percentage of TD hosted image")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageHasProminentForm=function(a,c){var b=c.ExpressionMethod,e=c.constants.domConstants,k=a.utils.isNil;a=function(){b.call(this,"Page Has Prominent Form")};a.prototype=Object.create(b.prototype);a.prototype.evaluate=function(){var a=c.domManager.getDomObject(),b=a.getNumOfVisibleForms();if(0===b)return new c.ExpressionResult(!1,"Page does not have prominent form");var d=a.getData(e.OBJECT_TYPE.PAGE_DATA);if(k(d))throw Error("Page Data is null");var f=d.getNumOfBrTags()+d.getNumOfPTags()+
d.getNumOfTrTags();0===f&&(f=1);var g=a.getData(e.OBJECT_TYPE.TEXT_DATA);if(k(g))throw Error("Text Data is null");d=g.getLinesCount();a=a.getNumOfTextAreasInForms()+a.getNumOfTextInputsInForms()+a.getNumOfPasswordInputsInForms();g=g.getWordsCount()/12;f+=g;f<d&&(f=d);return.0199<a/b/f?new c.ExpressionResult(!0,"Page has prominent form"):new c.ExpressionResult(!1,"Page does not have prominent form")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageHasProminentImages=function(a,c){var b=c.ExpressionMethod,e=c.constants.domConstants,k=a.utils.isNil;a=function(){b.call(this,"Page Has Prominent Images")};a.prototype=Object.create(b.prototype);a.prototype.evaluate=function(a){var b=c.domManager.getDomObject();a=b.getData(e.OBJECT_TYPE.IMAGE_DATA);if(k(a))throw Error("Image Data is null");a=a.getTotalImageArea();if(0>=a)return new c.ExpressionResult(!1,"Page does not have prominent images");b=b.getData(e.OBJECT_TYPE.PAGE_DATA);
if(k(b))throw Error("Page Data is null");b=b.getNumOfBrTags()+b.getNumOfPTags()+b.getNumOfTrTags();0===b&&(b=1);return.4<a/(24E3*b)?new c.ExpressionResult(!0,"Page has prominent images"):new c.ExpressionResult(!1,"Page does not have prominent images")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageHasSecureForm=function(a,c){var b=c.ExpressionMethod,e=a.utils.isNil,k=c.constants.domConstants;a=function(){b.call(this,"Page Has Secure Form")};a.prototype=Object.create(b.prototype);a.prototype.evaluate=function(a){a=c.domManager.getDomObject().getData(k.OBJECT_TYPE.FORMS_DATA);if(e(a))throw Error("Forms Data Not Found");for(var b=!1,d=0;d<a.length;d++){var f=a[d];if(1<=f.getNumOfTextInputs()&&f.getFormActionScheme()===k.LINK_DATA.HTTPS){b=!0;break}}return b?new c.ExpressionResult(!0,
"Page Has Secure Form"):new c.ExpressionResult(!1,"No Secure Form Found")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageHasSingleEntryForm=function(a,c){var b=c.ExpressionMethod,e=c.constants.domConstants,k=a.utils.isNil,l=a.utils.isArray;a=function(){b.call(this,"Page Has Single Entry Form")};a.prototype=Object.create(b.prototype);a.prototype.evaluate=function(a){var b=c.domManager.getDomObject();if(k(a)||!l(a)||2>a.length)throw Error(this._name+" method passed with invalid arguments");var f=a[0].getValue();a=a[1].getValue();b=b.getData(e.OBJECT_TYPE.FORMS_DATA);if(k(b))throw Error("Form Data is null");
for(var g=!1,h=0;h<f.length;h++){var m=c.ExpressionMethod.getActualIndicatorIndex(a,f[h]);if(-1===m)throw Error("topological sort is not working properly");if(!0===a[m].getResult()){g=!0;break}}if(!1===g)return new c.ExpressionResult(!1,"Page has no single entry form");f=!1;for(a=0;a<b.length;a++)if(g=b[a],!0===g.hasAtleastTwoTextInputs()){f=!1;break}else 1===g.getNumOfTextInputs()+g.getNumOfPasswordInputs()&&(f=!0);return!0===f?new c.ExpressionResult(!0,"Page has single entry form"):new c.ExpressionResult(!1,
"Page has no single entry form")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageIsCopy=function(a,c){var b=c.ExpressionMethod,e=c.constants.domConstants,k=a.utils.isNil;a=function(){b.call(this,"Page Is Copy")};a.prototype=Object.create(b.prototype);a.prototype.evaluate=function(a){var b=c.domManager.getDomObject();a=b.getData(e.OBJECT_TYPE.PAGE_DATA);if(k(a))throw Error("pageData is nil");var d=b.getData(e.OBJECT_TYPE.IMAGE_DATA);if(k(d))throw Error("imageData is nil");b=b.getData(e.OBJECT_TYPE.SCRIPT_DATA);if(k(b))throw Error("scriptData is nil");d=
d.getSourceUrls();for(var f=0;f<d.length;f++){var g=d[f];if(-1!==g.indexOf("_files\\")||-1!==g.indexOf("_files/"))return new c.ExpressionResult(!0,"Page was copied - has image save as folder")}b=b.getScriptSources();for(d=0;d<b.length;d++)if(f=b[d],-1!==f.indexOf("_files\\")||-1!==f.indexOf("_files/"))return new c.ExpressionResult(!0,"Page was copied - has image save as folder");a=a.getComments();for(b=0;b<a.length;b++){if(-1!==a[b].indexOf("saved from url="))return new c.ExpressionResult(!0,"Page was copied: internet explorer copy");
if(-1!==a[b].indexOf("this document saved from"))return new c.ExpressionResult(!0,"Page was copied: opera copy");if(-1!==a[b].indexOf("mirrored from")||-1!==a[b].indexOf("by httrack website copier"))return new c.ExpressionResult(!0,"Page was copied: winhttrack website copier")}return new c.ExpressionResult(!1,"Page was not copied")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.ImageBasedObfuscation=function(a,b){var c=b.ExpressionMethod,e=a.utils.isNil,k=b.constants.domConstants,l=a.utils.isArray;a=function(){c.call(this,"Image Based Obfuscation")};a.prototype=Object.create(c.prototype);a.prototype.evaluate=function(a){if(e(a)||!l(a)||2>a.length)throw Error("Invalid expressionInputs received in method "+this._name);var d=b.domManager.getDomObject(),f=d.getData(k.OBJECT_TYPE.TEXT_DATA);d=d.getData(k.OBJECT_TYPE.IMAGE_DATA);if(e(f)||e(d))throw Error("textData or imageData is null in method "+
this._name);var g=a[0].getValue(),h=a[1].getValue();a=d.getUniqueUrlsMap().size;if(5<a&&(0===f.getLabelTexts().size||8>f.getLabelTexts().size)&&!f.hasDbcsLabel())return new b.ExpressionResult(!0,"Page is using images to obfuscate text");var m=0,q,u=!1,r=!0;for(q=0;q<g.length;q++){var t=c.getActualIndicatorIndex(h,Math.abs(g[q]));if(0>t)throw Error("Invalid index received from ExpressionMethod.getActualIndicatorIndex");if(0>g[q]){if(h[t].getResult()){r=!1;break}}else h[t].getResult()&&(u=!0)}f=100>=
f.getLabelTexts().size?!0:!1;g=d.getHeights();d=d.getWidths();for(q=0;q<d.length&&q<g.length;q++)24<=d[q]&&432>=d[q]&&12<=g[q]&&36>=g[q]&&m++;return 8<=a&&u&&r&&f&&.5<=m/a?new b.ExpressionResult(!0,"Page is using images to obfuscate text"):new b.ExpressionResult(!1,"Page is not using images to obfuscate text")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageHasSuspiciousFlashMovie=function(a,b){var c=b.ExpressionMethod,e=a.utils.isNil,k=b.constants.domConstants,l=b.domManager.getDomObject();a=function(){c.call(this,"Page has Suspicious Flash movie")};a.prototype=Object.create(c.prototype);a.prototype.evaluate=function(a){a=l.getData(k.OBJECT_TYPE.PAGE_DATA);var c=l.getData(k.OBJECT_TYPE.TEXT_DATA);if(e(a)||e(c))throw Error("Page Data or Text Data is not valid");return a.hasFlash()&&0===l.getNumOfForms()&&100>=a.getNumOfElements()&&
0===c.getBodyInnerTextLength()?new b.ExpressionResult(!0,"Page has flash movie"):new b.ExpressionResult(!1,"No flash movie available")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageIsForeignCreditUnion=function(a,b){var c=b.constants.domConstants,e=b.ExpressionMethod,k=a.utils.isNil,l=a.utils.isntNil,h=a.utils.isArray;a=function(){e.call(this,"Page Is Foreign Credit Union")};a.prototype=Object.create(e.prototype);a.prototype.evaluate=function(a){if(k(a)||!h(a)||1>a.length)throw Error(this._name+" method passed with invalid arguments");a=a[0].getValue();if(3>a.length)throw Error("expInput list is having less number of tries");var d=new b.Trie(a[0]),e=
new b.Trie(a[1]);a=new b.Trie(a[2]);var f=b.domManager.getDomObject(),m=f.getData(c.OBJECT_TYPE.PAGE_DATA);if(k(m))throw Error("pageData is nil");var q=f.getData(c.OBJECT_TYPE.TEXT_DATA);if(k(q))throw Error("textData is nil");f=f.getData(c.OBJECT_TYPE.IMAGE_DATA);if(k(f))throw Error("imageData is nil");m=m.getUrlTld();if(k(m)||m===b.constants.EMPTY_STRING)return new b.ExpressionResult(!1,"Page Is Not A Foreign Credit Union");d=d.findPhrase(m);if(l(d))return new b.ExpressionResult(!1,"Page Is Not A Foreign Credit Union");
d=!1;q=q.getBodyTextContent();if(l(q)&&q!==b.constants.EMPTY_STRING&&l(e.findSubPhrase(q)))d=!0;else for(e=f.getSourceUrls(),q=0;q<e.length;q++)if(f=a.findSubPhrase(e[q]),l(f)){d=!0;break}return d?new b.ExpressionResult(!0,"Page Is Foreign Credit Union"):new b.ExpressionResult(!1,"Page Is Not A Foreign Credit Union")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageHasHtmlObfuscated=function(a,b){var c=b.ExpressionMethod,e=b.constants.domConstants,k=a.utils.isNil,l=a.utils.isntNil;a=function(){c.call(this,"Page has obfuscated html")};a.prototype=Object.create(c.prototype);a.prototype._hasObfuscatedHTML=function(a,c){if(-1!==a.indexOf("function process(ar)"))return new b.ExpressionResult(!0,"page has obfuscated html: function process");if(-1!==c.indexOf(" htmlcrypt "))return new b.ExpressionResult(!0,"page has obfuscated html: htmlcrypt encoded");
if(-1!==a.indexOf("ky+codeIt"))return new b.ExpressionResult(!0,"page has obfuscated html: psyral phobia encoded");a=a.split("\n");for(c=0;c<a.length;c++){var d=a[c];if(150<d.length){var e=d.indexOf("array");if(-1!==e){do{var f=0;for(var h=!1,k=e;k<d.length;k++){if("("===d[k])h=!0;else if(!0===h&&","===d[k])f+=1;else if(")"===d[k]||h&&!1===isNaN(Number(d[k])))break;if(20<f)return new b.ExpressionResult(!0,"page has obfuscated html: "+d)}f=e+1;e=d.indexOf("array",f)}while(-1!==e)}else for(e=f=0,h=
!1,k=0;k<d.length;k++){"%"===d[k]?(0===f&&(h=!0),f+=1,e=0):e+=1;if(20<f)return new b.ExpressionResult(!0,"page has obfuscated html: hex encoded");if(!1===h&&100<e||10<e)break}}}return null};a.prototype.evaluate=function(a){a=b.domManager.getDomObject();var c=a.getData(e.OBJECT_TYPE.PAGE_DATA);if(k(c))throw Error("pageData is nil");a=a.getData(e.OBJECT_TYPE.SCRIPT_DATA);if(k(a))throw Error("scriptData is nil");for(var f=a.getScriptTexts(),g=b.constants.EMPTY_STRING,h=0;h<f.length;h++)g+=f[h];if(g===
b.constants.EMPTY_STRING)return new b.ExpressionResult(!1,"page does not have any obfuscated html");c=c.getComments();f=b.constants.EMPTY_STRING;for(h=0;h<c.length;h++)f+=c[h];if(f===b.constants.EMPTY_STRING)return new b.ExpressionResult(!1,"page does not have any obfuscated html");g=this._hasObfuscatedHTML(g,f);if(l(g))return g;a=a.getScriptLanguages();for(g=0;g<a.length;g++)if("jscript.encode"===a[g]||"vbscript.encode"===a[g])return new b.ExpressionResult(!0,"page has obfuscated html: jscript.encode");
return new b.ExpressionResult(!1,"page does not have any obfuscated html")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.StartsWith=function(a,b){var c=b.constants.indicatorConstants,e=b.ExpressionMethod,k=a.utils.isArray;a=function(){e.call(this,"StartsWith")};a.prototype=Object.create(e.prototype);a.prototype.evaluate=function(a){if(!k(a)||2!==a.length)throw Error(this._name+" method passed with invalid arguments");var e=a[0];a=a[1];if(e.getType()===c.INPUT_TYPE.STRING&&a.getType()===c.INPUT_TYPE.STRING)e=e.getValue().startsWith(a.getValue());else throw Error(this._name+" method passed with invalid inputs");
return!0===e?new b.ExpressionResult(!0,"String Starts with the value"):new b.ExpressionResult(!1,"String is not starts with the value")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageIsWebMail=function(a,b){var c=b.ExpressionMethod,e=a.utils.isNil,k=b.constants.domConstants,l=a.extensionAdapter,h=b.constants.webEmailLanguageConstants,d=b.constants.webEmailHeaderConstants,p=b.domManager.getDomObject(),g=a.utils.isEmptyObject,n=b.constants.MESSAGES,m=/\n/g,q=/^(?=\n)$|^\s*|\s*$|\n\n+/gm;a=function(a){c.call(this,"Page is web mail")};a.prototype=Object.create(c.prototype);var u=function(a,b){return 4<=Object.values(b).filter(function(b){return-1<a.indexOf(b)}).length?
!0:!1},r=function(a,b,c){if(c+b.length<a.length&&(b=a.charAt(c+b.length),/[A-Z]/i.test(b)))return!1;b=a.lastIndexOf("\n",c)+1;for(--c;c>=b;c--)if(/[A-Z]/i.test(a[c]))return!1;return!0},t=function(a,b,c){b=Object.values(b);for(var d=[],f=a.replace(q,""),g=0;g<b.length;g++){var h=f.indexOf(b[g]);0<=h&&r(f,b[g],h)&&d.push(h)}if(2>d.length)return!1;d=d.sort(function(a,b){return a-b});a=a.substr(d[0],d[1]).match(m);return(e(a)?0:a.length)<c?!0:!1};a.prototype.evaluate=function(a){a=p.getData(k.OBJECT_TYPE.PAGE_DATA);
var c=p.getData(k.OBJECT_TYPE.TEXT_DATA),f=p.getData(k.OBJECT_TYPE.LINK_DATA);if(e(a)||e(c)||e(f))throw Error("Page data or textData or linkData cannot be null");var n=a.getUrlTld();if(""===n||e(n)||0===a.getButtonTexts().length&&0===f.getAnchorTexts().length&&(e(c.getBodyTextContent())||""===c.getBodyTextContent()))return new b.ExpressionResult(!1,"Page is not a web email");var l=b.defManager.getDefObject().getData(b.constants.DEF_DATA_TYPES.URL_LOOKUP_DATA);if(g(l)||g(l.pageUrlLookupData))throw Error("URL Lookup Data not loaded");
if(!0===l.pageUrlLookupData.isInWebMailCache)return new b.ExpressionResult(!0,"Page is a web email");l=a.getButtonTexts();l.push.apply(l,$jscomp.arrayFromIterable(f.getAnchorTexts()));c=c.getBodyTextContent();e(c)&&(c="");f=h.ENGLISH;var m=d.ENGLISH_EMAILHEADER,q=h.englishEmailHeaderSize;switch(n){case "de":f=h.GERMAN;m=d.GERMAN_EMAILHEADER;q=h.germanEmailHeadersSize;break;case "it":f=h.ITALIAN;m=d.ITALIAN_EMAILHEADER;q=h.italianEmailHeadersSize;break;case "fr":f=h.FRENCH;m=d.FRENCH_EMAILHEADER;q=
h.frenchEmailHeadersSize;break;case "ar":case "sv":case "cr":case "ni":case "pr":case "bo":case "cu":case "gt":case "pa":case "es":case "cl":case "do":case "hn":case "py":case "uy":case "co":case "ec":case "mx":case "pe":case "ve":f=h.SPANISH,m=d.SPANISH_EMAILHEADER,q=h.spanishEmailHeadersSize}n=u(l,f)?!0:t(c,m,q)?!0:void 0;return n?(this._addToWebMailCache(a.getUrlHostnameExcludingSubDomain()),new b.ExpressionResult(!0,"Page is a web email")):new b.ExpressionResult(!1,"Page is not a web email")};
a.prototype._addToWebMailCache=function(a){l.sendMessage({id:n.PAGE_IS_WEB_MAIL,payload:{urlKey:a}})};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.HostnameIsWebMail=function(a,b){var c=b.constants.indicatorConstants,e=b.ExpressionMethod,k=a.utils.isNil,l=a.utils.isArray,h=b.constants.domConstants,d=b.constants.MESSAGES,p=a.extensionAdapter;a=function(){e.call(this,"HostnameIsWebMail")};a.prototype=Object.create(e.prototype);a.prototype.evaluate=function(a){if(!l(a)||2>a.length)throw Error(this._name+" method passed with invalid arguments");var d=b.domManager.getDomObject();a=a[1];if(a.getType()===c.INPUT_TYPE.STRING){d=d.getData(h.OBJECT_TYPE.PAGE_DATA);
if(k(d))throw Error("page data was found to be null");d=d.getUrlHostnameExcludingSubDomain();if(k(d))throw Error("URL is found null");return-1!==a.getValue().indexOf(d)?(this._addToWebMailCache(d),new b.ExpressionResult(!0,"HostName is a web email.")):new b.ExpressionResult(!1,"HostName is not a web email")}throw Error("Parameters are unsupported types");};a.prototype._addToWebMailCache=function(a){p.sendMessage({id:d.PAGE_IS_WEB_MAIL,payload:{urlKey:a}})};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageHasBadHistory=function(a,b){var c=b.ExpressionMethod,e=a.utils.isEmptyObject,k=a.utils.isNil,l=b.domManager.getDomObject(),h=b.constants.domConstants;a=function(){c.call(this,"PageHasBadHistory")};a.prototype=Object.create(c.prototype);a.prototype.evaluate=function(a){a=b.defManager.getDefObject().getData(b.constants.DEF_DATA_TYPES.URL_LOOKUP_DATA);if(e(a))throw Error("URL Lookup Data not loaded");if(e(a.referrerUrlLookupData))return new b.ExpressionResult(!1,"This Page doesn't have Bad History");
var c=l.getData(h.OBJECT_TYPE.PAGE_DATA).getReferrerUrlHostnameExcludingSubDomain();if(k(c))throw Error("URL is found null");return!0===a.referrerUrlLookupData.isInWebMailCache?new b.ExpressionResult(!0,"This Page has a Bad History"):new b.ExpressionResult(!1,"This Page doesn't have Bad History")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.TestBoolean=function(a,b){var c=b.ExpressionMethod,e=a.utils.isArray;a=function(){c.call(this,"Test Booleans")};a.prototype=Object.create(c.prototype);a.prototype.evaluate=function(a){if(!e(a)||2!==a.length)throw Error(this._name+" method passed with invalid arguments");var c=a[0];a=a[1];if(c.getType()!==a.getType())throw Error(this._name+" method passed inputs are not boolean");return c.getValue()===a.getValue()?new b.ExpressionResult(!0,"Check Passed"):new b.ExpressionResult(!1,
"Check Failed")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.FormActionExhibitsSpooficity=function(a,b){var c=b.domManager.getDomObject(),e=b.constants.domConstants,k=b.ExpressionMethod,l=a.utils.isNil;a=function(){k.call(this,"FormActionExhibitsSpooficity")};a.prototype=Object.create(k.prototype);a.prototype.evaluate=function(){var a=c.getData(e.OBJECT_TYPE.FORMS_DATA);if(l(a))throw Error("formsData object is nil");for(var d in a){var f=a[d];if(f.hasAtleastTwoTextInputs()&&f.getFormActionExtension()===e.LINK_DATA.PHP&&(f=f.getFormActionAttribute(),
!l(f)&&!1===f.startsWith(e.LINK_DATA.HTTP)&&!1===f.startsWith(e.LINK_DATA.FILE)))return new b.ExpressionResult(!0,"form action exhibits spooficity")}return new b.ExpressionResult(!1,"form action is not exhibits spooficity")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.LinksExhibitLegitimacy=function(a,b){var c=b.ExpressionMethod,e=a.utils.isNil,k=a.utils.isArray,l=b.constants.domConstants;a=function(){c.call(this,"LinksExhibitLegitimacy")};a.prototype=Object.create(c.prototype);a.prototype.evaluate=function(a){if(!k(a)||1>a.length)throw Error(this._name+" method passed with invalid arguments");var c=b.domManager.getDomObject(),f=c.getData(l.OBJECT_TYPE.LINK_DATA);if(e(f))throw Error("linkData object is nil");var g=c.getData(l.OBJECT_TYPE.PAGE_DATA);
if(e(g))throw Error("pageData object is nil");a=a[0].getValue();var h=f.getValidUrls().length,m=f.getUniqueUrlsMap(),q=m.size;c=new b.ExpressionResult(!1,"Page dont have many links to its web site");if(0<h&&0<q){if(q/h<l.LINK_DATA.LINK_THRESHOLD)return c;h=m.values();for(m=h.next();!1===m.done;){if(10<=m.value)return c;m=h.next()}}h=f.getNumOfLinks();g=g.getUrlHostname();f=f.getHostnameCount(g);return 0<h&&0<f&&f/h>a?new b.ExpressionResult(!0,"Page has many links to its web site"):c};return a}(b.SymBfw,
b.WCID)})(executionContext);
(function(b){b.WCID.URLExhibitsLegitimacy=function(a,b){var c=b.defManager,e=b.constants,k=e.DEF_DATA_TYPES,l=b.ExpressionMethod;a=function(){l.call(this,"URLExhibitsLegitimacy")};a.prototype=Object.create(l.prototype);a.prototype.evaluate=function(){return c.getDefObject().getData(k.URL_LOOKUP_DATA).pageUrlLookupData.urlClassification===e.URL_ANALYSIS.CLASSIFICATION.LEGITIMACY?new b.ExpressionResult(!0,"URL classification is LEGITIMACY"):new b.ExpressionResult(!1,"URL classification is not LEGITIMACY")};return a}(b.SymBfw,
b.WCID)})(executionContext);
(function(b){b.WCID.URLExhibitsSpooficity=function(a,b){var c=b.defManager,e=b.constants,k=e.DEF_DATA_TYPES,l=b.ExpressionMethod;a=function(){l.call(this,"URLExhibitsSpooficity")};a.prototype=Object.create(l.prototype);a.prototype.evaluate=function(){return c.getDefObject().getData(k.URL_LOOKUP_DATA).pageUrlLookupData.urlClassification===e.URL_ANALYSIS.CLASSIFICATION.SPOOFICITY?new b.ExpressionResult(!0,"URL classification is SPOOFICITY"):new b.ExpressionResult(!1,"URL classification is not SPOOFICITY")};return a}(b.SymBfw,
b.WCID)})(executionContext);
(function(b){b.WCID.InSiteList=function(a,b){var c=b.constants.indicatorConstants,e=b.ExpressionMethod,k=a.utils.isNil,l=a.utils.isArray,h=a.utils.isEmptyObject;a=function(){e.call(this,"URL In Site List")};a.prototype=Object.create(e.prototype);a.prototype.evaluate=function(a){if(k(a)||!l(a)||2>a.length)throw Error(this._name+" method passed with invalid arguments");var d=a[1].getValue();if(a[1].getType()!==c.INPUT_TYPE.NUMBER)throw Error("Unsupported Value Type");if(d!==c.PARAMETER_ID.PARTNER_DOMAINS)throw Error("Unsupported Parameter Id");
a=b.defManager.getDefObject().getData(b.constants.DEF_DATA_TYPES.URL_LOOKUP_DATA);if(h(a)||h(a.pageUrlLookupData))throw Error("URL Lookup Data not loaded");return!0===a.pageUrlLookupData.isInSafeList?new b.ExpressionResult(!0,"In Site List"):new b.ExpressionResult(!1,"Not In Site List")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.HasTrustedBrandTag=function(a,b){var c=b.constants,e=c.indicatorConstants.PARAMETER_ID,k=b.ExpressionMethod,l=a.utils.isArray;a=function(){k.call(this,"HasTrustedBrandTag")};a.prototype=Object.create(k.prototype);a.prototype.evaluate=function(a){if(!l(a)||2>a.length)throw Error(this._name+" method passed with invalid arguments");var d=a[0];switch(a[1].getValue()){case e.URL_TAGS:a=this.findURLFragment;break;case e.TEXT_TAGS:a=this.findText;break;case e.COPYRIGHT_TAGS:a=this.findCopyright;
break;default:throw Error(this._name+" method unsupported parameterID passed");}var f=!1;if(d.getType()===c.indicatorConstants.INPUT_TYPE.ARRAY){d=d.getValue();for(var g=0;g<d.length&&(f=a(d[g]),!0!==f);g++);}else if(d.getType()===c.indicatorConstants.INPUT_TYPE.STRING)d=d.getValue(),0<d.length&&(f=a(d));else throw Error(this._name+" method unsupported page input passed");return f?new b.ExpressionResult(!0,"Page include trusted name"):new b.ExpressionResult(!1,"Page does not have trusted name")};
a.prototype.findURLFragment=function(a){return b.defManager.getDefObject().findInTrustedHostnames(a)};a.prototype.findCopyright=function(a){return b.defManager.getDefObject().findInTrustedCopyrights(a)};a.prototype.findText=function(a){return b.defManager.getDefObject().findInTrustedTexts(a)};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.EndsWith=function(a,b){var c=b.constants.indicatorConstants,e=b.ExpressionMethod,k=a.utils.isArray,l=a.utils.isntNil;a=function(){e.call(this,"EndsWith")};a.prototype=Object.create(e.prototype);a.prototype.evaluate=function(a){if(!k(a)||2>a.length)throw Error(this._name+" method passed with invalid arguments");var d=a[0];a=a[1];if(d.getType()===c.INPUT_TYPE.STRING&&a.getType()===c.INPUT_TYPE.OBJECT)d=(new b.Trie(a.getValue())).findEndsWithPhrase(d.getValue()),d=l(d);else throw Error(this._name+
" method passed with invalid inputs");return d?new b.ExpressionResult(!0,"String Ends with the value"):new b.ExpressionResult(!1,"String doesn't ends with the expected value")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.PageHasCreatePopupURL=function(a,b){var c=b.ExpressionMethod,e=b.domManager.getDomObject();a=function(){c.call(this,"Page has CreatePopup URL")};a.prototype=Object.create(c.prototype);a.prototype._checkForPatternInScript=function(a){if(-1!==a.indexOf("tahoma")&&-1!==a.indexOf("http")||-1!==a.indexOf("vuln_html"))return!0};a.prototype._checkForTimeoutsInScript=function(a){if(-1!==a.indexOf("setinterval")||-1!==a.indexOf("settimeout"))return this._checkForPatternInScript(a)};a.prototype.evaluate=
function(a){a=!1;var c=e.getData(b.constants.domConstants.OBJECT_TYPE.SCRIPT_DATA).getScriptSources();if(0===c.length)return new b.ExpressionResult(!1,"Page doesn't have CreatePopup URL");for(var f=0;f<c.length;f++)-1!==c[f].indexOf("createpopup")&&(a=this._checkForTimeoutsInScript(c[f]));return a?new b.ExpressionResult(!0,"Page has CreatePopup URL"):new b.ExpressionResult(!1,"Page doesn't have CreatePopup URL")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.InDomainList=function(a,b){var c=b.constants.indicatorConstants,e=b.ExpressionMethod,k=a.utils.isNil,l=a.utils.isArray,h=a.utils.isntNil,d=a.logger,p=c.PARAMETER_ID;a=function(){e.call(this,"In Domain List")};a.prototype=Object.create(e.prototype);a.prototype.evaluate=function(a){if(k(a)||!l(a)||2>a.length)throw Error(this._name+" method passed with invalid arguments");var e=a[0],f=a[1],g=a[2].getValue(),u=!1;a=null;var r=!1;if(f.getType()===c.INPUT_TYPE.NUMBER)switch(g=this._getLookupDataForFieldId(g),
f.getValue()){case p.TRUSTED_DOMAINS:a=this._findInTrustedDomain;break;case p.TRUSTED_BRANDS:a=this._findInTrustedBrands;break;case p.EXCEPTION_DOMAINS:if(k(g)){r=!1;break}r=g.isExceptionDomain||g.hasAtleastOneExceptionDomain;break;case p.FREE_WEB_HOST_SITES:if(k(g))throw Error(this._name+" Unexpected Input, Lookup Data not available for Web Host Sites");r=g.isWebHostingSite;break;case p.SEARCH_DOMAINS:if(k(g))throw Error(this._name+" Unexpected Input, Lookup Data not available for Search Domains");
r=g.isSearchDomain;break;case p.POPULAR_DOMAINS:if(k(g))throw Error(this._name+" Unexpected Input, Lookup Data not available for Popular Domains");r=g.isPopularDomain;break;case p.IDENTIFIERS:return d.info(this._name+": Block List Not Supported, returning false"),new b.ExpressionResult(!1,"Block List Not Supported");default:throw Error(this._name+" method unsupported parameterID passed");}else if(f.getType()===c.INPUT_TYPE.OBJECT)this._expInputValue=f.getValue(),a=this._findInTrie;else throw Error(this._name+
" method: unsupported exp input passed");if(h(a))switch(e.getType()){case c.INPUT_TYPE.STRING:u=e.getValue();u=a.apply(this,[u]);break;case c.INPUT_TYPE.ARRAY:e=e.getValue();for(f=0;f<e.length&&(u=a.apply(this,[e[f]]),!0!==u);f++);break;default:throw Error(this._name+" method unsupported dom input passed");}else u=h(r)?r:!1;return!0===u?new b.ExpressionResult(!0,"Match found"):new b.ExpressionResult(!1,"No Match found")};a.prototype._findInTrustedDomain=function(a){return b.defManager.getDefObject().findInTrustedDomains(a)};
a.prototype._findInTrustedBrands=function(a){return b.defManager.getDefObject().findInTrustedHostnames(a)};a.prototype._findInTrie=function(a){if(k(this._expInputValue))throw Error(this._name+" method : Invalid Trie Input");var c=new b.Trie(this._expInputValue);return h(c.findSubPhrase(a))};a.prototype._getLookupDataForFieldId=function(a){var d=b.defManager.getDefObject().getData(b.constants.DEF_DATA_TYPES.URL_LOOKUP_DATA);switch(a){case c.FIELD_TYPE.FORM_ACTION_HOSTNAME:return d.formActionUrlLookupData;
case c.FIELD_TYPE.URL_HOSTNAME:return d.pageUrlLookupData;case c.FIELD_TYPE.SHORTCUT_ICON_HOSTNAME:return null;default:throw Error("Unsupported Field Id");}};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.expressionInputBuilder=function(a,b){var c=b.constants.indicatorConstants,e=b.constants.domConstants,k=a.utils.isNil,l=a.utils.isntNil,h=a.utils.isInteger;return{getExpressionInputs:function(a,f,g,n,m){var d=b.domManager.getDomObject();if(!h(f))throw Error("Method Id is invalid");g=[];if(!h(a)){g=[];if(f===c.EXPRESSION_METHOD.INDICATOR_ON||f===c.EXPRESSION_METHOD.INDICATOR_OFF){a=b.ExpressionMethod.getActualIndicatorIndex(m,n);if(-1===a)throw Error("value does not match with any Indicator Name");
if(!h(n)||0>n||n<a)throw Error("Value is not valid");g.push(new b.ExpressionInput(m[a].getResult()));g.push(new b.ExpressionInput(f===c.EXPRESSION_METHOD.INDICATOR_ON))}else g=null;k(g)&&l(n)&&(g=[],g.push(new b.ExpressionInput(n)),g.push(new b.ExpressionInput(m)));return g}m=d.getData(e.OBJECT_TYPE.PAGE_DATA);if(k(m))throw Error("Unable to get PageData from DOM");var p=d.getData(e.OBJECT_TYPE.TEXT_DATA);if(k(p))throw Error("textData object is nil");var r=d.getData(e.OBJECT_TYPE.LINK_DATA);if(k(r))throw Error("linkData Object is nil");
var t=d.getData(e.OBJECT_TYPE.IMAGE_DATA);f=d.getData(e.OBJECT_TYPE.FORMS_DATA);switch(a){case c.FIELD_TYPE.URL_PASSWORD:a=m.getUrlPassword();k(a)&&(a="");g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.URL_FILE_EXTENSION:a=m.getUrlFileExtension();k(a)&&(a="");g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.URL_USERNAME:a=m.getUrlUserName();k(a)&&(a="");g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));
break;case c.FIELD_TYPE.IMAGE_PATHS:a=t.getUniqueUrlPaths();g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.COPYRIGHT_STRINGS:a=p.getCopyrightStrings();g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.BODY_BG_EXTENSION:a=m.getBodyBackgroundImageExtension();k(a)&&(a="");g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.PAGE_TITLE:a=p.getPageTitle();if(k(a))throw Error("Dom title in not available");
g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.IS_URL_INTRANET:n=m.isUrlAnIntranet();g.push(new b.ExpressionInput(n));g.push(new b.ExpressionInput(!0));break;case c.FIELD_TYPE.IS_URL_IP:n=m.isUrlAnIp();g.push(new b.ExpressionInput(n));g.push(new b.ExpressionInput(!0));break;case c.FIELD_TYPE.IS_SYMANTEC_CLIENT:n=b.wcidHelperUtils.isSymantecClient();g.push(new b.ExpressionInput(n));g.push(new b.ExpressionInput(!0));break;case c.FIELD_TYPE.URL_PATH:a=m.getUrlPath();
if(k(a))throw Error("Dom urlPath is empty");g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.NUM_TD_HOSTED_IMAGES:a=t.getNumOfTdHostedImages();g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.NUM_PARAGRAPHS:a=m.getNumOfVisiblePTags();g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.NUM_FORMS:a=d.getNumOfForms();g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));
break;case c.FIELD_TYPE.NUM_TD_LINKS:a=r.getNumOfTdLinks();g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.NUM_ELEMENTS:a=m.getNumOfElements();g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.ALL_FORM_ACTIONS:a=[];for(d=0;d<f.length;d++)a.push(f[d].getFormAction());g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.URL_HOSTNAME:f=m.getUrlHostname();if(k(f))throw Error("urlhostname is not available");
g.push(new b.ExpressionInput(f));g.push(new b.ExpressionInput(n));g.push(new b.ExpressionInput(a));break;case c.FIELD_TYPE.URL_SCHEME:a=m.getUrlScheme();if(k(a))throw Error("urlScheme object is empty");g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.NUM_LINKS:a=r.getNumOfLinks();g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.BODY_INNER_TEXT:a=p.getBodyTextContent();k(a)&&(a="");g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));
break;case c.FIELD_TYPE.LABEL_TEXT:a=p.getLabelTexts();a=Array.from(a.values());g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.FORM_NUM_PASSWORD_INPUTS:a=[];for(d=0;d<f.length;d++)f[d].hasAtleastTwoTextInputs()&&a.push(f[d].getNumOfPasswordInputs());0===a.length?(a=m.getNumOfPasswordInputs(),g.push(new b.ExpressionInput(a))):g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.LINK_INNER_TEXT:a=r.getLinkInnerTexts();g.push(new b.ExpressionInput(a));
g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.URL:a=m.getUrl();k(a)&&(a="");g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));break;case c.FIELD_TYPE.FORM_ACTION_HOSTNAME:d=[];for(m=0;m<f.length;m++)f[m].hasAtleastTwoTextInputs()&&(p=f[m].getFormActionHostname(),l(p)&&d.push(p));g.push(new b.ExpressionInput(d));g.push(new b.ExpressionInput(n));g.push(new b.ExpressionInput(a));break;case c.FIELD_TYPE.LINKS:a=r.getHrefs();g.push(new b.ExpressionInput(a));g.push(new b.ExpressionInput(n));
break;case c.FIELD_TYPE.SHORTCUT_ICON_HOSTNAME:f=m.getShortcutIconHostName();k(f)&&(f="");g.push(new b.ExpressionInput(f));g.push(new b.ExpressionInput(n));g.push(new b.ExpressionInput(a));break;default:return null}return g}}}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.expressionMethodFactory=function(a,b){var c=b.constants.indicatorConstants,e=a.utils.isInteger;return{getExpressionMethod:function(a){if(!e(a))throw Error("Invalid method Id");switch(a){case c.EXPRESSION_METHOD.COMPARE_STRINGS:return new b.CompareStrings;case c.EXPRESSION_METHOD.TEST_BOOLEAN:case c.EXPRESSION_METHOD.INDICATOR_ON:case c.EXPRESSION_METHOD.INDICATOR_OFF:return new b.TestBoolean;case c.EXPRESSION_METHOD.STARTS_WITH:return new b.StartsWith;case c.EXPRESSION_METHOD.PAGE_HAS_FORM_EMAILER:return new b.PageHasFormEmailer;
case c.EXPRESSION_METHOD.PAGE_HAS_PROMINENT_FORM:return new b.PageHasProminentForm;case c.EXPRESSION_METHOD.GREATER_THAN:return new b.NumberComparer(c.COMPARISON_TYPE.GREATER_THAN,c.COMPARISON_TYPE.GREATER_THAN);case c.EXPRESSION_METHOD.PAGE_HAS_PROMINENT_IMAGES:return new b.PageHasProminentImages;case c.EXPRESSION_METHOD.HIGH_WORDS_INPUT_RATIO:return new b.PageHasHighWordsInputsRatio;case c.EXPRESSION_METHOD.MANY_TD_IMAGES:return new b.PageHasManyTDImages;case c.EXPRESSION_METHOD.PAGE_HAS_SECURE_FORM:return new b.PageHasSecureForm;
case c.EXPRESSION_METHOD.PAGE_HAS_SUSPICIOUS_FLASH_MOVIE:return new b.PageHasSuspiciousFlashMovie;case c.EXPRESSION_METHOD.PAGE_IS_A_FORM:return new b.PageIsAForm;case c.EXPRESSION_METHOD.HAS_KNOWN_SIGNATURE:return new b.HasKnownSignature;case c.EXPRESSION_METHOD.TITLE_MATCHES_BRAND:return new b.TitleMatchesBrand;case c.EXPRESSION_METHOD.LESS_THAN:return new b.NumberComparer(c.COMPARISON_TYPE.LESS_THAN,c.COMPARISON_TYPE.LESS_THAN);case c.EXPRESSION_METHOD.HAS_REDIRECT_FORM:return new b.HasRedirectForm;
case c.EXPRESSION_METHOD.CONTAIN_WORDS:return new b.ContainStrings(c.COMPARISON_TYPE.CONTAIN_WORDS,c.COMPARISON_TYPE.CONTAIN_WORDS);case c.EXPRESSION_METHOD.CONTAIN_SUBSTRINGS:return new b.ContainStrings(c.COMPARISON_TYPE.CONTAIN_SUBSTRINGS,c.COMPARISON_TYPE.CONTAIN_SUBSTRINGS);case c.EXPRESSION_METHOD.PAGE_IS_FOREIGN_CREDIT_UNION:return new b.PageIsForeignCreditUnion;case c.EXPRESSION_METHOD.PAGE_HAS_SINGLE_ENTRY_FORM:return new b.PageHasSingleEntryForm;case c.EXPRESSION_METHOD.LINKS_EXHIBIT_LEGITIMACY:return new b.LinksExhibitLegitimacy;
case c.EXPRESSION_METHOD.URL_EXHIBITS_SPOOFICITY:return new b.URLExhibitsSpooficity;case c.EXPRESSION_METHOD.URL_EXHIBITS_LEGITIMACY:return new b.URLExhibitsLegitimacy;case c.EXPRESSION_METHOD.FORM_ACTION_EXHIBITS_SPOOFICITY:return new b.FormActionExhibitsSpooficity;case c.EXPRESSION_METHOD.ONLY_PERSONAL_FORM:return new b.OnlyPersonalForm;case c.EXPRESSION_METHOD.PAGE_IS_COPY:return new b.PageIsCopy;case c.EXPRESSION_METHOD.IN_SITE_LIST:return new b.InSiteList;case c.EXPRESSION_METHOD.NONMISLEADING_COPYRIGHT:return new b.NonMisleadingCopyright;
case c.EXPRESSION_METHOD.HAS_TRUSTED_BRAND:return new b.HasTrustedBrandTag;case c.EXPRESSION_METHOD.STRING_ENDS_WITH:return new b.EndsWith;case c.EXPRESSION_METHOD.HTML_OBFUSCATED:return new b.PageHasHtmlObfuscated;case c.EXPRESSION_METHOD.IMAGE_BASED_OBFUSCATION:return new b.ImageBasedObfuscation;case c.EXPRESSION_METHOD.CONTAIN_MULTIPLE_SUBSTRINGS:return new b.ContainStrings(c.COMPARISON_TYPE.CONTAIN_MULTIPLE_SUBSTRINGS,c.COMPARISON_TYPE.CONTAIN_MULTIPLE_SUBSTRINGS);case c.EXPRESSION_METHOD.PAGE_HAS_CREATE_POPUP_URL:return new b.PageHasCreatePopupURL;
case c.EXPRESSION_METHOD.IN_DOMAIN_LIST:return new b.InDomainList;case c.EXPRESSION_METHOD.PAGE_IS_WEB_MAIL:return new b.PageIsWebMail;case c.EXPRESSION_METHOD.HOSTNAME_IS_WEB_MAIL:return new b.HostnameIsWebMail;case c.EXPRESSION_METHOD.PAGE_HAS_BAD_HISTORY:return new b.PageHasBadHistory;default:return null}}}}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.HasRedirectForm=function(a,b){var c=b.ExpressionMethod,e=a.utils.isNil,k=b.constants.domConstants,l=b.domManager.getDomObject(),h=b.defManager;a=function(a){c.call(this,"Page has Redirect Form")};a.prototype=Object.create(c.prototype);a.prototype.evaluate=function(a){a=l.getData(k.OBJECT_TYPE.FORMS_DATA);if(e(a))throw Error("Form Data is null");for(var c=!1,d=0;d<a.length;d++){var f=a[d].getHiddenInputValue("redirect");if(!e(f)&&(f=new URI(f),f.is(k.LINK_DATA.URL)&&(h.getDefObject().findInTrustedHostnames(f.hostname())||
h.getDefObject().findInTrustedDomains(f.hostname())))){c=!0;break}}return c?new b.ExpressionResult(!0,"Form has redirect URL"):new b.ExpressionResult(!1,"No forms in the page has redirect url")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.RuleEvaluator=function(a,b){var c=b.constants.indicatorConstants,e=a.utils.isNil,k=a.utils.isInteger,l=a.utils.isntNil,h=a.utils.isArray,d=a.utils.isBoolean,p=b.defManager,g=a.logger;a=function(a,b){if(!k(a)||!h(b))throw Error("Invalid inputs passed to RuleEvaluator");this._indicatorIndex=a;this._indicatorResults=b};a.prototype.evaluate=function(){var a=p.getIndicator(this._indicatorIndex),f=Number(a.getId());if(isNaN(f))throw Error("invalid method name");for(var h=0;h<a.getExpressionsCount();h++)try{var k=
b.expressionMethodFactory.getExpressionMethod(a.getMethodId(h));if(e(k))return new b.IndicatorResult(f,!1,a.getOffWeight(),"Unimplemented method");var r=b.expressionInputBuilder.getExpressionInputs(a.getFieldId(h),a.getMethodId(h),a.getValueType(h),a.getValue(h),this._indicatorResults);var t=k.evaluate(r);var v=null;switch(a.getRuleOperatorId()){case c.RULE_OPERATOR.AND:!1===t.getResult()&&(v=!1);break;case c.RULE_OPERATOR.OR:!0===t.getResult()&&(v=!0);break;case c.RULE_OPERATOR.NOT:v=!t.getResult();
break;default:v=!1}if(d(v)){var w=!0===v?a.getOnWeight():a.getOffWeight();return new b.IndicatorResult(f,v,w,"Success")}}catch(x){return g.debug("Error while running Indicator "+f+": "+x.message),new b.IndicatorResult(f,!1,a.getOffWeight(),x)}if(l(t)&&d(t.getResult()))return t.getResult()?new b.IndicatorResult(f,!0,a.getOnWeight(),"Success"):new b.IndicatorResult(f,!1,a.getOffWeight(),"Success");b.telemetryWrapper.sendIndicatorFailures("Failed for Indicator "+f);return new b.IndicatorResult(f,!1,
a.getOffWeight(),"Failed")};return a}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.detectionEngine=function(a,b){var c=b.defManager,e=b.constants,k=e.indicatorConstants,l=a.utils.isNil,h=a.performanceReporterFactoryProxy,d={_stopProcessing:!1,startProcessing:function(a){h.reportStart(e.WCID_LIBRARY,"DetectionEngine");var b=d.runIndicators();b=d.computeSpooficityClassification(b);h.reportEnd(e.WCID_LIBRARY,"DetectionEngine");a(b)},stopProcessing:function(){d._stopProcessing=!0},computeSpooficityClassification:function(a){var b=e.WCID_CLASSIFICATIONS.CLASSIFICATIONID_UNKNOWN;
if(l(a)||0===a.length)return b;for(var c=1,d=1,f=0;f<a.length;f++){var h=a[f].getWeight();switch(h){case k.SPOOFICITY_WEIGHT.NOTUSED:continue;case k.SPOOFICITY_WEIGHT.WEBSPOOFINGSITE:return e.WCID_CLASSIFICATIONS.CLASSIFICATIONID_WEBSPOOFINGSITE;case k.SPOOFICITY_WEIGHT.UNCLASSIFIEDSITE:b!==e.WCID_CLASSIFICATIONS.CLASSIFICATIONID_TRUSTWORTHYSITE&&(b=e.WCID_CLASSIFICATIONS.CLASSIFICATIONID_NEUTRALSITE);break;case k.SPOOFICITY_WEIGHT.TRUSTWORTHYSITE:b=e.WCID_CLASSIFICATIONS.CLASSIFICATIONID_TRUSTWORTHYSITE}c*=
h;d*=1-h}return b!==e.WCID_CLASSIFICATIONS.CLASSIFICATIONID_UNKNOWN?b:b=c/(c+d)>k.SPOOFICITY_THRESHOLD?e.WCID_CLASSIFICATIONS.CLASSIFICATIONID_WEBSPOOFINGSITE:e.WCID_CLASSIFICATIONS.CLASSIFICATIONID_NEUTRALSITE},runIndicators:function(){var a;try{var e=[],f=c.getIndicatorsCount();for(a=0;a<f;a++){if(!0===d._stopProcessing){e=[];break}var h=(new b.RuleEvaluator(a,e)).evaluate();e.push(h)}return e}catch(q){throw Error("Exception while running indicators "+q);}}};return d}(b.SymBfw,b.WCID)})(executionContext);
(function(b){(b.WCID=b.WCID||{}).manager=function(a,b){var c=b.constants.WCID_CLASSIFICATIONS,e=b.constants.MESSAGES,k=a.extensionAdapter,l=a.logger,h=a.utils.isNil,d=b.constants,p=a.performanceReporterFactoryProxy,g={_isDefLoaded:!1,_startHeuristicsCalled:!1,_stopProcessing:!0,_isDOMLoaded:!1,initializeWCID:function(){return new Promise(function(b,c){p.reportStart(d.WCID_LIBRARY,"WCID Initialization");g._currentURL=document.location.href;g._guid=a.utils.createNewGuid();c={id:e.CHECK_IN_SAFELIST,
payload:{currentURL:g._currentURL,guid:g._guid}};k.init();k.sendMessage(c);k.addContentScriptMessageListener(g._handleMessage);p.reportEnd(d.WCID_LIBRARY,"WCID Initialization");b("Success")})},setDOMContentLoaded:function(){g._isDOMLoaded=!0;g._startHeuristics()},_handleMessage:function(a,b,c){if(!h(a)&&!h(a.id))switch(a.id){case e.START_HEURISTICS:if(a.guid!==g._guid)break;g._startHeuristicsCalled=!0;g._stopProcessing=!1;g._startHeuristics();break;case e.STOP_HEURISTICS:h(a.payload)||h(a.payload.currentURL)||
g._stopHeuristics(a.payload.currentURL)}},_startHeuristics:function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(a){if(1==a.nextAddress)return!0===g._stopProcessing||!1===g._canStartHeuristics()?a.return():a.yield(b.defManager.loadDefObject(),2);if(!1===a.yieldResult)return a.return();b.domManager.parseDom(function(a,d){!0===a?b.detectionEngine.startProcessing(function(a){b.defManager.unLoadDefObject();!0!==g._stopProcessing&&!0!==b.detectionEngine._stopProcessing&&a===c.CLASSIFICATIONID_WEBSPOOFINGSITE&&
(k.sendMessage({id:e.WCID_HEURISTICS_RESULT,payload:{wcidClassification:a,currentURL:g._currentURL}}),b.telemetryWrapper.sendHeuristicResult("Spoofing Site"))}):l.debug("Error while initializing DOM Manager: "+d)});a.jumpToEnd()})},_canStartHeuristics:function(){return g._isDOMLoaded&&g._startHeuristicsCalled},_stopHeuristics:function(a){g._currentURL===a&&(g._stopProcessing=!0,b.detectionEngine.stopProcessing())}};return g}(b.SymBfw,b.WCID)})(executionContext);
(function(b){b.WCID.telemetryWrapper=function(a,b){var c=a.utils.isString,e=a.utils.isntNil,k=a.telemetryWrapper.parameters,l=a.telemetryWrapper.TELEMETRY_TYPE,h={TELEMETRY_CATEGORY:{INDICATOR_RESULT:"indicator_result",ERROR_THROWN:"error_thrown",HEURISTIC_RESULT:"heuristic_result",HEURISTIC_SERVER_MISMATCH:"heuristic_server_mismatch"},getSafeURL:function(){var a=new URI(document.location.href);a=a.protocol()+"://"+a.hostname()+a.pathname();var b=WCID.defManager.getDefObject().getData(WCID.constants.DEF_DATA_TYPES.URL_LOOKUP_DATA);
return"url="+a+"&tab_url="+b.tabURL},sendIndicatorFailures:function(a){h.send(h.TELEMETRY_CATEGORY.INDICATOR_RESULT,a,this.getSafeURL())},sendErrors:function(a){h.send(h.TELEMETRY_CATEGORY.ERROR_THROWN,a,this.getSafeURL())},sendHeuristicResult:function(a){h.send(h.TELEMETRY_CATEGORY.HEURISTIC_RESULT,a,this.getSafeURL())},sendHeuristicServerMismatch:function(a,b){h.send(h.TELEMETRY_CATEGORY.HEURISTIC_SERVER_MISMATCH,"mismatch-"+a,b)},send:function(b,f,g){if(!c(b)||!c(f))throw Error("category/action must be of type string");
var d={};d[k.EVENT]=l;d[k.CATEGORY]=b;d[k.ACTION]=f;e(g)&&(d[k.PAYLOAD]=g);(a.telemetry||a.telemetryProxy).send(d)}};return h}(b.SymBfw,b.SafeWeb)})(executionContext);
