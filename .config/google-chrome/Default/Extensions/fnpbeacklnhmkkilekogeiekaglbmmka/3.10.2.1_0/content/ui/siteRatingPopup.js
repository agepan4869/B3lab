var origin="",ratingsIndex,mouseentered=!1;
(function(a){(a.NSSS=a.NSSS||{}).annotationpopup=function(a,g){a={};var e=g.utils.isntNil;a.preparePopup=function(b){ratingsIndex=b.index;var a=null;if(b.hasOwnProperty("dir"))$("#body").attr("dir",b.dir);else{origin="annotations";$("div.PopupArea").attr("lang",b.lang);$("#Domain").text(b.normalizedURL);$("#Domain").attr("title",b.normalizedURL);a="neutral";switch(b.srcImage){case "sb_unsafeAnnotation.svg":a="red";break;case "sb_webnuisanceAnnotation.svg":a="warn";break;case "sb_unknownAnnotation.svg":a=
"unknown";break;case "sb_nortoncertified.svg":a="nsecured"}document.getElementById("ContentArea").setAttribute("state",a);var f="resultSpan_safe resultSpan_secure resultSpan_caution resultSpan_untested resultSpan_unsafe totalThreatLabel untestedText FullReportText".split(" "),d=[];for(c in f)a=document.getElementById(f[c]).dataset.l10nId,d.push(a);g.localizerProxy.getLocalizedStrings(d,function(a){for(var b in d){var c=d[b];$("#"+f[b]).text(a[c])}});var c=0;e(b.annoyanceFactorAttributes)&&(c+=b.annoyanceFactorAttributes);
e(b.computerThreatAttributes)&&(c+=b.computerThreatAttributes);e(b.identityThreatAttributes)&&(c+=b.identityThreatAttributes);$("#thread_cnt_r4").text(c)}};a.sendfullreportEvent=function(a){parent.window.postMessage({name:"openFullReportFromPanel",message:a},"*")};a.closePopup=function(){!1===mouseentered&&parent.window.postMessage({name:"closeAnnotationPopup"},"*")};return a}(a.NSSS,a.SymBfw)})(this);
$(document).ready(function(){$("#body").on("mouseenter",function(){mouseentered=!0});$("#body").on("mouseleave",function(){mouseentered=!1;NSSS.annotationpopup.closePopup()});$("#FullReport").on("click",function(){NSSS.annotationpopup.sendfullreportEvent({index:ratingsIndex})})});var receiveMessage=function(a){switch(a.data.name){case "preparePopup":NSSS.annotationpopup.preparePopup(a.data.message);break;case "canCloseAnnotation":NSSS.annotationpopup.closePopup()}};
window.addEventListener("message",receiveMessage,!1);
