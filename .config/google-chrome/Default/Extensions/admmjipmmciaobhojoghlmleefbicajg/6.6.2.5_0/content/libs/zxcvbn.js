(function(H){"object"===typeof exports&&"undefined"!==typeof module?module.exports=H():"function"===typeof define&&define.amd?define([],H):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).zxcvbn=H()})(function(){return function f(k,p,x){function d(c,b){if(!p[c]){if(!k[c]){var e="function"==typeof require&&require;if(!b&&e)return e(c,!0);if(a)return a(c,!0);b=Error("Cannot find module '"+c+"'");throw b.code="MODULE_NOT_FOUND",b;}b=p[c]={exports:{}};
k[c][0].call(b.exports,function(a){var b=k[c][1][a];return d(b?b:a)},b,b.exports,f,k,p,x)}return p[c].exports}for(var a="function"==typeof require&&require,b=0;b<x.length;b++)d(x[b]);return d}({1:[function(k,p,x){p.exports={qwerty:{"!":["`~",null,null,"2@","qQ",null],'"':[";:","[{","]}",null,null,"/?"],"#":["2@",null,null,"4$","eE","wW"],$:["3#",null,null,"5%","rR","eE"],"%":["4$",null,null,"6^","tT","rR"],"&":["6^",null,null,"8*","uU","yY"],"'":[";:","[{","]}",null,null,"/?"],"(":["8*",null,null,
"0)","oO","iI"],")":["9(",null,null,"-_","pP","oO"],"*":["7&",null,null,"9(","iI","uU"],"+":["-_",null,null,null,"]}","[{"],",":["mM","kK","lL",".>",null,null],"-":["0)",null,null,"=+","[{","pP"],".":[",<","lL",";:","/?",null,null],"/":[".>",";:","'\"",null,null,null],0:["9(",null,null,"-_","pP","oO"],1:["`~",null,null,"2@","qQ",null],2:["1!",null,null,"3#","wW","qQ"],3:["2@",null,null,"4$","eE","wW"],4:["3#",null,null,"5%","rR","eE"],5:["4$",null,null,"6^","tT","rR"],6:["5%",null,null,"7&","yY",
"tT"],7:["6^",null,null,"8*","uU","yY"],8:["7&",null,null,"9(","iI","uU"],9:["8*",null,null,"0)","oO","iI"],":":"lL pP [{ '\" /? .>".split(" "),";":"lL pP [{ '\" /? .>".split(" "),"<":["mM","kK","lL",".>",null,null],"=":["-_",null,null,null,"]}","[{"],">":[",<","lL",";:","/?",null,null],"?":[".>",";:","'\"",null,null,null],"@":["1!",null,null,"3#","wW","qQ"],A:[null,"qQ","wW","sS","zZ",null],B:["vV","gG","hH","nN",null,null],C:["xX","dD","fF","vV",null,null],D:"sS eE rR fF cC xX".split(" "),E:"wW 3# 4$ rR dD sS".split(" "),
F:"dD rR tT gG vV cC".split(" "),G:"fF tT yY hH bB vV".split(" "),H:"gG yY uU jJ nN bB".split(" "),I:"uU 8* 9( oO kK jJ".split(" "),J:"hH uU iI kK mM nN".split(" "),K:"jJ iI oO lL ,< mM".split(" "),L:"kK oO pP ;: .> ,<".split(" "),M:["nN","jJ","kK",",<",null,null],N:["bB","hH","jJ","mM",null,null],O:"iI 9( 0) pP lL kK".split(" "),P:"oO 0) -_ [{ ;: lL".split(" "),Q:[null,"1!","2@","wW","aA",null],R:"eE 4$ 5% tT fF dD".split(" "),S:"aA wW eE dD xX zZ".split(" "),T:"rR 5% 6^ yY gG fF".split(" "),U:"yY 7& 8* iI jJ hH".split(" "),
V:["cC","fF","gG","bB",null,null],W:"qQ 2@ 3# eE sS aA".split(" "),X:["zZ","sS","dD","cC",null,null],Y:"tT 6^ 7& uU hH gG".split(" "),Z:[null,"aA","sS","xX",null,null],"[":"pP -_ =+ ]} '\" ;:".split(" "),"\\":["]}",null,null,null,null,null],"]":["[{","=+",null,"\\|",null,"'\""],"^":["5%",null,null,"7&","yY","tT"],_:["0)",null,null,"=+","[{","pP"],"`":[null,null,null,"1!",null,null],a:[null,"qQ","wW","sS","zZ",null],b:["vV","gG","hH","nN",null,null],c:["xX","dD","fF","vV",null,null],d:"sS eE rR fF cC xX".split(" "),
e:"wW 3# 4$ rR dD sS".split(" "),f:"dD rR tT gG vV cC".split(" "),g:"fF tT yY hH bB vV".split(" "),h:"gG yY uU jJ nN bB".split(" "),i:"uU 8* 9( oO kK jJ".split(" "),j:"hH uU iI kK mM nN".split(" "),k:"jJ iI oO lL ,< mM".split(" "),l:"kK oO pP ;: .> ,<".split(" "),m:["nN","jJ","kK",",<",null,null],n:["bB","hH","jJ","mM",null,null],o:"iI 9( 0) pP lL kK".split(" "),p:"oO 0) -_ [{ ;: lL".split(" "),q:[null,"1!","2@","wW","aA",null],r:"eE 4$ 5% tT fF dD".split(" "),s:"aA wW eE dD xX zZ".split(" "),t:"rR 5% 6^ yY gG fF".split(" "),
u:"yY 7& 8* iI jJ hH".split(" "),v:["cC","fF","gG","bB",null,null],w:"qQ 2@ 3# eE sS aA".split(" "),x:["zZ","sS","dD","cC",null,null],y:"tT 6^ 7& uU hH gG".split(" "),z:[null,"aA","sS","xX",null,null],"{":"pP -_ =+ ]} '\" ;:".split(" "),"|":["]}",null,null,null,null,null],"}":["[{","=+",null,"\\|",null,"'\""],"~":[null,null,null,"1!",null,null]},dvorak:{"!":["`~",null,null,"2@","'\"",null],'"':[null,"1!","2@",",<","aA",null],"#":["2@",null,null,"4$",".>",",<"],$:["3#",null,null,"5%","pP",".>"],"%":["4$",
null,null,"6^","yY","pP"],"&":["6^",null,null,"8*","gG","fF"],"'":[null,"1!","2@",",<","aA",null],"(":["8*",null,null,"0)","rR","cC"],")":["9(",null,null,"[{","lL","rR"],"*":["7&",null,null,"9(","cC","gG"],"+":["/?","]}",null,"\\|",null,"-_"],",":"'\" 2@ 3# .> oO aA".split(" "),"-":["sS","/?","=+",null,null,"zZ"],".":",< 3# 4$ pP eE oO".split(" "),"/":"lL [{ ]} =+ -_ sS".split(" "),0:["9(",null,null,"[{","lL","rR"],1:["`~",null,null,"2@","'\"",null],2:["1!",null,null,"3#",",<","'\""],3:["2@",null,
null,"4$",".>",",<"],4:["3#",null,null,"5%","pP",".>"],5:["4$",null,null,"6^","yY","pP"],6:["5%",null,null,"7&","fF","yY"],7:["6^",null,null,"8*","gG","fF"],8:["7&",null,null,"9(","cC","gG"],9:["8*",null,null,"0)","rR","cC"],":":[null,"aA","oO","qQ",null,null],";":[null,"aA","oO","qQ",null,null],"<":"'\" 2@ 3# .> oO aA".split(" "),"=":["/?","]}",null,"\\|",null,"-_"],">":",< 3# 4$ pP eE oO".split(" "),"?":"lL [{ ]} =+ -_ sS".split(" "),"@":["1!",null,null,"3#",",<","'\""],A:[null,"'\"",",<","oO",
";:",null],B:["xX","dD","hH","mM",null,null],C:"gG 8* 9( rR tT hH".split(" "),D:"iI fF gG hH bB xX".split(" "),E:"oO .> pP uU jJ qQ".split(" "),F:"yY 6^ 7& gG dD iI".split(" "),G:"fF 7& 8* cC hH dD".split(" "),H:"dD gG cC tT mM bB".split(" "),I:"uU yY fF dD xX kK".split(" "),J:["qQ","eE","uU","kK",null,null],K:["jJ","uU","iI","xX",null,null],L:"rR 0) [{ /? sS nN".split(" "),M:["bB","hH","tT","wW",null,null],N:"tT rR lL sS vV wW".split(" "),O:"aA ,< .> eE qQ ;:".split(" "),P:".> 4$ 5% yY uU eE".split(" "),
Q:[";:","oO","eE","jJ",null,null],R:"cC 9( 0) lL nN tT".split(" "),S:"nN lL /? -_ zZ vV".split(" "),T:"hH cC rR nN wW mM".split(" "),U:"eE pP yY iI kK jJ".split(" "),V:["wW","nN","sS","zZ",null,null],W:["mM","tT","nN","vV",null,null],X:["kK","iI","dD","bB",null,null],Y:"pP 5% 6^ fF iI uU".split(" "),Z:["vV","sS","-_",null,null,null],"[":["0)",null,null,"]}","/?","lL"],"\\":["=+",null,null,null,null,null],"]":["[{",null,null,null,"=+","/?"],"^":["5%",null,null,"7&","fF","yY"],_:["sS","/?","=+",null,
null,"zZ"],"`":[null,null,null,"1!",null,null],a:[null,"'\"",",<","oO",";:",null],b:["xX","dD","hH","mM",null,null],c:"gG 8* 9( rR tT hH".split(" "),d:"iI fF gG hH bB xX".split(" "),e:"oO .> pP uU jJ qQ".split(" "),f:"yY 6^ 7& gG dD iI".split(" "),g:"fF 7& 8* cC hH dD".split(" "),h:"dD gG cC tT mM bB".split(" "),i:"uU yY fF dD xX kK".split(" "),j:["qQ","eE","uU","kK",null,null],k:["jJ","uU","iI","xX",null,null],l:"rR 0) [{ /? sS nN".split(" "),m:["bB","hH","tT","wW",null,null],n:"tT rR lL sS vV wW".split(" "),
o:"aA ,< .> eE qQ ;:".split(" "),p:".> 4$ 5% yY uU eE".split(" "),q:[";:","oO","eE","jJ",null,null],r:"cC 9( 0) lL nN tT".split(" "),s:"nN lL /? -_ zZ vV".split(" "),t:"hH cC rR nN wW mM".split(" "),u:"eE pP yY iI kK jJ".split(" "),v:["wW","nN","sS","zZ",null,null],w:["mM","tT","nN","vV",null,null],x:["kK","iI","dD","bB",null,null],y:"pP 5% 6^ fF iI uU".split(" "),z:["vV","sS","-_",null,null,null],"{":["0)",null,null,"]}","/?","lL"],"|":["=+",null,null,null,null,null],"}":["[{",null,null,null,"=+",
"/?"],"~":[null,null,null,"1!",null,null]},keypad:{"*":["/",null,null,null,"-","+","9","8"],"+":["9","*","-",null,null,null,null,"6"],"-":["*",null,null,null,null,null,"+","9"],".":["0","2","3",null,null,null,null,null],"/":[null,null,null,null,"*","9","8","7"],0:[null,"1","2","3",".",null,null,null],1:[null,null,"4","5","2","0",null,null],2:["1","4","5","6","3",".","0",null],3:["2","5","6",null,null,null,".","0"],4:[null,null,"7","8","5","2","1",null],5:"47896321".split(""),6:["5","8","9","+",null,
null,"3","2"],7:[null,null,null,"/","8","5","4",null],8:["7",null,"/","*","9","6","5","4"],9:["8","/","*","-","+",null,"6","5"]},mac_keypad:{"*":["/",null,null,null,null,null,"-","9"],"+":["6","9","-",null,null,null,null,"3"],"-":["9","/","*",null,null,null,"+","6"],".":["0","2","3",null,null,null,null,null],"/":["=",null,null,null,"*","-","9","8"],0:[null,"1","2","3",".",null,null,null],1:[null,null,"4","5","2","0",null,null],2:["1","4","5","6","3",".","0",null],3:["2","5","6","+",null,null,".",
"0"],4:[null,null,"7","8","5","2","1",null],5:"47896321".split(""),6:["5","8","9","-","+",null,"3","2"],7:[null,null,null,"=","8","5","4",null],8:["7",null,"=","/","9","6","5","4"],9:"8=/*-+65".split(""),"=":[null,null,null,null,"/","9","8","7"]}}},{}],2:[function(k,p,x){var f=k("./scoring");var d={default_feedback:{warning:"",suggestions:["Use a few words, avoid common phrases","No need for symbols, digits, or uppercase letters"]},get_feedback:function(a,b){var c;if(0===b.length)return this.default_feedback;
if(2<a)return{warning:"",suggestions:[]};var e=b[0];var m=b.slice(1);a=0;for(c=m.length;a<c;a++){var f=m[a];f.token.length>e.token.length&&(e=f)}return d=this.get_match_feedback(e,1===b.length),null!=d?(d.suggestions.unshift("Add another word or two. Uncommon words are better."),null==d.warning&&(d.warning="")):d={warning:"",suggestions:["Add another word or two. Uncommon words are better."]},d},get_match_feedback:function(a,b){var c;switch(a.pattern){case "dictionary":return this.get_dictionary_match_feedback(a,
b);case "spatial":return a.graph.toUpperCase(),c=1===a.turns?"Straight rows of keys are easy to guess":"Short keyboard patterns are easy to guess",{warning:c,suggestions:["Use a longer keyboard pattern with more turns"]};case "repeat":return c=1===a.base_token.length?'Repeats like "aaa" are easy to guess':'Repeats like "abcabcabc" are only slightly harder to guess than "abc"',{warning:c,suggestions:["Avoid repeated words and characters"]};case "sequence":return{warning:"Sequences like abc or 6543 are easy to guess",
suggestions:["Avoid sequences"]};case "regex":if("recent_year"===a.regex_name)return{warning:"Recent years are easy to guess",suggestions:["Avoid recent years","Avoid years that are associated with you"]};break;case "date":return{warning:"Dates are often easy to guess",suggestions:["Avoid dates and years that are associated with you"]}}},get_dictionary_match_feedback:function(a,b){var c,e,m,d;return m="passwords"===a.dictionary_name?!b||a.l33t||a.reversed?4>=a.guesses_log10?"This is similar to a commonly used password":
void 0:10>=a.rank?"This is a top-10 common password":100>=a.rank?"This is a top-100 common password":"This is a very common password":"english"===a.dictionary_name?b?"A word by itself is easy to guess":void 0:"surnames"===(c=a.dictionary_name)||"male_names"===c||"female_names"===c?b?"Names and surnames by themselves are easy to guess":"Common names and surnames are easy to guess":"",e=[],d=a.token,d.match(f.START_UPPER)?e.push("Capitalization doesn't help very much"):d.match(f.ALL_UPPER)&&d.toLowerCase()!==
d&&e.push("All-uppercase is almost as easy to guess as all-lowercase"),a.reversed&&4<=a.token.length&&e.push("Reversed words aren't much harder to guess"),a.l33t&&e.push("Predictable substitutions like '@' instead of 'a' don't help very much"),{warning:m,suggestions:e}}};p.exports=d},{"./scoring":6}],3:[function(k,p,x){p.exports={passwords:["123456","password"],female_names:["mary","allyn"],surnames:["smith","williams","bonnette"],us_tv_and_film:["you","know","a'right"],male_names:["james","john"]}},
{}],4:[function(k,p,x){var f=k("./matching");var d=k("./scoring");var a=k("./time_estimates");var b=k("./feedback");var c=function(){return(new Date).getTime()};p.exports=function(e,m){var t,n,g;null==m&&(m=[]);var h=c();var l=[];var D=0;for(t=m.length;D<t;D++){var q=m[D];"string"!=(g=typeof q)&&"number"!==g&&"boolean"!==g||l.push(q.toString().toLowerCase())}f.set_user_input_dictionary(l);m=f.omnimatch(e);e=d.most_guessable_match_sequence(e,m);e.calc_time=c()-h;h=a.estimate_attack_times(e.guesses);
for(n in h)m=h[n],e[n]=m;return e.feedback=b.get_feedback(e.score,e.sequence),e}},{"./feedback":2,"./matching":5,"./scoring":6,"./time_estimates":7}],5:[function(k,p,x){var f;var d=k("./frequency_lists");x=k("./adjacency_graphs");var a=k("./scoring");var b=function(a){var h;var l={};var g=1;var q=0;for(h=a.length;q<h;q++){var b=a[q];l[b]=g;g+=1}return l};var c={};for(f in d)k=d[f],c[f]=b(k);var e={qwerty:x.qwerty,dvorak:x.dvorak,keypad:x.keypad,mac_keypad:x.mac_keypad};var m={a:["4","@"],b:["8"],
c:["(","{","[","<"],e:["3"],g:["6","9"],i:["1","!","|"],l:["1","|","7"],o:["0"],s:["$","5"],t:["+","7"],x:["%"],z:["2"]};var t={recent_year:/19\d\d|200\d|201\d/g};var n={4:[[1,2],[2,3]],5:[[1,3],[2,3]],6:[[1,2],[2,4],[4,5]],7:[[1,3],[2,3],[4,5],[4,6]],8:[[2,4],[4,6]]};p.exports={empty:function(a){var h;var g=[];for(h in a)g.push(h);return 0===g.length},extend:function(a,h){return a.push.apply(a,h)},translate:function(a,h){var l;var g=a.split("");var b=[];var c=0;for(l=g.length;c<l;c++)a=g[c],b.push(h[a]||
a);return b.join("")},mod:function(a,h){return(a%h+h)%h},sorted:function(a){return a.sort(function(a,l){return a.i-l.i||a.j-l.j})},omnimatch:function(a){var h;var l=[];var g=[this.dictionary_match,this.reverse_dictionary_match,this.l33t_match,this.spatial_match,this.repeat_match,this.sequence_match,this.regex_match,this.date_match];var b=0;for(h=g.length;b<h;b++){var c=g[b];this.extend(l,c.call(this,a))}return this.sorted(l)},dictionary_match:function(a,h){var l,g,b,u,e,m,d,f;null==h&&(h=c);var A=
[];var n=a.length;var r=a.toLowerCase();for(l in h){var v=h[l];var w=g=0;for(e=n;0<=e?g<e:g>e;w=0<=e?++g:--g){var y=b=m=w;for(d=n;m<=d?b<d:b>d;y=m<=d?++b:--b)r.slice(w,+y+1||9E9)in v&&(f=r.slice(w,+y+1||9E9),u=v[f],A.push({pattern:"dictionary",i:w,j:y,token:a.slice(w,+y+1||9E9),matched_word:f,rank:u,dictionary_name:l,reversed:!1,l33t:!1}))}}return this.sorted(A)},reverse_dictionary_match:function(a,h){null==h&&(h=c);var l=a.split("").reverse().join("");var b=this.dictionary_match(l,h);var g=0;for(h=
b.length;g<h;g++){l=b[g];l.token=l.token.split("").reverse().join("");l.reversed=!0;var u=[a.length-1-l.j,a.length-1-l.i];l.i=u[0];l.j=u[1]}return this.sorted(b)},set_user_input_dictionary:function(a){return c.user_inputs=b(a.slice())},relevant_l33t_subtable:function(a,h){var b,g;var c={};var u=a.split("");var e=0;for(b=u.length;e<b;e++)a=u[e],c[a]=!0;a={};for(g in h){e=h[g];var m;u=[];var d=0;for(m=e.length;d<m;d++)b=e[d],b in c&&u.push(b);b=u;0<b.length&&(a[g]=b)}return a},enumerate_l33t_subs:function(a){var h,
b,g;var c=function(){var b=[];for(h in a)b.push(h);return b}();var u=[[]];var e=function(a){var b,g;var l=[];var c={};var e=0;for(b=a.length;e<b;e++){var u=a[e];var q=function(){var a,b;var l=[];g=b=0;for(a=u.length;b<a;g=++b)h=u[g],l.push([h,g]);return l}();q.sort();var D=function(){var a,b;var l=[];g=b=0;for(a=q.length;b<a;g=++b)h=q[g],l.push(h+","+g);return l}().join("-");D in c||(c[D]=!0,l.push(u))}return l};var m=function(b){var h,g,l,c,q,D;if(b.length){var d=b[0];var w=b.slice(1);var f=[];var K=
a[d];var n=0;for(h=K.length;n<h;n++){var I=K[n];var E=0;for(g=u.length;E<g;E++){var r=u[E];b=-1;var v=l=0;for(c=r.length;0<=c?l<c:l>c;v=0<=c?++l:--l)if(r[v][0]===I){b=v;break}-1===b?(D=r.concat([[I,d]]),f.push(D)):(q=r.slice(0),q.splice(b,1),q.push([I,d]),f.push(r),f.push(q))}}return u=e(f),m(w)}};m(c);var d=[];var f=0;for(b=u.length;f<b;f++){var n=u[f];var t={};var r=0;for(g=n.length;r<g;r++){var v=n[r];c=v[0];v=v[1];t[c]=v}d.push(t)}return d},l33t_match:function(a,b,l){var h,g,e,d,f,n,t;null==b&&
(b=c);null==l&&(l=m);var A=[];var k=this.enumerate_l33t_subs(this.relevant_l33t_subtable(a,l));var r=0;for(l=k.length;r<l&&(d=k[r],!this.empty(d));r++){var v=this.translate(a,d);var w=this.dictionary_match(v,b);var y=0;for(g=w.length;y<g;y++)if(e=w[y],n=a.slice(e.i,+e.j+1||9E9),n.toLowerCase()!==e.matched_word){var z={};for(f in d)v=d[f],-1!==n.indexOf(f)&&(z[f]=v);e.l33t=!0;e.token=n;e.sub=z;e.sub_display=function(){var a=[];for(h in z)t=z[h],a.push(h+" -> "+t);return a}().join(", ");A.push(e)}}return this.sorted(A.filter(function(a){return 1<
a.token.length}))},spatial_match:function(a,b){var h;null==b&&(b=e);var g=[];for(h in b){var c=b[h];this.extend(g,this.spatial_match_helper(a,c,h))}return this.sorted(g)},SHIFTED_RX:/[~!@#$%^&*()_+QWERTYUIOP{}|ASDFGHJKL:"ZXCVBNM<>?]/,spatial_match_helper:function(a,b,l){var h,g,c,e,d,m,f,n;var t=[];for(d=0;d<a.length-1;){var r=d+1;var v=null;var w=0;for(n="qwerty"!==l&&"dvorak"!==l||!this.SHIFTED_RX.exec(a.charAt(d))?0:1;;){if(f=a.charAt(r-1),e=!1,c=-1,g=b[f]||[],r<a.length){var y=a.charAt(r);var z=
0;for(m=g.length;z<m;z++)if(h=g[z],c+=1,h&&-1!==h.indexOf(y)){e=!0;g=c;1===h.indexOf(y)&&(n+=1);v!==g&&(w+=1,v=g);break}}if(!e){2<r-d&&t.push({pattern:"spatial",i:d,j:r-1,token:a.slice(d,r),graph:l,turns:w,shifted_count:n});d=r;break}r+=1}}return t},repeat_match:function(b){var h,g,c,e,d;var m=[];var f=/(.+)\1+/g;var n=/(.+?)\1+/g;var t=/^(.+?)\1+$/;for(c=0;c<b.length&&(f.lastIndex=n.lastIndex=c,g=f.exec(b),e=n.exec(b),null!=g);){g[0].length>e[0].length?(d=g,h=t.exec(d[0])[1]):(d=e,h=d[1]);var k=
[d.index,d.index+d[0].length-1];c=k[0];var B=k[1];var r=a.most_guessable_match_sequence(h,this.omnimatch(h));k=r.sequence;r=r.guesses;m.push({pattern:"repeat",i:c,j:B,token:d[0],base_token:h,base_guesses:r,base_matches:k,repeat_count:d[0].length/h.length});c=B+1}return m},MAX_DELTA:5,sequence_match:function(a){var b,c,g;if(1===a.length)return[];var e=function(b){return function(h,c,g){var l,e,m,f;if((1<c-h||1===Math.abs(g))&&0<(l=Math.abs(g))&&l<=b.MAX_DELTA)return f=a.slice(h,+c+1||9E9),/^[a-z]+$/.test(f)?
(e="lower",m=26):/^[A-Z]+$/.test(f)?(e="upper",m=26):/^\d+$/.test(f)?(e="digits",m=10):(e="unicode",m=26),d.push({pattern:"sequence",i:h,j:c,token:a.slice(h,+c+1||9E9),sequence_name:e,sequence_space:m,ascending:0<g})}}(this);var d=[];var m=0;var f=null;var n=c=1;for(g=a.length;1<=g?c<g:c>g;n=1<=g?++c:--c){var t=a.charCodeAt(n)-a.charCodeAt(n-1);null==f&&(f=t);t!==f&&(b=n-1,e(m,b,f),m=b,f=t)}return e(m,a.length-1,f),d},regex_match:function(a,b){var c;null==b&&(b=t);var h=[];for(f in b){var g=b[f];
for(g.lastIndex=0;c=g.exec(a);){var e=c[0];h.push({pattern:"regex",token:e,i:c.index,j:c.index+c[0].length-1,regex_name:f,regex_match:c})}}return this.sorted(h)},date_match:function(b){var c,g,e,d,m,f,t,k,p;var A=[];var B=/^\d{4,8}$/;var r=/^(\d{1,4})([\s\/\\_.-])(\d{1,2})\2(\d{1,4})$/;var v=e=0;for(m=b.length-4;0<=m?e<=m:e>=m;v=0<=m?++e:--e){var w=d=f=v+3;for(t=v+7;(f<=t?d<=t:d>=t)&&!(w>=b.length);w=f<=t?++d:--d)if(p=b.slice(v,+w+1||9E9),B.exec(p)){var y=[];var z=n[p.length];var G=0;for(c=z.length;G<
c;G++){var F=z[G];var C=F[0];F=F[1];C=this.map_ints_to_dmy([parseInt(p.slice(0,C)),parseInt(p.slice(C,F)),parseInt(p.slice(F))]);null!=C&&y.push(C)}if(0<y.length){c=y[0];G=function(b){return Math.abs(b.year-a.REFERENCE_YEAR)};z=G(y[0]);var x=y.slice(1);var J=0;for(g=x.length;J<g;J++)y=x[J],F=G(y),F<z&&(k=[y,F],c=k[0],z=k[1]);A.push({pattern:"date",token:p,i:v,j:w,separator:"",year:c.year,month:c.month,day:c.day})}}}v=f=0;for(B=b.length-6;0<=B?f<=B:f>=B;v=0<=B?++f:--f)for(w=t=e=v+5,d=v+9;(e<=d?t<=
d:t>=d)&&!(w>=b.length);w=e<=d?++t:--t)p=b.slice(v,+w+1||9E9),m=r.exec(p),null!=m&&(C=this.map_ints_to_dmy([parseInt(m[1]),parseInt(m[3]),parseInt(m[4])]),null!=C&&A.push({pattern:"date",token:p,i:v,j:w,separator:m[2],year:C.year,month:C.month,day:C.day}));return this.sorted(A.filter(function(a){var b,c;var h=!1;var g=0;for(b=A.length;g<b;g++)if(c=A[g],a!==c&&c.i<=a.i&&c.j>=a.j){h=!0;break}return!h}))},map_ints_to_dmy:function(a){var b,c,e,g,d,m,f,n,t,k;if(!(31<a[1]||0>=a[1])){var p=t=m=d=0;for(e=
a.length;p<e;p++){if(c=a[p],99<c&&1E3>c||2050<c)return;31<c&&(m+=1);12<c&&(d+=1);0>=c&&(t+=1)}if(!(2<=m||3===d||2<=t)){a=[[a[2],a.slice(0,2)],[a[0],a.slice(1,3)]];e=0;for(c=a.length;e<c;e++)if(g=a[e],k=g[0],n=g[1],1E3<=k&&2050>=k)return b=this.map_ints_to_dm(n),null!=b?{year:k,month:b.month,day:b.day}:void 0;c=0;for(g=a.length;c<g;c++)if(f=a[c],k=f[0],n=f[1],b=this.map_ints_to_dm(n),null!=b)return k=this.two_to_four_digit_year(k),{year:k,month:b.month,day:b.day}}}},map_ints_to_dm:function(a){var b,
c,e;var g=[a,a.slice().reverse()];var d=0;for(a=g.length;d<a;d++)if(e=g[d],b=e[0],c=e[1],1<=b&&31>=b&&1<=c&&12>=c)return{day:b,month:c}},two_to_four_digit_year:function(a){return 99<a?a:50<a?a+1900:a+2E3}}},{"./adjacency_graphs":1,"./frequency_lists":3,"./scoring":6}],6:[function(k,p,x){var f;var d=k("./adjacency_graphs");k=function(a){var b,c,e;var d=0;for(c in a){var f=a[c];d+=function(){var a;var b=[];var c=0;for(a=f.length;c<a;c++)(e=f[c])&&b.push(e);return b}().length}return d/=function(){var c=
[];for(b in a)c.push(b);return c}().length};k={nCk:function(a,b){var c,e,d;if(b>a)return 0;if(0===b)return 1;for(c=e=d=1;1<=b?e<=b:e>=b;c=1<=b?++e:--e)d*=a,d/=c,--a;return d},log10:function(a){return Math.log(a)/Math.log(10)},log2:function(a){return Math.log(a)/Math.log(2)},factorial:function(a){var b,c;if(2>a)return 1;var e=1;for(b=c=2;2<=a?c<=a:c>=a;b=2<=a?++c:--c)e*=b;return e},most_guessable_match_sequence:function(a,b,c){var e,d,f,n,g;null==c&&(c=!1);var h=a.length;var l=function(){var a;var b=
[];for(a=0;0<=h?a<h:a>h;0<=h?++a:--a)b.push([]);return b}();var k=0;for(d=b.length;k<d;k++){var q=b[k];l[q.j].push(q)}k=0;for(b=l.length;k<b;k++)d=l[k],d.sort(function(a,b){return a.i-b.i});var u=function(){var a;var b=[];for(a=0;0<=h?a<h:a>h;0<=h?++a:--a)b.push({});return b}();var p=function(){var a;var b=[];for(a=0;0<=h?a<h:a>h;0<=h?++a:--a)b.push({});return b}();var x=function(){var a;var b=[];for(a=0;0<=h?a<h:a>h;0<=h?++a:--a)b.push({});return b}();var E=function(b){return function(e,d){var h,
g;var f=e.j;var m=b.estimate_guesses(e,a);1<d&&(m*=p[e.i-1][d-1]);var l=b.factorial(d)*m;c||(l+=Math.pow(1E4,d-1));var n=x[f];for(g in n)if(h=n[g],!(g>d)&&h<=l)return;return x[f][d]=l,u[f][d]=e,p[f][d]=m}}(this);b=function(a){return function(a){var b,c,d,e;q=L(0,a);E(q,1);var h=[];for(b=e=1;1<=a?e<=a:e>=a;b=1<=a?++e:--e)q=L(b,a),h.push(function(){var a=u[b-1];var e=[];for(c in a)d=a[c],c=parseInt(c),"bruteforce"!==d.pattern&&e.push(E(q,c+1));return e}());return h}}(this);var L=function(b){return function(b,
c){return{pattern:"bruteforce",token:a.slice(b,+c+1||9E9),i:b,j:c}}}(this);var A=function(a){return function(a){var b;var c=[];var e=a-1;var d=void 0;var h=1/0;var g=x[e];for(b in g)a=g[b],a<h&&(d=b,h=a);for(;0<=e;)q=u[e][d],c.unshift(q),e=q.i-1,d--;return c}}(this);for(d=g=0;0<=h?g<h:g>h;d=0<=h?++g:--g){var B=l[d];var r=0;for(k=B.length;r<k;r++)if(q=B[r],0<q.i)for(v in u[q.i-1]){var v=parseInt(v);E(q,v+1)}else E(q,1);b(d)}return n=A(h),f=n.length,e=0===a.length?1:x[h-1][f],{password:a,guesses:e,
guesses_log10:this.log10(e),sequence:n}},estimate_guesses:function(a,b){var c,e,d;return null!=a.guesses?a.guesses:(d=1,a.token.length<b.length&&(d=1===a.token.length?10:50),c={bruteforce:this.bruteforce_guesses,dictionary:this.dictionary_guesses,spatial:this.spatial_guesses,repeat:this.repeat_guesses,sequence:this.sequence_guesses,regex:this.regex_guesses,date:this.date_guesses},e=c[a.pattern].call(this,a),a.guesses=Math.max(e,d),a.guesses_log10=this.log10(a.guesses),a.guesses)},bruteforce_guesses:function(a){var b,
c;return b=Math.pow(10,a.token.length),c=1===a.token.length?11:51,Math.max(b,c)},repeat_guesses:function(a){return a.base_guesses*a.repeat_count},sequence_guesses:function(a){var b,c;return c=a.token.charAt(0),b="a"===c||"A"===c||"z"===c||"Z"===c||"0"===c||"1"===c||"9"===c?4:c.match(/\d/)?10:26,a.ascending||(b*=2),b*a.token.length},MIN_YEAR_SPACE:20,REFERENCE_YEAR:2016,regex_guesses:function(a){var b,c;if(b={alpha_lower:26,alpha_upper:26,alpha:52,alphanumeric:62,digits:10,symbols:33},a.regex_name in
b)return Math.pow(b[a.regex_name],a.token.length);switch(a.regex_name){case "recent_year":return c=Math.abs(parseInt(a.regex_match[0])-this.REFERENCE_YEAR),Math.max(c,this.MIN_YEAR_SPACE)}},date_guesses:function(a){var b,c;return c=Math.max(Math.abs(a.year-this.REFERENCE_YEAR),this.MIN_YEAR_SPACE),b=365*c,a.separator&&(b*=4),b},KEYBOARD_AVERAGE_DEGREE:k(d.qwerty),KEYPAD_AVERAGE_DEGREE:k(d.keypad),KEYBOARD_STARTING_POSITIONS:function(){var a=d.qwerty;var b=[];for(f in a)b.push(f);return b}().length,
KEYPAD_STARTING_POSITIONS:function(){var a=d.keypad;var b=[];for(f in a)b.push(f);return b}().length,spatial_guesses:function(a){var b,c,d,f,k,n,g,h,l;"qwerty"===(f=a.graph)||"dvorak"===f?(l=this.KEYBOARD_STARTING_POSITIONS,d=this.KEYBOARD_AVERAGE_DEGREE):(l=this.KEYPAD_STARTING_POSITIONS,d=this.KEYPAD_AVERAGE_DEGREE);f=0;var p=a.token.length;var q=a.turns;for(k=g=2;2<=p?g<=p:g>=p;k=2<=p?++g:--g){var u=Math.min(q,k-1);for(n=h=1;1<=u?h<=u:h>=u;n=1<=u?++h:--h)f+=this.nCk(k-1,n-1)*l*Math.pow(d,n)}if(a.shifted_count)if(b=
a.shifted_count,c=a.token.length-a.shifted_count,0===b||0===c)f*=2;else{d=0;k=l=1;for(a=Math.min(b,c);1<=a?l<=a:l>=a;k=1<=a?++l:--l)d+=this.nCk(b+c,k);f*=d}return f},dictionary_guesses:function(a){var b;return a.base_guesses=a.rank,a.uppercase_variations=this.uppercase_variations(a),a.l33t_variations=this.l33t_variations(a),b=a.reversed&&2||1,a.base_guesses*a.uppercase_variations*a.l33t_variations*b},START_UPPER:/^[A-Z][^A-Z]+$/,END_UPPER:/^[^A-Z]+[A-Z]$/,ALL_UPPER:/^[^a-z]+$/,ALL_LOWER:/^[^A-Z]+$/,
uppercase_variations:function(a){var b,c,d,f;if(f=a.token,f.match(this.ALL_LOWER)||f.toLowerCase()===f)return 1;var k=[this.START_UPPER,this.END_UPPER,this.ALL_UPPER];var n=0;for(a=k.length;n<a;n++)if(b=k[n],f.match(b))return 2;a=function(){var a;var b=f.split("");var d=[];var e=0;for(a=b.length;e<a;e++)c=b[e],c.match(/[A-Z]/)&&d.push(c);return d}().length;b=function(){var a;var b=f.split("");var d=[];var e=0;for(a=b.length;e<a;e++)c=b[e],c.match(/[a-z]/)&&d.push(c);return d}().length;var g=0;n=k=
1;for(d=Math.min(a,b);1<=d?k<=d:k>=d;n=1<=d?++k:--k)g+=this.nCk(a+b,n);return g},l33t_variations:function(a){var b,c,d,f,k,n,g,h;if(!a.l33t)return 1;var l=1;var p=a.sub;for(g in p)if(h=p[g],f=a.token.toLowerCase().split(""),b=function(){var a;var b=[];var c=0;for(a=f.length;c<a;c++)d=f[c],d===g&&b.push(d);return b}().length,c=function(){var a;var b=[];var c=0;for(a=f.length;c<a;c++)d=f[c],d===h&&b.push(d);return b}().length,0===b||0===c)l*=2;else{var q=Math.min(c,b);var u=0;for(k=n=1;1<=q?n<=q:n>=
q;k=1<=q?++n:--n)u+=this.nCk(c+b,k);l*=u}return l}};p.exports=k},{"./adjacency_graphs":1}],7:[function(k,p,x){p.exports={estimate_attack_times:function(f){var d;var a={online_throttling_100_per_hour:f/(100/3600),online_no_throttling_10_per_second:f/10,offline_slow_hashing_1e4_per_second:f/1E4,offline_fast_hashing_1e10_per_second:f/1E10};var b={};for(d in a){var c=a[d];b[d]=this.display_time(c)}return{crack_times_seconds:a,crack_times_display:b,score:this.guesses_to_score(f)}},guesses_to_score:function(f){return 1005>
f?0:1000005>f?1:f<1E8+5?2:f<1E10+5?3:4},display_time:function(f){var d,a,b,c;return c=1>f?[null,"less than a second"]:60>f?(d=Math.round(f),[d,d+" second"]):3600>f?(d=Math.round(f/60),[d,d+" minute"]):86400>f?(d=Math.round(f/3600),[d,d+" hour"]):2678400>f?(d=Math.round(f/86400),[d,d+" day"]):32140800>f?(d=Math.round(f/2678400),[d,d+" month"]):321408E4>f?(d=Math.round(f/32140800),[d,d+" year"]):[null,"centuries"],a=c[0],b=c[1],null!=a&&1!==a&&(b+="s"),b}}},{}]},{},[4])(4)});
